<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Squid Web Cache: squid/src/client_side_reply.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Squid Web Cache<span id="projectnumber">&#160;master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('client__side__reply_8cc_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">client_side_reply.cc</div></div>
</div><!--header-->
<div class="contents">
<a href="client__side__reply_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> * Copyright (C) 1996-2026 The Squid Software Foundation and contributors</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> *</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> * Squid software is distributed under GPLv2+ license and includes</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * contributions from numerous individuals and organizations.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * Please see the COPYING and CONTRIBUTORS files for details.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> */</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">/* DEBUG: section 88    Client-side Reply Routines */</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &quot;<a class="code" href="squid_8h.html">squid.h</a>&quot;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &quot;<a class="code" href="FilledChecklist_8h.html">acl/FilledChecklist.h</a>&quot;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &quot;<a class="code" href="acl_2Gadgets_8h.html">acl/Gadgets.h</a>&quot;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &quot;<a class="code" href="PortCfg_8h.html">anyp/PortCfg.h</a>&quot;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;<a class="code" href="client__side__reply_8h.html">client_side_reply.h</a>&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;<a class="code" href="clientStream_8h.html">clientStream.h</a>&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;<a class="code" href="errorpage_8h.html">errorpage.h</a>&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &quot;<a class="code" href="ETag_8h.html">ETag.h</a>&quot;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;<a class="code" href="fd_8h.html">fd.h</a>&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &quot;<a class="code" href="fde_8h.html">fde.h</a>&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &quot;<a class="code" href="Token_8h.html">format/Token.h</a>&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &quot;<a class="code" href="FwdState_8h.html">FwdState.h</a>&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &quot;<a class="code" href="globals_8h.html">globals.h</a>&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="HeaderMangling_8h.html">HeaderMangling.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="http_2Stream_8h.html">http/Stream.h</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="HttpHeaderTools_8h.html">HttpHeaderTools.h</a>&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="HttpReply_8h.html">HttpReply.h</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="HttpRequest_8h.html">HttpRequest.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="QosConfig_8h.html">ip/QosConfig.h</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="ipcache_8h.html">ipcache.h</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="access__log_8h.html">log/access_log.h</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="MemObject_8h.html">MemObject.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &quot;<a class="code" href="mime__header_8h.html">mime_header.h</a>&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;<a class="code" href="neighbors_8h.html">neighbors.h</a>&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &quot;<a class="code" href="refresh_8h.html">refresh.h</a>&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;<a class="code" href="RequestFlags_8h.html">RequestFlags.h</a>&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &quot;<a class="code" href="SquidConfig_8h.html">SquidConfig.h</a>&quot;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &quot;<a class="code" href="SquidMath_8h.html">SquidMath.h</a>&quot;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &quot;<a class="code" href="Store_8h.html">Store.h</a>&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &quot;<a class="code" href="StrList_8h.html">StrList.h</a>&quot;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &quot;<a class="code" href="tools_8h.html">tools.h</a>&quot;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">#if USE_AUTH</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &quot;<a class="code" href="UserRequest_8h.html">auth/UserRequest.h</a>&quot;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#if USE_DELAY_POOLS</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#include &quot;<a class="code" href="DelayPools_8h.html">DelayPools.h</a>&quot;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><a class="code hl_define" href="cbdata_8h.html#a4710a3530194cffbc7f74fa2b2c4529d">CBDATA_CLASS_INIT</a>(<a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a>);</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="comment">/* Local functions */</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno"><a class="line" href="client__side__reply_8cc.html#a3d42a7ece901f14e6ec973a0feb096e1">   54</a></span><a class="code hl_typedef" href="clientStreamForward_8h.html#afe231eb7220220dab4804637c286f6e0">CSS</a> <a class="code hl_variable" href="client__side__reply_8cc.html#a3d42a7ece901f14e6ec973a0feb096e1">clientReplyStatus</a>;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><a class="code hl_class" href="classErrorState.html">ErrorState</a> *<a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(<a class="code hl_enumeration" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1a">err_type</a>, <a class="code hl_enumeration" href="namespaceHttp.html#a432f881deb187c726161d6435daec722">Http::StatusCode</a>, <span class="keywordtype">char</span> <span class="keyword">const</span> *, <span class="keyword">const</span> <a class="code hl_class" href="classConnStateData.html">ConnStateData</a> *, <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *, <span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">AccessLogEntry::Pointer</a> &amp;);</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="comment">/* privates */</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span> </div>
<div class="foldopen" id="foldopen00059" data-start="{" data-end="}">
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a9295d085f2b35f5c563b178379168ac1">   59</a></span><a class="code hl_function" href="classclientReplyContext.html#a9295d085f2b35f5c563b178379168ac1">clientReplyContext::~clientReplyContext</a>()</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>{</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <a class="code hl_variable" href="classclientReplyContext.html#aa57444bb386525911015174e9042fee3">deleting</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="comment">/* This may trigger a callback back into SendMoreData as the cbdata</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="comment">     * is still valid</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="comment">     */</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">removeClientStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <span class="comment">/* old_entry might still be set if we didn&#39;t yet get the reply</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="comment">     * code in HandleIMSReply() */</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <a class="code hl_function" href="classclientReplyContext.html#abe6fde0ad6302abd7067028bc8cb6b0d">removeStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a2fbf8aa662028db5c9160873dc1e5399">old_sc</a>, &amp;<a class="code hl_variable" href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">old_entry</a>);</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <a class="code hl_define" href="cbdata_8h.html#a178af3acec8011dd955016f69e307037">cbdataReferenceDone</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <a class="code hl_function" href="http_2Message_8h.html#adc5c03415efc511e2b62e809310969b6">HTTPMSGUNLOCK</a>(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>}</div>
</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="foldopen" id="foldopen00073" data-start="{" data-end="}">
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#afa825414a673993b47b3e86e1774afa3">   73</a></span><a class="code hl_function" href="classclientReplyContext.html#afa825414a673993b47b3e86e1774afa3">clientReplyContext::clientReplyContext</a>(<a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> *clientContext) :</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    purgeStatus(<a class="code hl_namespace" href="namespaceHttp.html">Http</a>::scNone),</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    http(<a class="code hl_define" href="cbdata_8h.html#a23338dbb451f460facd39a8a249bab46">cbdataReference</a>(clientContext)),</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    sc(nullptr),</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    ourNode(nullptr),</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    reply(nullptr),</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    old_entry(nullptr),</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    old_sc(nullptr),</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    old_lastmod(-1),</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    deleting(false),</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    collapsedRevalidation(crNone)</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>{</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    *<a class="code hl_variable" href="classclientReplyContext.html#aa8d45c762f26cc4146fdd64561b386f3">tempbuf</a> = 0;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>}</div>
</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00094" data-start="{" data-end="}">
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#aefdedf444de122be303a2c56dc7ef1a9">   94</a></span><a class="code hl_function" href="classclientReplyContext.html#aefdedf444de122be303a2c56dc7ef1a9">clientReplyContext::setReplyToError</a>(</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <a class="code hl_enumeration" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1a">err_type</a> err, <a class="code hl_enumeration" href="namespaceHttp.html#a432f881deb187c726161d6435daec722">Http::StatusCode</a> status, <span class="keywordtype">char</span> <span class="keyword">const</span> *uri,</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="keyword">const</span> <a class="code hl_class" href="classConnStateData.html">ConnStateData</a> *conn, <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *failedrequest, <span class="keyword">const</span> <span class="keywordtype">char</span> *,</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>#<span class="keywordflow">if</span> <a class="code hl_define" href="autoconf_8h.html#aa6119eb054c0919b333de6888ac28c75">USE_AUTH</a></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <a class="code hl_class" href="classRefCount.html">Auth::UserRequest::Pointer</a> auth_user_request</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>#<span class="keywordflow">else</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    <span class="keywordtype">void</span>*</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>#endif</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>)</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>{</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <span class="keyword">auto</span> errstate = <a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(err, status, uri, conn, failedrequest, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span><span class="preprocessor">#if USE_AUTH</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    errstate-&gt;auth_user_request = auth_user_request;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <a class="code hl_function" href="classclientReplyContext.html#aefdedf444de122be303a2c56dc7ef1a9">setReplyToError</a>(failedrequest ? failedrequest-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> : <a class="code hl_class" href="classHttpRequestMethod.html">HttpRequestMethod</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a17353570f8312493328aa9ade6ff514a">Http::METHOD_NONE</a>), errstate);</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>}</div>
</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="foldopen" id="foldopen00112" data-start="{" data-end="}">
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a8ef4c7c830f5529a8a21efd4a8414914">  112</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classclientReplyContext.html#aefdedf444de122be303a2c56dc7ef1a9">clientReplyContext::setReplyToError</a>(<span class="keyword">const</span> <a class="code hl_class" href="classHttpRequestMethod.html">HttpRequestMethod</a>&amp; method, <a class="code hl_class" href="classErrorState.html">ErrorState</a> *errstate)</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>{</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    <span class="keywordflow">if</span> (errstate-&gt;<a class="code hl_variable" href="classErrorState.html#aeb69480d52455c3be9e80e1a77655308">httpStatus</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a3a896c4c837cff6ec3414fcc23adac68">Http::scNotImplemented</a> &amp;&amp; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>)</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>        <span class="comment">/* prevent confusion over whether we default to persistent or not */</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a753215d3854b1129173deb898f7c7e99">http</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1HttpDetails.html#afaef5bd16c55d6723beb468d0bc75643">code</a> = errstate-&gt;<a class="code hl_variable" href="classErrorState.html#aeb69480d52455c3be9e80e1a77655308">httpStatus</a>;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>)</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#a9d63ea3655ec440fedf74c3eb2ea99e9">ignoreRange</a>(<span class="stringliteral">&quot;responding with a Squid-generated error&quot;</span>);</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    <a class="code hl_function" href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">createStoreEntry</a>(method, <a class="code hl_class" href="classRequestFlags.html">RequestFlags</a>());</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(errstate-&gt;<a class="code hl_variable" href="classErrorState.html#ada325088568d82f3396fb20e592596bc">callback_data</a> == <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    <a class="code hl_function" href="group__ErrorPageAPI.html#gae984c9bcabfcfb5f0f732a501169a388">errorAppendEntry</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(), errstate);</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="comment">/* Now the caller reads to get this */</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>}</div>
</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00130" data-start="{" data-end="}">
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a0f8952c0b6f0b7a451aa61a94cdd7ed9">  130</a></span><a class="code hl_function" href="classclientReplyContext.html#a0f8952c0b6f0b7a451aa61a94cdd7ed9">clientReplyContext::setReplyToReply</a>(<a class="code hl_class" href="classHttpReply.html">HttpReply</a> *futureReply)</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>{</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <a class="code hl_define" href="TextException_8h.html#ad79a19f4098f2506d0aa28628f18fd36">Must</a>(futureReply);</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a753215d3854b1129173deb898f7c7e99">http</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1HttpDetails.html#afaef5bd16c55d6723beb468d0bc75643">code</a> = futureReply-&gt;<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_function" href="classHttp_1_1StatusLine.html#af852e58bb3e96bc41cd16787b0a7d7db">status</a>();</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <a class="code hl_class" href="classHttpRequestMethod.html">HttpRequestMethod</a> method;</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>) { <span class="comment">// nil on responses to unparsable requests</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#a9d63ea3655ec440fedf74c3eb2ea99e9">ignoreRange</a>(<span class="stringliteral">&quot;responding with a Squid-generated reply&quot;</span>);</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>        method = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    }</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span> </div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <a class="code hl_function" href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">createStoreEntry</a>(method, <a class="code hl_class" href="classRequestFlags.html">RequestFlags</a>());</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a84c7380e766ff75a4275c2778df8f068">storeErrorResponse</a>(futureReply);</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    <span class="comment">/* Now the caller reads to get futureReply */</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>}</div>
</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span><span class="comment">// Assumes that the entry contains an error response without Content-Range.</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span><span class="comment">// To use with regular entries, make HTTP Range header removal conditional.</span></div>
<div class="foldopen" id="foldopen00149" data-start="{" data-end="}">
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a54642fc1f8d38e1860d4e945d820889d">  149</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classclientReplyContext.html#a54642fc1f8d38e1860d4e945d820889d">clientReplyContext::setReplyToStoreEntry</a>(<a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *entry, <span class="keyword">const</span> <span class="keywordtype">char</span> *reason)</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>{</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    entry-&gt;<a class="code hl_function" href="classStoreEntry.html#a53a607cfbdb22fde40edd2c72bfb6dd3">lock</a>(<span class="stringliteral">&quot;clientReplyContext::setReplyToStoreEntry&quot;</span>); <span class="comment">// removeClientStoreReference() unlocks</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a> = <a class="code hl_function" href="store__client_8cc.html#ae077d286d865af03eb1357a8de9ba75b">storeClientListAdd</a>(entry, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span><span class="preprocessor">#if USE_DELAY_POOLS</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>-&gt;<a class="code hl_function" href="classstore__client.html#a31b3c123a2b2d6450f66699cf3a84bf8">setDelayId</a>(<a class="code hl_function" href="classDelayId.html#af62e27c317c2b62b8e9711410616dd42">DelayId::DelayClient</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>));</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>)</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#a9d63ea3655ec440fedf74c3eb2ea99e9">ignoreRange</a>(reason);</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    <a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#abee3bb6f7775ddc1b0ddb0b6525d110d">storelogiccomplete</a> = 1;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(entry);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>}</div>
</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00163" data-start="{" data-end="}">
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#abe6fde0ad6302abd7067028bc8cb6b0d">  163</a></span><a class="code hl_function" href="classclientReplyContext.html#abe6fde0ad6302abd7067028bc8cb6b0d">clientReplyContext::removeStoreReference</a>(<a class="code hl_class" href="classstore__client.html">store_client</a> ** scp,</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> ** ep)</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>{</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *e;</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <a class="code hl_class" href="classstore__client.html">store_client</a> *sc_tmp = *scp;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    <span class="keywordflow">if</span> ((e = *ep) != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        *ep = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        <a class="code hl_function" href="store__client_8cc.html#a06631df680fe4de46f305a34874175f9">storeUnregister</a>(sc_tmp, e, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        *scp = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>        e-&gt;<a class="code hl_function" href="classStoreEntry.html#a35618603cff249c1cc64abf8127f3b7d">unlock</a>(<span class="stringliteral">&quot;clientReplyContext::removeStoreReference&quot;</span>);</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    }</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>}</div>
</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00178" data-start="{" data-end="}">
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">  178</a></span><a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">clientReplyContext::removeClientStoreReference</a>(<a class="code hl_class" href="classstore__client.html">store_client</a> **scp, <a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> *aHttpRequest)</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>{</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *reference = aHttpRequest-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>();</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <a class="code hl_function" href="classclientReplyContext.html#abe6fde0ad6302abd7067028bc8cb6b0d">removeStoreReference</a>(scp, &amp;reference);</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    aHttpRequest-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(reference);</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>}</div>
</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00186" data-start="{" data-end="}">
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#acd7c96180e2911df68078798e72f096f">  186</a></span><a class="code hl_function" href="classclientReplyContext.html#acd7c96180e2911df68078798e72f096f">clientReplyContext::saveState</a>()</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>{</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#a2fbf8aa662028db5c9160873dc1e5399">old_sc</a> == <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;clientReplyContext::saveState: saving store context&quot;</span>);</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <a class="code hl_variable" href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">old_entry</a> = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>();</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    <a class="code hl_variable" href="classclientReplyContext.html#a2fbf8aa662028db5c9160873dc1e5399">old_sc</a> = <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>;</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    <a class="code hl_variable" href="classclientReplyContext.html#af0336f9bb37e7e98a019f71f82b78d30">old_lastmod</a> = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a6d8609b78e8754ea45fb490b626edbae">lastmod</a>;</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <a class="code hl_variable" href="classclientReplyContext.html#a4db6cf4c6a8dca9238e0d2556fd6160b">old_etag</a> = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a8d2f98f255f306098e85800afa26eb68">etag</a>;</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="comment">/* Prevent accessing the now saved entries */</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>}</div>
</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00200" data-start="{" data-end="}">
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#aecee7d8e16354cd047a7e8a895c22c7f">  200</a></span><a class="code hl_function" href="classclientReplyContext.html#aecee7d8e16354cd047a7e8a895c22c7f">clientReplyContext::restoreState</a>()</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>{</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#a2fbf8aa662028db5c9160873dc1e5399">old_sc</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;clientReplyContext::restoreState: Restoring store context&quot;</span>);</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    <a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">removeClientStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(<a class="code hl_variable" href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">old_entry</a>);</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a> = <a class="code hl_variable" href="classclientReplyContext.html#a2fbf8aa662028db5c9160873dc1e5399">old_sc</a>;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a6d8609b78e8754ea45fb490b626edbae">lastmod</a> = <a class="code hl_variable" href="classclientReplyContext.html#af0336f9bb37e7e98a019f71f82b78d30">old_lastmod</a>;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a8d2f98f255f306098e85800afa26eb68">etag</a> = <a class="code hl_variable" href="classclientReplyContext.html#a4db6cf4c6a8dca9238e0d2556fd6160b">old_etag</a>;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <span class="comment">/* Prevent accessed the old saved entries */</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    <a class="code hl_variable" href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">old_entry</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <a class="code hl_variable" href="classclientReplyContext.html#a2fbf8aa662028db5c9160873dc1e5399">old_sc</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <a class="code hl_variable" href="classclientReplyContext.html#af0336f9bb37e7e98a019f71f82b78d30">old_lastmod</a> = -1;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    <a class="code hl_variable" href="classclientReplyContext.html#a4db6cf4c6a8dca9238e0d2556fd6160b">old_etag</a>.<a class="code hl_function" href="classString.html#a60a0fdff84d3470d812b2adbcb2cbf38">clean</a>();</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>}</div>
</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00217" data-start="{" data-end="}">
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a4c65a525bd9fc6c042e060c434822948">  217</a></span><a class="code hl_function" href="classclientReplyContext.html#a4c65a525bd9fc6c042e060c434822948">clientReplyContext::startError</a>(<a class="code hl_class" href="classErrorState.html">ErrorState</a> * err)</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>{</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    <a class="code hl_function" href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">createStoreEntry</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>, <a class="code hl_class" href="classRequestFlags.html">RequestFlags</a>());</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <a class="code hl_function" href="classclientReplyContext.html#a309764bf3b36e0af99299869fdba6c24">triggerInitialStoreRead</a>();</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>    <a class="code hl_function" href="group__ErrorPageAPI.html#gae984c9bcabfcfb5f0f732a501169a388">errorAppendEntry</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(), err);</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>}</div>
</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span> </div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span><a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *</div>
<div class="foldopen" id="foldopen00225" data-start="{" data-end="}">
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ae381916c474e872fdad5a018ecc082fe">  225</a></span><a class="code hl_function" href="classclientReplyContext.html#ae381916c474e872fdad5a018ecc082fe">clientReplyContext::getNextNode</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <span class="keywordflow">return</span> (<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *)<a class="code hl_variable" href="classclientReplyContext.html#a0df8ee2233c180c19f80aabaf0bb8bd1">ourNode</a>-&gt;<a class="code hl_variable" href="classclientStreamNode.html#acd24e5a54ccd28b8c5ef2e9d4c0269e5">node</a>.<a class="code hl_variable" href="classdlink__node.html#ad1228295f9f83f14e0c58966479cfbd7">next</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>}</div>
</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00234" data-start="{" data-end="}">
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a309764bf3b36e0af99299869fdba6c24">  234</a></span><a class="code hl_function" href="classclientReplyContext.html#a309764bf3b36e0af99299869fdba6c24">clientReplyContext::triggerInitialStoreRead</a>(<a class="code hl_typedef" href="StoreClient_8h.html#a48e07440f256e626bf7b91ee8236f028">STCB</a> recipient)</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>{</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    <a class="code hl_define" href="Assure_8h.html#a1fcca4cd6cfc3b9f835aa3652eb0c2f5">Assure</a>(recipient != <a class="code hl_variable" href="classclientReplyContext.html#a239cf51bf0b46a7ca7e8d23fab22b28f">HandleIMSReply</a>);</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <a class="code hl_variable" href="classclientReplyContext.html#abca6bf899bcdd71d05414bde4a8b774f">lastStreamBufferedBytes</a> = <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a>(); <span class="comment">// storeClientCopy(next()-&gt;readBuffer) invalidates</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> localTempBuffer (<a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;readBuffer.length, 0, <a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;readBuffer.<a class="code hl_variable" href="classclientStreamNode.html#a3ffd025e7396d93b36a80c2048915ac8">data</a>);</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <a class="code hl_variable" href="classclientReplyContext.html#a75cda298aa9569171b7a4c196b13deb6">::storeClientCopy</a>(<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(), localTempBuffer, recipient, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>}</div>
</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span> </div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00247" data-start="{" data-end="}">
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ab137b710baaf94196345dc44b26f9914">  247</a></span><a class="code hl_function" href="classclientReplyContext.html#ab137b710baaf94196345dc44b26f9914">clientReplyContext::requestMoreBodyFromStore</a>()</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>{</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    <a class="code hl_variable" href="classclientReplyContext.html#abca6bf899bcdd71d05414bde4a8b774f">lastStreamBufferedBytes</a> = <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a>(); <span class="comment">// storeClientCopy(next()-&gt;readBuffer) invalidates</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    <a class="code hl_variable" href="classclientReplyContext.html#a75cda298aa9569171b7a4c196b13deb6">::storeClientCopy</a>(<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(), <a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;readBuffer, <a class="code hl_variable" href="classclientReplyContext.html#afa64e15976d047eb00f04402a0525711">SendMoreData</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>}</div>
</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span><span class="comment">/* there is an expired entry in the store.</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span><span class="comment"> * setup a temporary buffer area and perform an IMS to the origin</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span><span class="comment"> */</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00257" data-start="{" data-end="}">
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#aaa60ec684c35ec0f5ed3c92c763e5ced">  257</a></span><a class="code hl_function" href="classclientReplyContext.html#aaa60ec684c35ec0f5ed3c92c763e5ced">clientReplyContext::processExpired</a>()</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>{</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *url = <a class="code hl_function" href="classclientReplyContext.html#ad42a3d89a4030a9571bd374eb1d67277">storeId</a>();</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;clientReplyContext::processExpired: &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    <span class="keyword">const</span> time_t lastmod = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a4550da0757f7c3aa6af8e8e9c3bcdb48">lastModified</a>();</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(lastmod &gt;= 0);</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span><span class="comment">     * check if we are allowed to contact other servers</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span><span class="comment">     * @?@: Instead of a 504 (Gateway Timeout) reply, we may want to return</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span><span class="comment">     *      a stale entry *if* it matches client requirements</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span><span class="comment">     */</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab2d33ce5e3e5a930de04639ee09a1bcc">onlyIfCached</a>()) {</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>        <a class="code hl_function" href="classclientReplyContext.html#a62122fdbe3300c20b4464e1d48e1d5a5">processOnlyIfCachedMiss</a>();</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    }</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span> </div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a213d85bd40f00127b4926963c362b9de">LOG_TCP_REFRESH</a>);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8f900e1c576cb7ea9b979d7001540025">refresh</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span><span class="preprocessor">#if STORE_CLIENT_LIST_DEBUG</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    <span class="comment">/* Prevent a race with the store client memory free routines</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span><span class="comment">     */</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_function" href="StoreClient_8h.html#a53c9348905c2b02db1e455b92a8d3825">storeClientIsThisAClient</a>(<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <span class="keyword">this</span>));</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    <span class="comment">/* Prepare to make a new temporary request */</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    <a class="code hl_function" href="classclientReplyContext.html#acd7c96180e2911df68078798e72f096f">saveState</a>();</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <span class="comment">// TODO: Consider also allowing regular (non-collapsed) revalidation hits.</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>    <span class="comment">// TODO: support collapsed revalidation for Vary-controlled entries</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>    <span class="keywordtype">bool</span> collapsingAllowed = <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#a9d226871b43c9f7f1415a121e2c87257">collapsed_forwarding</a> &amp;&amp;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>                             !<a class="code hl_function" href="classStore_1_1Controller.html#aae85df3b0edba0369a4ba152e6132b1a">Store::Controller::SmpAware</a>() &amp;&amp;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>                             <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a8b90084ccd19905f1fc8eebc9ff3a60e">vary_headers</a>.<a class="code hl_function" href="classSBuf.html#a8bda8fe69e451e61946b35c2a2d2340b">isEmpty</a>();</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *entry = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    <span class="keywordflow">if</span> (collapsingAllowed) {</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> e = <a class="code hl_function" href="store_8cc.html#a70101e23661f7fe20ce50890c448e92c">storeGetPublicByRequest</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_enumvalue" href="store__key__md5_8h.html#a49cd576e8f2ba2c00d8e65364ec7c44daad451bfc625f4ffe79db789aa3b04dee">ksRevalidation</a>)) {</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>            <span class="keywordflow">if</span> (e-&gt;hittingRequiresCollapsing() &amp;&amp; <a class="code hl_function" href="classStoreClient.html#abb28f481b15a234bd176db48eba5bac9">startCollapsingOn</a>(*e, <span class="keyword">true</span>)) {</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>                entry = e;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>                entry-&gt;<a class="code hl_function" href="classStoreEntry.html#a53a607cfbdb22fde40edd2c72bfb6dd3">lock</a>(<span class="stringliteral">&quot;clientReplyContext::processExpired#alreadyRevalidating&quot;</span>);</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>                e-&gt;abandon(__func__);</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>                <span class="comment">// assume mayInitiateCollapsing() would fail too</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>                collapsingAllowed = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>            }</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>        }</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    }</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <span class="keywordflow">if</span> (entry) {</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        entry-&gt;<a class="code hl_function" href="classStoreEntry.html#a249ad3e6bfa297da0fa7a0e9accf6002">ensureMemObject</a>(url, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a3f6d0f7008f5302283e91937cdc67f75">log_uri</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>);</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;collapsed on existing revalidation entry: &quot;</span> &lt;&lt; *entry);</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        <a class="code hl_variable" href="classclientReplyContext.html#aa68c26ab76934275c66ba1fd3414cc2e">collapsedRevalidation</a> = <a class="code hl_enumvalue" href="classclientReplyContext.html#a4895ddefadfe91421fd6a2834dee8439ace62de5377e0c03b32c400d1325d24fa">crSlave</a>;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>        entry = <a class="code hl_function" href="store_8cc.html#a872157d7a8c43bb5facb072ce03c4d48">storeCreateEntry</a>(url,</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>                                 <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a3f6d0f7008f5302283e91937cdc67f75">log_uri</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>);</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>        <span class="comment">/* NOTE, don&#39;t call StoreEntry-&gt;lock(), storeCreateEntry() does it */</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span> </div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>        <span class="keywordflow">if</span> (collapsingAllowed &amp;&amp; <a class="code hl_function" href="classStoreClient.html#a97f3b428b24aefc0bd350d6b060bb8e0">mayInitiateCollapsing</a>() &amp;&amp;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>                <a class="code hl_function" href="namespaceStore.html#a0151d620409db8bd3af40e3570a18f8c">Store::Root</a>().allowCollapsing(entry, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>)) {</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;allow other revalidation requests to collapse on &quot;</span> &lt;&lt; *entry);</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>            <a class="code hl_variable" href="classclientReplyContext.html#aa68c26ab76934275c66ba1fd3414cc2e">collapsedRevalidation</a> = <a class="code hl_enumvalue" href="classclientReplyContext.html#a4895ddefadfe91421fd6a2834dee8439a739ec44c2f18cae8a5b53bbd0698634f">crInitiator</a>;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>            <a class="code hl_variable" href="classclientReplyContext.html#aa68c26ab76934275c66ba1fd3414cc2e">collapsedRevalidation</a> = <a class="code hl_enumvalue" href="classclientReplyContext.html#a4895ddefadfe91421fd6a2834dee8439a9d07f0a33080790db951a2ece3e2b50f">crNone</a>;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        }</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    }</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a> = <a class="code hl_function" href="store__client_8cc.html#ae077d286d865af03eb1357a8de9ba75b">storeClientListAdd</a>(entry, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span><span class="preprocessor">#if USE_DELAY_POOLS</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <span class="comment">/* delay_id is already set on original store client */</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>-&gt;<a class="code hl_function" href="classstore__client.html#a31b3c123a2b2d6450f66699cf3a84bf8">setDelayId</a>(<a class="code hl_function" href="classDelayId.html#af62e27c317c2b62b8e9711410616dd42">DelayId::DelayClient</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>));</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span> </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a6d8609b78e8754ea45fb490b626edbae">lastmod</a> = lastmod;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4aa83838d4c8ca01ddfbec2af8759a0c3e">Http::HdrType::IF_NONE_MATCH</a>)) {</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>        <a class="code hl_class" href="classETag.html">ETag</a> etag = {<span class="keyword">nullptr</span>, -1}; <span class="comment">// TODO: make that a default ETag constructor</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">old_entry</a>-&gt;<a class="code hl_function" href="classStoreEntry.html#a44ee484ceff3f6e9e92ab7e80ede26ab">hasEtag</a>(etag) &amp;&amp; !etag.<a class="code hl_variable" href="classETag.html#ac85cff3313d939f356bc6e438dd01da8">weak</a>)</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a8d2f98f255f306098e85800afa26eb68">etag</a> = etag.<a class="code hl_variable" href="classETag.html#aead6b3157b513d9645823d7ee9859342">str</a>;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    }</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;lastmod &quot;</span> &lt;&lt; entry-&gt;<a class="code hl_function" href="classStoreEntry.html#a4550da0757f7c3aa6af8e8e9c3bcdb48">lastModified</a>());</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(entry);</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a> == 0);</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a13f1a21e71a902ac14ab9b4ee8133276">clientConnectionManager</a> == <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>());</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#aa68c26ab76934275c66ba1fd3414cc2e">collapsedRevalidation</a> != <a class="code hl_enumvalue" href="classclientReplyContext.html#a4895ddefadfe91421fd6a2834dee8439ace62de5377e0c03b32c400d1325d24fa">crSlave</a>) {</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span><span class="comment">         * A refcounted pointer so that FwdState stays around as long as</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span><span class="comment">         * this clientReplyContext does</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span><span class="comment">         */</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>        <a class="code hl_class" href="classRefCount.html">Comm::ConnectionPointer</a> conn = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>() != <span class="keyword">nullptr</span> ? <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a> : <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>        <a class="code hl_function" href="classFwdState.html#a391d66921577e62e543723f978062e97">FwdState::Start</a>(conn, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(), <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    }</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    <span class="comment">/* Register with storage manager to receive updates when data comes in. */</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span> </div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(entry-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462af1d0ae16fcfb269505ed3e22bc2e3fe5">ENTRY_ABORTED</a>))</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;clientReplyContext::processExpired: Found ENTRY_ABORTED object&quot;</span>);</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span> </div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    {</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>        <span class="comment">/* start counting the length from 0 */</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> localTempBuffer(<a class="code hl_define" href="http_2forward_8h.html#a196f6d12d102aebcc7a2778bea3e6b19">HTTP_REQBUF_SZ</a>, 0, <a class="code hl_variable" href="classclientReplyContext.html#aa8d45c762f26cc4146fdd64561b386f3">tempbuf</a>);</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        <span class="comment">// keep lastStreamBufferedBytes: tempbuf is not a Client Stream buffer</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>        <a class="code hl_variable" href="classclientReplyContext.html#a75cda298aa9569171b7a4c196b13deb6">::storeClientCopy</a>(<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, entry, localTempBuffer, <a class="code hl_variable" href="classclientReplyContext.html#a239cf51bf0b46a7ca7e8d23fab22b28f">HandleIMSReply</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    }</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>}</div>
</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span> </div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00363" data-start="{" data-end="}">
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a4bf46442624a01e832444fc6d9f0c732">  363</a></span><a class="code hl_function" href="classclientReplyContext.html#a4bf46442624a01e832444fc6d9f0c732">clientReplyContext::sendClientUpstreamResponse</a>(<span class="keyword">const</span> <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> &amp;upstreamResponse)</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>{</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    <a class="code hl_function" href="classclientReplyContext.html#abe6fde0ad6302abd7067028bc8cb6b0d">removeStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a2fbf8aa662028db5c9160873dc1e5399">old_sc</a>, &amp;<a class="code hl_variable" href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">old_entry</a>);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#aa68c26ab76934275c66ba1fd3414cc2e">collapsedRevalidation</a>)</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a5e2c3f8253b4deebad7a5586c16a4df0">clearPublicKeyScope</a>();</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    <span class="comment">/* here the data to send is the data we just received */</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(!<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462af1d0ae16fcfb269505ed3e22bc2e3fe5">ENTRY_ABORTED</a>));</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    <a class="code hl_function" href="classclientReplyContext.html#ab7bb9cba9e77c4e81cf83757464a4974">sendMoreData</a>(upstreamResponse);</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>}</div>
</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span> </div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span><a class="code hl_variable" href="classclientReplyContext.html#a239cf51bf0b46a7ca7e8d23fab22b28f">clientReplyContext::HandleIMSReply</a>(<span class="keywordtype">void</span> *data, <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> result)</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>{</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    <a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *context = (<a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *)data;</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    context-&gt;<a class="code hl_function" href="classclientReplyContext.html#a088b8d70ec990b3284a87a4fffe32fd7">handleIMSReply</a>(result);</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>}</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span> </div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00383" data-start="{" data-end="}">
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#aa68c4dea99d63657588d152e9793a9cb">  383</a></span><a class="code hl_function" href="classclientReplyContext.html#aa68c4dea99d63657588d152e9793a9cb">clientReplyContext::sendClientOldEntry</a>()</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>{</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    <span class="comment">/* Get the old request back */</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    <a class="code hl_function" href="classclientReplyContext.html#aecee7d8e16354cd047a7e8a895c22c7f">restoreState</a>();</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span> </div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462af1d0ae16fcfb269505ed3e22bc2e3fe5">ENTRY_ABORTED</a>)) {</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;stale entry aborted while we revalidated: &quot;</span> &lt;&lt; *<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>());</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>        <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    }</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    <span class="comment">/* here the data to send is in the next nodes buffers already */</span></div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <a class="code hl_define" href="Assure_8h.html#a1fcca4cd6cfc3b9f835aa3652eb0c2f5">Assure</a>(<a class="code hl_function" href="classclientReplyContext.html#a42f78e9406c59b07aeadb0d9c275d0be">matchesStreamBodyBuffer</a>(<a class="code hl_variable" href="classclientReplyContext.html#abca6bf899bcdd71d05414bde4a8b774f">lastStreamBufferedBytes</a>));</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    <a class="code hl_define" href="Assure_8h.html#a1fcca4cd6cfc3b9f835aa3652eb0c2f5">Assure</a>(!<a class="code hl_variable" href="classclientReplyContext.html#abca6bf899bcdd71d05414bde4a8b774f">lastStreamBufferedBytes</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a61c7333c49e943c24964ae030c96b5ec">offset</a>);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>    <a class="code hl_function" href="classclientReplyContext.html#ab7bb9cba9e77c4e81cf83757464a4974">sendMoreData</a>(<a class="code hl_variable" href="classclientReplyContext.html#abca6bf899bcdd71d05414bde4a8b774f">lastStreamBufferedBytes</a>);</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>}</div>
</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span><span class="comment">/* This is the workhorse of the HandleIMSReply callback.</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span><span class="comment"> *</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span><span class="comment"> * It is called when we&#39;ve got data back from the origin following our</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span><span class="comment"> * IMS request to revalidate a stale entry.</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span><span class="comment"> */</span></div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00407" data-start="{" data-end="}">
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a088b8d70ec990b3284a87a4fffe32fd7">  407</a></span><a class="code hl_function" href="classclientReplyContext.html#a088b8d70ec990b3284a87a4fffe32fd7">clientReplyContext::handleIMSReply</a>(<span class="keyword">const</span> <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> result)</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>{</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#aa57444bb386525911015174e9042fee3">deleting</a>)</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span> </div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a3835284a1cb3623987d557c9754e5ffc">url</a>() &lt;&lt; <span class="stringliteral">&quot; got &quot;</span> &lt;&lt; result);</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span> </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    <span class="keywordflow">if</span> (result.<a class="code hl_variable" href="classStoreIOBuffer.html#acb67e9b7fb58fa7b15114bd024533f44">flags</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a1e3225390c0c4999a67e22a9b503ca16">error</a> &amp;&amp; !<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462af1d0ae16fcfb269505ed3e22bc2e3fe5">ENTRY_ABORTED</a>))</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#aa68c26ab76934275c66ba1fd3414cc2e">collapsedRevalidation</a> == <a class="code hl_enumvalue" href="classclientReplyContext.html#a4895ddefadfe91421fd6a2834dee8439ace62de5377e0c03b32c400d1325d24fa">crSlave</a> &amp;&amp; !<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a851512bf2d39ef1f9564421c26ce290f">mayStartHitting</a>()) {</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;CF slave hit private non-shareable &quot;</span> &lt;&lt; *<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>() &lt;&lt; <span class="stringliteral">&quot;. MISS&quot;</span>);</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        <span class="comment">// restore context to meet processMiss() expectations</span></div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        <a class="code hl_function" href="classclientReplyContext.html#aecee7d8e16354cd047a7e8a895c22c7f">restoreState</a>();</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>        <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    }</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span> </div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    <span class="comment">// request to origin was aborted</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462af1d0ae16fcfb269505ed3e22bc2e3fe5">ENTRY_ABORTED</a>)) {</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;request to origin aborted &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a3835284a1cb3623987d557c9754e5ffc">url</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;, sending old entry to client&quot;</span>);</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a6b1b04ecf3a513f752a3ec377f008a6d">LOG_TCP_REFRESH_FAIL_OLD</a>);</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>        <a class="code hl_function" href="classclientReplyContext.html#aa68c4dea99d63657588d152e9793a9cb">sendClientOldEntry</a>();</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    }</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    <span class="keyword">const</span> <span class="keyword">auto</span> oldStatus = <a class="code hl_variable" href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">old_entry</a>-&gt;<a class="code hl_function" href="classStoreEntry.html#a19fd5af89e99c467c29f7bd951ac901d">mem</a>().<a class="code hl_function" href="classMemObject.html#a89697947bc40cdbe591b9e26951b59ba">freshestReply</a>().<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_function" href="classHttp_1_1StatusLine.html#af852e58bb3e96bc41cd16787b0a7d7db">status</a>();</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;new_rep = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a19fd5af89e99c467c29f7bd951ac901d">mem</a>().<a class="code hl_function" href="classMemObject.html#a89697947bc40cdbe591b9e26951b59ba">freshestReply</a>();</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    <span class="keyword">const</span> <span class="keyword">auto</span> status = new_rep.<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_function" href="classHttp_1_1StatusLine.html#af852e58bb3e96bc41cd16787b0a7d7db">status</a>();</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span> </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="comment">// XXX: Disregard stale incomplete (i.e. still being written) borrowed (i.e.</span></div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <span class="comment">// not caused by our request) IMS responses. That new_rep may be very old!</span></div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span> </div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <span class="comment">// origin replied 304</span></div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    <span class="keywordflow">if</span> (status == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722aac99376ecec42f14e89b637dc6286ccf">Http::scNotModified</a>) {</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>        <span class="comment">// TODO: The update may not be instantaneous. Should we wait for its</span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>        <span class="comment">// completion to avoid spawning too much client-disassociated work?</span></div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceStore.html#a0151d620409db8bd3af40e3570a18f8c">Store::Root</a>().updateOnNotModified(<a class="code hl_variable" href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">old_entry</a>, *<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>())) {</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>            <a class="code hl_variable" href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">old_entry</a>-&gt;<a class="code hl_function" href="classStoreEntry.html#a463a7aa5404ee7401d27ebc0caeaf1fe">release</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>            <a class="code hl_function" href="classclientReplyContext.html#aecee7d8e16354cd047a7e8a895c22c7f">restoreState</a>();</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>            <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>        }</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5ab7d48c74f5c9b5611f95f59f40b28488">LOG_TCP_REFRESH_UNMODIFIED</a>);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a4cb0ee94750e6ed9434b5924fb7804a6">staleIfHit</a> = <span class="keyword">false</span>; <span class="comment">// old_entry is no longer stale</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        <span class="comment">// if client sent IMS</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a12193c977b3da18c04e6e4b350e860ba">ims</a> &amp;&amp; !<a class="code hl_variable" href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">old_entry</a>-&gt;<a class="code hl_function" href="classStoreEntry.html#ac7b0d2255cb46a1be80dd95ea4230543">modifiedSince</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a5f8f335cf16fa13580238d91973bc566">ims</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a6617b5b1e4c90874af16ac68e0f8673c">imslen</a>)) {</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>            <span class="comment">// forward the 304 from origin</span></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;origin replied 304, revalidated existing entry and forwarding 304 to client&quot;</span>);</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>            <a class="code hl_function" href="classclientReplyContext.html#a4bf46442624a01e832444fc6d9f0c732">sendClientUpstreamResponse</a>(result);</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        }</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>        <span class="comment">// send existing entry, it&#39;s still valid</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;origin replied 304, revalidated existing entry and sending &quot;</span> &lt;&lt; oldStatus &lt;&lt; <span class="stringliteral">&quot; to client&quot;</span>);</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        <a class="code hl_function" href="classclientReplyContext.html#aa68c4dea99d63657588d152e9793a9cb">sendClientOldEntry</a>();</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    }</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    <span class="comment">// origin replied with a non-error code</span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    <span class="keywordflow">if</span> (status &gt; <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722aab61d70dce6e121feb658b24ef1cd815">Http::scNone</a> &amp;&amp; status &lt; <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a6f94589e93c5e1111f2b2ccfc538d9cc">Http::scInternalServerError</a>) {</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>        <span class="comment">// RFC 9111 section 4:</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        <span class="comment">// &quot;When more than one suitable response is stored,</span></div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>        <span class="comment">//  a cache MUST use the most recent one</span></div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        <span class="comment">// (as determined by the Date header field).&quot;</span></div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        <span class="keywordflow">if</span> (new_rep.olderThan(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">old_entry</a>-&gt;<a class="code hl_function" href="classStoreEntry.html#a19fd5af89e99c467c29f7bd951ac901d">mem</a>().<a class="code hl_function" href="classMemObject.html#a89697947bc40cdbe591b9e26951b59ba">freshestReply</a>())) {</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a4574f49181917c5496dca9ace95ea344">cache</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1CacheDetails.html#ae7601ddfc08eef5f4af309c87f3ff59f">code</a>.<a class="code hl_variable" href="classLogTags.html#a2890013ea431605b918d0d24fd865af8">err</a>.<a class="code hl_variable" href="classLogTagsErrors.html#a75b3c957f97ab0a61a830a3e1eab6f06">ignored</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;origin replied &quot;</span> &lt;&lt; status &lt;&lt; <span class="stringliteral">&quot; but with an older date header, sending old entry (&quot;</span> &lt;&lt; oldStatus &lt;&lt; <span class="stringliteral">&quot;) to client&quot;</span>);</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>            <a class="code hl_function" href="classclientReplyContext.html#aa68c4dea99d63657588d152e9793a9cb">sendClientOldEntry</a>();</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>        }</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span> </div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a384d0c751acd7c3fbdf7b3b460fdcf2c">LOG_TCP_REFRESH_MODIFIED</a>);</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;origin replied &quot;</span> &lt;&lt; status &lt;&lt; <span class="stringliteral">&quot;, forwarding to client&quot;</span>);</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        <a class="code hl_function" href="classclientReplyContext.html#a4bf46442624a01e832444fc6d9f0c732">sendClientUpstreamResponse</a>(result);</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>    }</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    <span class="comment">// origin replied with an error</span></div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8afa0524d088b358dfaaa9950638aa1f">failOnValidationError</a>) {</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a0647b915c26297fd48b107622903093c">LOG_TCP_REFRESH_FAIL_ERR</a>);</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;origin replied with error &quot;</span> &lt;&lt; status &lt;&lt; <span class="stringliteral">&quot;, forwarding to client due to fail_on_validation_err&quot;</span>);</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>        <a class="code hl_function" href="classclientReplyContext.html#a4bf46442624a01e832444fc6d9f0c732">sendClientUpstreamResponse</a>(result);</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>    }</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>    <span class="comment">// ignore and let client have old entry</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a6b1b04ecf3a513f752a3ec377f008a6d">LOG_TCP_REFRESH_FAIL_OLD</a>);</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;origin replied with error &quot;</span> &lt;&lt; status &lt;&lt; <span class="stringliteral">&quot;, sending old entry (&quot;</span> &lt;&lt; oldStatus &lt;&lt; <span class="stringliteral">&quot;) to client&quot;</span>);</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    <a class="code hl_function" href="classclientReplyContext.html#aa68c4dea99d63657588d152e9793a9cb">sendClientOldEntry</a>();</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>}</div>
</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span> </div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno"><a class="line" href="client__side__reply_8cc.html#ae73f7b10b6c2bd55c5f96c9d62839e8d">  506</a></span><a class="code hl_typedef" href="clientStreamForward_8h.html#adfeb9a20de88d7ad3433ca3c7f50a364">CSR</a> <a class="code hl_variable" href="client__side__reply_8cc.html#ae73f7b10b6c2bd55c5f96c9d62839e8d">clientGetMoreData</a>;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno"><a class="line" href="client__side__reply_8cc.html#ab806362f706a7b39732957bb45e3c2df">  507</a></span><a class="code hl_typedef" href="clientStreamForward_8h.html#ad7a8fcb0c65e986028978be921f80b4f">CSD</a> <a class="code hl_variable" href="client__side__reply_8cc.html#ab806362f706a7b39732957bb45e3c2df">clientReplyDetach</a>;</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span><a class="code hl_variable" href="classclientReplyContext.html#a6782d4abafb931f4a2b5aa1b088f8fbf">clientReplyContext::CacheHit</a>(<span class="keywordtype">void</span> *data, <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> result)</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>{</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>    <a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *context = (<a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *)data;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    context-&gt;<a class="code hl_function" href="classclientReplyContext.html#a334803088bd9af0377bdd7608b9a5876">cacheHit</a>(result);</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>}</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span> </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00521" data-start="{" data-end="}">
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a334803088bd9af0377bdd7608b9a5876">  521</a></span><a class="code hl_function" href="classclientReplyContext.html#a334803088bd9af0377bdd7608b9a5876">clientReplyContext::cacheHit</a>(<span class="keyword">const</span> <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> result)</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>{</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#aa57444bb386525911015174e9042fee3">deleting</a>) {</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;HIT object being deleted. Ignore the HIT.&quot;</span>);</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>    }</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span> </div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *e = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>();</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span> </div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *r = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span> </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> &lt;&lt; <span class="stringliteral">&quot; got &quot;</span> &lt;&lt; result);</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>() == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;clientCacheHit: request aborted&quot;</span>);</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (result.<a class="code hl_variable" href="classStoreIOBuffer.html#acb67e9b7fb58fa7b15114bd024533f44">flags</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a1e3225390c0c4999a67e22a9b503ca16">error</a>) {</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        <span class="comment">/* swap in failure */</span></div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;clientCacheHit: swapin failure for &quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>);</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5abffe054100050f80168ef5e1d7a4cb27">LOG_TCP_SWAPFAIL_MISS</a>);</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        <a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">removeClientStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>        <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>    }</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>    <span class="comment">// The previously identified hit suddenly became unshareable!</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    <span class="comment">// This is common for collapsed forwarding slaves but might also</span></div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>    <span class="comment">// happen to regular hits because we are called asynchronously.</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    <span class="keywordflow">if</span> (!e-&gt;<a class="code hl_function" href="classStoreEntry.html#a851512bf2d39ef1f9564421c26ce290f">mayStartHitting</a>()) {</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;unshareable &quot;</span> &lt;&lt; *e &lt;&lt; <span class="stringliteral">&quot;. MISS&quot;</span>);</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>        <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>    }</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(e-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462af1d0ae16fcfb269505ed3e22bc2e3fe5">ENTRY_ABORTED</a>)) {</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;refusing aborted &quot;</span> &lt;&lt; *e);</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>    }</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span> </div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span><span class="comment">     * Got the headers, now grok them</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span><span class="comment">     */</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>().<a class="code hl_variable" href="classLogTags.html#abed628637be6b214d7860ed402927259">oldType</a> == <a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a6b18a17e02ffba088ef54d6c6570a2da">LOG_TCP_HIT</a>);</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span> </div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#aaac8481b254d6cee121c75ae3e71ce8b">storeId</a>().<a class="code hl_function" href="classSBuf.html#a5ec49865cc982a78e48245f546a38ea4">cmp</a>(e-&gt;<a class="code hl_variable" href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">mem_obj</a>-&gt;<a class="code hl_function" href="classMemObject.html#acf39fcf694480bb79ff0ace66f9f791e">storeId</a>()) != 0) {</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;clientProcessHit: URL mismatch, &#39;&quot;</span> &lt;&lt; e-&gt;<a class="code hl_variable" href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">mem_obj</a>-&gt;<a class="code hl_function" href="classMemObject.html#acf39fcf694480bb79ff0ace66f9f791e">storeId</a>() &lt;&lt; <span class="stringliteral">&quot;&#39; != &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#aaac8481b254d6cee121c75ae3e71ce8b">storeId</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>); <span class="comment">// we lack a more precise LOG_*_MISS code</span></div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>        <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    }</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span> </div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    <a class="code hl_function" href="classclientReplyContext.html#ab6355997efa53f6426a7effa12e96a2c">noteStreamBufferredBytes</a>(result);</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span> </div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>    <span class="keywordflow">switch</span> (<a class="code hl_function" href="client__side_8cc.html#abc48bb93b6bb570b3ffee98f883c7f79">varyEvaluateMatch</a>(e, r)) {</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span> </div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="enums_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a23c487ebaabba2cc8dcd41323b136aa9">VARY_NONE</a>:</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        <span class="comment">/* No variance detected. Continue as normal */</span></div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="enums_8h.html#a1fb9092bcdeada2d206bdc74afbbe122ae9e4dfb086bac9073f90a3b614cc6c6d">VARY_MATCH</a>:</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>        <span class="comment">/* This is the correct entity for this request. Continue */</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 2, <span class="stringliteral">&quot;clientProcessHit: Vary MATCH!&quot;</span>);</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span> </div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="enums_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a117633d22d4a5338627c410f0289f627">VARY_OTHER</a>:</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>        <span class="comment">/* This is not the correct entity for this request. We need</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span><span class="comment">         * to requery the cache.</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span><span class="comment">         */</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>        <a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">removeClientStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>        e = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>        <span class="comment">/* Note: varyEvalyateMatch updates the request with vary information</span></div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span><span class="comment">         * so we only get here once. (it also takes care of cancelling loops)</span></div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span><span class="comment">         */</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 2, <span class="stringliteral">&quot;clientProcessHit: Vary detected!&quot;</span>);</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        <a class="code hl_friend" href="classclientReplyContext.html#a7af2f4ca6c0abc63ef6265f350fa1758">clientGetMoreData</a>(<a class="code hl_variable" href="classclientReplyContext.html#a0df8ee2233c180c19f80aabaf0bb8bd1">ourNode</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="enums_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a5dec4f1a3a983ae7827f08367330b4ab">VARY_CANCEL</a>:</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>        <span class="comment">/* varyEvaluateMatch found a object loop. Process as miss */</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;clientProcessHit: Vary object loop!&quot;</span>);</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>); <span class="comment">// we lack a more precise LOG_*_MISS code</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>        <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    }</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> </div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>    <span class="keywordflow">if</span> (r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ac284f1b2d0b0429b55542e9ca3be28d4">Http::METHOD_PURGE</a>) {</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;PURGE gets a HIT&quot;</span>);</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>        <a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">removeClientStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>        e = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>        <a class="code hl_function" href="classclientReplyContext.html#ae58ab9a507eec5431654c80222d4d6d2">purgeRequest</a>();</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>    }</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span> </div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>    <span class="keywordflow">if</span> (e-&gt;<a class="code hl_function" href="classStoreEntry.html#a9ff95b8b536905e70ee2b7c5a1972901">checkNegativeHit</a>() &amp;&amp; !r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_function" href="classRequestFlags.html#a3785f87b7c9fa79980250415c0ba7b5a">noCacheHack</a>()) {</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;negative-HIT&quot;</span>);</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a31bd86c7b936a5bb63106d8c0048abe3">LOG_TCP_NEGATIVE_HIT</a>);</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>        <a class="code hl_function" href="classclientReplyContext.html#ab7bb9cba9e77c4e81cf83757464a4974">sendMoreData</a>(result);</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="classclientReplyContext.html#a64862b976183a674826965486ff12948">blockedHit</a>()) {</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;send_hit forces a MISS&quot;</span>);</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>        <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a26c4900e600bc57c506766fcbdf3c0e3">internal</a> &amp;&amp; !<a class="code hl_variable" href="classStoreClient.html#a2eb1d9b74bda05ccf875d98aab7e276f">didCollapse</a> &amp;&amp; <a class="code hl_function" href="refresh_8cc.html#ae41c498580ee2ca2a2e6ea07a01573fd">refreshCheckHTTP</a>(e, r)) {</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;clientCacheHit: in refreshCheck() block&quot;</span>);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span><span class="comment">         * We hold a stale copy; it needs to be validated</span></div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span><span class="comment">         */</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span><span class="comment">         * The &#39;needValidation&#39; flag is used to prevent forwarding</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span><span class="comment">         * loops between siblings.  If our copy of the object is stale,</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span><span class="comment">         * then we should probably only use parents for the validation</span></div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span><span class="comment">         * request.  Otherwise two siblings could generate a loop if</span></div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span><span class="comment">         * both have a stale version of the object.</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span><span class="comment">         */</span></div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>        r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a0247d4ae2646e09402e31bc09c7ff4c6">needValidation</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span> </div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>        <span class="keywordflow">if</span> (e-&gt;<a class="code hl_function" href="classStoreEntry.html#a4550da0757f7c3aa6af8e8e9c3bcdb48">lastModified</a>() &lt; 0) {</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;validate HIT object? NO. Can&#39;t calculate entry modification time. Do MISS.&quot;</span>);</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>            <span class="comment">/*</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span><span class="comment">             * We cannot revalidate entries without knowing their</span></div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span><span class="comment">             * modification time.</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span><span class="comment">             * XXX: BUG 1890 objects without Date do not get one added.</span></div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span><span class="comment">             */</span></div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>            <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a452db2a617d946222557c73d97888918">noCache</a>) {</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;validate HIT object? NO. Client sent CC:no-cache. Do CLIENT_REFRESH_MISS&quot;</span>);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>            <span class="comment">/*</span></div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span><span class="comment">             * This did not match a refresh pattern that overrides no-cache</span></div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span><span class="comment">             * we should honour the client no-cache header.</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span><span class="comment">             */</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5ae19fd4a06c3cb6bd8515559ffd304bfd">LOG_TCP_CLIENT_REFRESH_MISS</a>);</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>            <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a267687947070d739a63da8a42969f12c">getScheme</a>() == <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca62d94ce7433f7892fb4541f72ac4ac7d">AnyP::PROTO_HTTP</a> || r-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a267687947070d739a63da8a42969f12c">getScheme</a>() == <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca0f99ccafd63891be16873f9f2abe94ba">AnyP::PROTO_HTTPS</a>) {</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;validate HIT object? YES.&quot;</span>);</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>            <span class="comment">/*</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span><span class="comment">             * Object needs to be revalidated</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span><span class="comment">             * XXX This could apply to FTP as well, if Last-Modified is known.</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span><span class="comment">             */</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>            <a class="code hl_function" href="classclientReplyContext.html#aaa60ec684c35ec0f5ed3c92c763e5ced">processExpired</a>();</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;validate HIT object? NO. Client protocol non-HTTP. Do MISS.&quot;</span>);</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>            <span class="comment">/*</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span><span class="comment">             * We don&#39;t know how to re-validate other protocols. Handle</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span><span class="comment">             * them as if the object has expired.</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span><span class="comment">             */</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>            <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>        }</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r-&gt;<a class="code hl_function" href="classHttpRequest.html#a09d9b24db99ab44f59784c5682880446">conditional</a>()) {</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;conditional HIT&quot;</span>);</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classclientReplyContext.html#adae8d439c917d422943d6b10d1227e40">processConditional</a>())</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>    }</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span> </div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span><span class="comment">     * plain ol&#39; cache hit</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span><span class="comment">     */</span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;plain old HIT&quot;</span>);</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span> </div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span><span class="preprocessor">#if USE_DELAY_POOLS</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>    <span class="keywordflow">if</span> (e-&gt;<a class="code hl_variable" href="classStoreEntry.html#adb1aad18212d6a162cfb59b3f23b5cf4">store_status</a> != <a class="code hl_enumvalue" href="enums_8h.html#af7404120c842ff6e605306823971959ea28557c32623d21545b6eb07a444c2de5">STORE_OK</a>)</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>        <span class="keywordflow">if</span> (e-&gt;<a class="code hl_variable" href="classStoreEntry.html#a0745b88b04fa7c99bd4cf6284967f591">mem_status</a> == <a class="code hl_enumvalue" href="enums_8h.html#a4b579b085278da684923630e626c6351af00ce42df4a8aaf2747d419dfc43ee34">IN_MEMORY</a>)</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a75f8d8f24297647ede5f517c1a659fe1">LOG_TCP_MEM_HIT</a>);</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#a94f4d58b36060eb76c6d6ca9eda4c755">offline</a>)</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a426f2351c79f420e8fead9a1ba831be3">LOG_TCP_OFFLINE_HIT</a>);</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span> </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    <a class="code hl_function" href="classclientReplyContext.html#ab7bb9cba9e77c4e81cf83757464a4974">sendMoreData</a>(result);</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>}</div>
</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span> </div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00704" data-start="{" data-end="}">
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">  704</a></span><a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">clientReplyContext::processMiss</a>()</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>{</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>    <span class="keywordtype">char</span> *url = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>;</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *r = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>    <a class="code hl_class" href="classErrorState.html">ErrorState</a> *err = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 4, r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; url);</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span> </div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()) {</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462a6c0b60acdcf1cefdb5f3a847b5f90224">ENTRY_SPECIAL</a>)) {</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;clientProcessMiss: miss on a special object (&quot;</span> &lt;&lt; url &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>);</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;\tlog_type = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>().<a class="code hl_function" href="classLogTags.html#a1f2b07a97f2fafe2d309e37595724aab">c_str</a>());</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a2d3a77bc0c8dad6b7b9084aaf6998251">dump</a>(1);</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>        }</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span> </div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>        <a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">removeClientStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>    }</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span> </div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>    <span class="keywordflow">if</span> (r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ac284f1b2d0b0429b55542e9ca3be28d4">Http::METHOD_PURGE</a>) {</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>        <a class="code hl_function" href="classclientReplyContext.html#ae58ab9a507eec5431654c80222d4d6d2">purgeRequest</a>();</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    }</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span> </div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>    <span class="keywordflow">if</span> (r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a1fa639d2eb3bfb92c2b42d4703450ba9">Http::METHOD_OTHER</a>) {</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>        <a class="code hl_function" href="classclientReplyContext.html#a0da0eb1eedbc3a7e7d7bf0b19feccd72">purgeAllCached</a>();</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>    }</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span> </div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab2d33ce5e3e5a930de04639ee09a1bcc">onlyIfCached</a>()) {</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>        <a class="code hl_function" href="classclientReplyContext.html#a62122fdbe3300c20b4464e1d48e1d5a5">processOnlyIfCachedMiss</a>();</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    }</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>    <span class="keywordflow">if</span> (r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#ace4ab3e57a3fa9e3197ce200ecdf653a">loopDetected</a>) {</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a753215d3854b1129173deb898f7c7e99">http</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1HttpDetails.html#afaef5bd16c55d6723beb468d0bc75643">code</a> = <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a>;</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>        err = <a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(<a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa16e7157079ceea3394a7a000af25c013">ERR_ACCESS_DENIED</a>, <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a>, <span class="keyword">nullptr</span>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>(), <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>        <a class="code hl_function" href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">createStoreEntry</a>(r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>, <a class="code hl_class" href="classRequestFlags.html">RequestFlags</a>());</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>        <a class="code hl_function" href="group__ErrorPageAPI.html#gae984c9bcabfcfb5f0f732a501169a388">errorAppendEntry</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(), err);</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>        <a class="code hl_function" href="classclientReplyContext.html#a309764bf3b36e0af99299869fdba6c24">triggerInitialStoreRead</a>();</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>        <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a> == 0);</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>        <a class="code hl_function" href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">createStoreEntry</a>(r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>, r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>);</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>        <a class="code hl_function" href="classclientReplyContext.html#a309764bf3b36e0af99299869fdba6c24">triggerInitialStoreRead</a>();</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span> </div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#afc0f851aa12908396cb5457c085a4e6f">redirect</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Redirect.html#a51a61e18a57f2018c331c346b4a75816">status</a>) {</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>            <span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">HttpReplyPointer</a> rep(<span class="keyword">new</span> <a class="code hl_class" href="classHttpReply.html">HttpReply</a>);</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a4228cbccd4cbcf5bb01cd29c88e9b313">LOG_TCP_REDIRECT</a>);</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#addfd77d9dd303940e6f323d714da2e89">releaseRequest</a>();</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>            rep-&gt;<a class="code hl_function" href="classHttpReply.html#a849bd4060a868cd2b6c82e39604ee06f">redirect</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#afc0f851aa12908396cb5457c085a4e6f">redirect</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Redirect.html#a51a61e18a57f2018c331c346b4a75816">status</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#afc0f851aa12908396cb5457c085a4e6f">redirect</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Redirect.html#a98ac56cf94b890c981797389fba6b520">location</a>);</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#aae28c5e9a323d60ac8fe8ce98f6eb7c5">replaceHttpReply</a>(rep);</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a3ae4c0876a20686e558e7183b67805f4">complete</a>();</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>        }</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span> </div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>        <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a13f1a21e71a902ac14ab9b4ee8133276">clientConnectionManager</a> == <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>());</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>        <a class="code hl_class" href="classRefCount.html">Comm::ConnectionPointer</a> conn = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>() != <span class="keyword">nullptr</span> ? <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a> : <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>        <a class="code hl_function" href="classFwdState.html#a391d66921577e62e543723f978062e97">FwdState::Start</a>(conn, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(), r, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>    }</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>}</div>
</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span> </div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00780" data-start="{" data-end="}">
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a62122fdbe3300c20b4464e1d48e1d5a5">  780</a></span><a class="code hl_function" href="classclientReplyContext.html#a62122fdbe3300c20b4464e1d48e1d5a5">clientReplyContext::processOnlyIfCachedMiss</a>()</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>{</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 4, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>);</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a753215d3854b1129173deb898f7c7e99">http</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1HttpDetails.html#afaef5bd16c55d6723beb468d0bc75643">code</a> = <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a16974375186a414ff6a7a9837581904f">Http::scGatewayTimeout</a>;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>    <a class="code hl_class" href="classErrorState.html">ErrorState</a> *err = <a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(<a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aaf7b4c272b06f31b6c285d7fd110b72fd">ERR_ONLY_IF_CACHED_MISS</a>, <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a16974375186a414ff6a7a9837581904f">Http::scGatewayTimeout</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>                                       <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>(), <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>    <a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">removeClientStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>    <a class="code hl_function" href="classclientReplyContext.html#a4c65a525bd9fc6c042e060c434822948">startError</a>(err);</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>}</div>
</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span> </div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00792" data-start="{" data-end="}">
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#adae8d439c917d422943d6b10d1227e40">  792</a></span><a class="code hl_function" href="classclientReplyContext.html#adae8d439c917d422943d6b10d1227e40">clientReplyContext::processConditional</a>()</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>{</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *<span class="keyword">const</span> e = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>();</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span> </div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>    <span class="keyword">const</span> <span class="keyword">auto</span> replyStatusCode = e-&gt;<a class="code hl_function" href="classStoreEntry.html#a19fd5af89e99c467c29f7bd951ac901d">mem</a>().<a class="code hl_function" href="classMemObject.html#ad5355b4679045222e5ea75b0c36f16c4">baseReply</a>().<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_function" href="classHttp_1_1StatusLine.html#af852e58bb3e96bc41cd16787b0a7d7db">status</a>();</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>    <span class="keywordflow">if</span> (replyStatusCode != <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722aad8d279f381aa192a9f4389158d1b25e">Http::scOkay</a>) {</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 4, <span class="stringliteral">&quot;miss because &quot;</span> &lt;&lt; replyStatusCode &lt;&lt; <span class="stringliteral">&quot; != 200&quot;</span>);</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>        <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    }</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span> </div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> &amp;r = *<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span> </div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>    <span class="keywordflow">if</span> (r.<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a77e5b4d86480fd03b87843c0cdfdbdfd">Http::HdrType::IF_MATCH</a>) &amp;&amp; !e-&gt;<a class="code hl_function" href="classStoreEntry.html#a1c68aa08115a04dec516f91cae276f08">hasIfMatchEtag</a>(r)) {</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>        <span class="comment">// RFC 2616: reply with 412 Precondition Failed if If-Match did not match</span></div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>        <a class="code hl_function" href="classclientReplyContext.html#a23ed47bc9f4ef61b40462fce26657140">sendPreconditionFailedError</a>();</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>    }</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span> </div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>    <span class="keywordflow">if</span> (r.<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4aa83838d4c8ca01ddfbec2af8759a0c3e">Http::HdrType::IF_NONE_MATCH</a>)) {</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>        <span class="comment">// RFC 7232: If-None-Match recipient MUST ignore IMS</span></div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>        r.<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a12193c977b3da18c04e6e4b350e860ba">ims</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>        r.<a class="code hl_variable" href="classHttpRequest.html#a5f8f335cf16fa13580238d91973bc566">ims</a> = -1;</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>        r.<a class="code hl_variable" href="classHttpRequest.html#a6617b5b1e4c90874af16ac68e0f8673c">imslen</a> = 0;</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>        r.<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">delById</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4ab72dfe4a5620a1e4d7b096afe4aca653">Http::HdrType::IF_MODIFIED_SINCE</a>);</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span> </div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>        <span class="keywordflow">if</span> (e-&gt;<a class="code hl_function" href="classStoreEntry.html#a29fe3b09ae97a5337dc29c741d90cfe2">hasIfNoneMatchEtag</a>(r)) {</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>            <a class="code hl_function" href="classclientReplyContext.html#a0ec275cfe423205b6348b57c50fd9ca0">sendNotModifiedOrPreconditionFailedError</a>();</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>        }</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span> </div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>        <span class="comment">// None-Match is true (no ETag matched); treat as an unconditional hit</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>    }</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span> </div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    <span class="keywordflow">if</span> (r.<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a12193c977b3da18c04e6e4b350e860ba">ims</a>) {</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>        <span class="comment">// handle If-Modified-Since requests from the client</span></div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>        <span class="keywordflow">if</span> (e-&gt;<a class="code hl_function" href="classStoreEntry.html#ac7b0d2255cb46a1be80dd95ea4230543">modifiedSince</a>(r.<a class="code hl_variable" href="classHttpRequest.html#a5f8f335cf16fa13580238d91973bc566">ims</a>, r.<a class="code hl_variable" href="classHttpRequest.html#a6617b5b1e4c90874af16ac68e0f8673c">imslen</a>)) {</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>            <span class="comment">// Modified-Since is true; treat as an unconditional hit</span></div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span> </div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>            <span class="comment">// otherwise reply with 304 Not Modified</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>            <a class="code hl_function" href="classclientReplyContext.html#a52be4e7796600f0a88e09f4b60351123">sendNotModified</a>();</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>        }</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>    }</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span> </div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>}</div>
</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span> </div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00846" data-start="{" data-end="}">
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a64862b976183a674826965486ff12948">  846</a></span><a class="code hl_function" href="classclientReplyContext.html#a64862b976183a674826965486ff12948">clientReplyContext::blockedHit</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#ac58776fd75b996c42d22bdd69c17d31f">sendHit</a>)</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// hits are not blocked by default</span></div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span> </div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a26c4900e600bc57c506766fcbdf3c0e3">internal</a>)</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// internal content &quot;hits&quot; cannot be blocked</span></div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span> </div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    {</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>        <a class="code hl_class" href="classACLFilledChecklist.html">ACLFilledChecklist</a> chl(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#ac58776fd75b996c42d22bdd69c17d31f">sendHit</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>        <a class="code hl_function" href="client__side_8cc.html#acabcacffff4309ce2ac0aa3252eaf2ba">clientAclChecklistFill</a>(chl, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>        chl.<a class="code hl_function" href="classACLFilledChecklist.html#a8f0f73e6ee8033be85471a92bd9d4703">updateReply</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a19fd5af89e99c467c29f7bd951ac901d">mem</a>().<a class="code hl_function" href="classMemObject.html#a89697947bc40cdbe591b9e26951b59ba">freshestReply</a>());</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>        <span class="keywordflow">return</span> !chl.<a class="code hl_function" href="classACLChecklist.html#a51ae541a90994e7ed5d11f2b242ac689">fastCheck</a>().<a class="code hl_function" href="classAcl_1_1Answer.html#af1a1444d19654eb50f7a4323b225f845">allowed</a>(); <span class="comment">// when in doubt, block</span></div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>    }</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>}</div>
</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span> </div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span><span class="comment">// Purges all entries with a given url</span></div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span><span class="comment">// TODO: move to SideAgent parent, when we have one</span></div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span><span class="comment">/*</span></div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span><span class="comment"> * We probably cannot purge Vary-affected responses because their MD5</span></div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span><span class="comment"> * keys depend on vary headers.</span></div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span><span class="comment"> */</span></div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00869" data-start="{" data-end="}">
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno"><a class="line" href="client__side__reply_8cc.html#ac5bafe6dcd14e8927161d0ea22a77a7d">  869</a></span><a class="code hl_function" href="client__side__reply_8cc.html#ac5bafe6dcd14e8927161d0ea22a77a7d">purgeEntriesByUrl</a>(<a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> * req, <span class="keyword">const</span> <span class="keywordtype">char</span> *url)</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>{</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>    <span class="keywordflow">for</span> (<a class="code hl_class" href="classHttpRequestMethod.html">HttpRequestMethod</a> m(<a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a17353570f8312493328aa9ade6ff514a">Http::METHOD_NONE</a>); m != <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787aaf87eb41a8f3de92bb4f977918d2f575">Http::METHOD_ENUM_END</a>; ++m) {</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>        <span class="keywordflow">if</span> (m.respMaybeCacheable()) {</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="store_2forward_8h.html#ab1424e1b13666cc28f4c5cb05f8c8305">cache_key</a> *key = <a class="code hl_function" href="store__key__md5_8cc.html#a9a805f970e159065a2c53ac9ef027fb3">storeKeyPublic</a>(url, m);</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, m &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; url &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key));</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span><span class="preprocessor">#if USE_HTCP</span></div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>            <a class="code hl_function" href="neighbors_8cc.html#a2f4988cdd50e3844d829a7c363dcce5c">neighborsHtcpClear</a>(<span class="keyword">nullptr</span>, req, m, <a class="code hl_enumvalue" href="enums_8h.html#a53f367a6c6ec6520d99a817d002ad400a09b1e395245d61c0ede69b66df4bf704">HTCP_CLR_INVALIDATION</a>);</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>            (void)req;</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>            <a class="code hl_function" href="namespaceStore.html#a0151d620409db8bd3af40e3570a18f8c">Store::Root</a>().<a class="code hl_function" href="classStore_1_1Controller.html#aedba791b442f1fac585676381e262777">evictIfFound</a>(key);</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>        }</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>    }</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>}</div>
</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span> </div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00886" data-start="{" data-end="}">
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a0da0eb1eedbc3a7e7d7bf0b19feccd72">  886</a></span><a class="code hl_function" href="classclientReplyContext.html#a0da0eb1eedbc3a7e7d7bf0b19feccd72">clientReplyContext::purgeAllCached</a>()</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>{</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>    <span class="comment">// XXX: performance regression, c_str() reallocates</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>    <a class="code hl_class" href="classSBuf.html">SBuf</a> url(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">effectiveRequestUri</a>());</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>    <a class="code hl_function" href="client__side__reply_8h.html#ae60b3e554dff5b38d232bd69c129e3b2">purgeEntriesByUrl</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, url.<a class="code hl_function" href="classSBuf.html#a2a7fda503e54cb36b023dcaaab633f65">c_str</a>());</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>}</div>
</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span> </div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span><a class="code hl_class" href="classLogTags.html">LogTags</a> *</div>
<div class="foldopen" id="foldopen00894" data-start="{" data-end="}">
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ac621a71c20c51fd65f0682432d2e2b57">  894</a></span><a class="code hl_function" href="classclientReplyContext.html#ac621a71c20c51fd65f0682432d2e2b57">clientReplyContext::loggingTags</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>    <span class="comment">// XXX: clientReplyContext code assumes that http cbdata is always valid.</span></div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>    <span class="comment">// TODO: Either add cbdataReferenceValid(http) checks in all the relevant</span></div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>    <span class="comment">// places, like this one, or remove cbdata protection of the http member.</span></div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a4574f49181917c5496dca9ace95ea344">cache</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1CacheDetails.html#ae7601ddfc08eef5f4af309c87f3ff59f">code</a>;</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>}</div>
</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span> </div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00903" data-start="{" data-end="}">
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ae58ab9a507eec5431654c80222d4d6d2">  903</a></span><a class="code hl_function" href="classclientReplyContext.html#ae58ab9a507eec5431654c80222d4d6d2">clientReplyContext::purgeRequest</a>()</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>{</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;Config2.onoff.enable_purge = &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>           <a class="code hl_variable" href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a>.<a class="code hl_variable" href="classSquidConfig2.html#a71811e08ee22e6566509b77f361fc571">onoff</a>.<a class="code hl_variable" href="classSquidConfig2.html#a0b005dab9003e750f2244117a1896623">enable_purge</a>);</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span> </div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a>.<a class="code hl_variable" href="classSquidConfig2.html#a71811e08ee22e6566509b77f361fc571">onoff</a>.<a class="code hl_variable" href="classSquidConfig2.html#a0b005dab9003e750f2244117a1896623">enable_purge</a>) {</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a16a4df28091bca4eda98565febc8fe36">LOG_TCP_DENIED</a>);</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>        <a class="code hl_class" href="classErrorState.html">ErrorState</a> *err = <a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(<a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa16e7157079ceea3394a7a000af25c013">ERR_ACCESS_DENIED</a>, <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>                                           <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>(), <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>        <a class="code hl_function" href="classclientReplyContext.html#a4c65a525bd9fc6c042e060c434822948">startError</a>(err);</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>    }</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span> </div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>    <span class="comment">/* Release both IP cache */</span></div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>    <a class="code hl_function" href="group__IPCacheAPI.html#ga58164ac8ac971b97bca837a3d4bb9efe">ipcacheInvalidate</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">host</a>());</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span> </div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>    <span class="comment">// TODO: can we use purgeAllCached() here instead?</span></div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>    <a class="code hl_function" href="classclientReplyContext.html#af0369b1042f9cfdbcea8c5b314c90aff">purgeDoPurge</a>();</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>}</div>
</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span> </div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00924" data-start="{" data-end="}">
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#af0369b1042f9cfdbcea8c5b314c90aff">  924</a></span><a class="code hl_function" href="classclientReplyContext.html#af0369b1042f9cfdbcea8c5b314c90aff">clientReplyContext::purgeDoPurge</a>()</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>{</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>    <span class="keyword">auto</span> firstFound = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> entry = <a class="code hl_function" href="store_8cc.html#a6ffbfacd8471ff973b224f96bdf702ca">storeGetPublicByRequestMethod</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a>)) {</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>        <span class="comment">// special entries are only METHOD_GET entries without variance</span></div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(entry-&gt;flags, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462a6c0b60acdcf1cefdb5f3a847b5f90224">ENTRY_SPECIAL</a>)) {</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a16a4df28091bca4eda98565febc8fe36">LOG_TCP_DENIED</a>);</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>            <span class="keyword">const</span> <span class="keyword">auto</span> err = <a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(<a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa16e7157079ceea3394a7a000af25c013">ERR_ACCESS_DENIED</a>, <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>                                              <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>(), <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>            <a class="code hl_function" href="classclientReplyContext.html#a4c65a525bd9fc6c042e060c434822948">startError</a>(err);</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>            entry-&gt;abandon(__func__);</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>        }</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>        firstFound = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="classclientReplyContext.html#aac3fe5e8a5d5f0e2d71c531ac0ac9675">purgeEntry</a>(*entry, <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a>))</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>    }</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span> </div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>    <a class="code hl_function" href="classclientReplyContext.html#afe190509d5386d07c17a26759742bb3c">detailStoreLookup</a>(<a class="code hl_function" href="classclientReplyContext.html#aabf64bc2c4116b2cd2181ad8bc060353">storeLookupString</a>(firstFound));</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span> </div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> entry = <a class="code hl_function" href="store_8cc.html#a6ffbfacd8471ff973b224f96bdf702ca">storeGetPublicByRequestMethod</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b">Http::METHOD_HEAD</a>)) {</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="classclientReplyContext.html#aac3fe5e8a5d5f0e2d71c531ac0ac9675">purgeEntry</a>(*entry, <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b">Http::METHOD_HEAD</a>))</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>    }</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span> </div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>    <span class="comment">/* And for Vary, release the base URI if none of the headers was included in the request */</span></div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a8b90084ccd19905f1fc8eebc9ff3a60e">vary_headers</a>.<a class="code hl_function" href="classSBuf.html#a8bda8fe69e451e61946b35c2a2d2340b">isEmpty</a>()</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>            &amp;&amp; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a8b90084ccd19905f1fc8eebc9ff3a60e">vary_headers</a>.<a class="code hl_function" href="classSBuf.html#a7baba649622f53390f267b15d65052be">find</a>(<span class="charliteral">&#39;=&#39;</span>) != <a class="code hl_variable" href="classSBuf.html#a1db91b2f039b38745f7d73b56ac9311f">SBuf::npos</a>) {</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>        <span class="comment">// XXX: performance regression, c_str() reallocates</span></div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>        <a class="code hl_class" href="classSBuf.html">SBuf</a> tmp(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">effectiveRequestUri</a>());</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span> </div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> entry = <a class="code hl_function" href="store_8cc.html#a925dbf2023674d27f243e19c35f5c008">storeGetPublic</a>(tmp.<a class="code hl_function" href="classSBuf.html#a2a7fda503e54cb36b023dcaaab633f65">c_str</a>(), <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a>)) {</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="classclientReplyContext.html#aac3fe5e8a5d5f0e2d71c531ac0ac9675">purgeEntry</a>(*entry, <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a>, <span class="stringliteral">&quot;Vary &quot;</span>))</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>        }</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span> </div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> entry = <a class="code hl_function" href="store_8cc.html#a925dbf2023674d27f243e19c35f5c008">storeGetPublic</a>(tmp.<a class="code hl_function" href="classSBuf.html#a2a7fda503e54cb36b023dcaaab633f65">c_str</a>(), <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b">Http::METHOD_HEAD</a>)) {</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="classclientReplyContext.html#aac3fe5e8a5d5f0e2d71c531ac0ac9675">purgeEntry</a>(*entry, <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b">Http::METHOD_HEAD</a>, <span class="stringliteral">&quot;Vary &quot;</span>))</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>        }</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>    }</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span> </div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#a4c5c3b93670c261a61aef36d69354169">purgeStatus</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722aab61d70dce6e121feb658b24ef1cd815">Http::scNone</a>)</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>        <a class="code hl_variable" href="classclientReplyContext.html#a4c5c3b93670c261a61aef36d69354169">purgeStatus</a> = <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a9156f33c4844fa3aa50606ebacb750f7">Http::scNotFound</a>;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span> </div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span><span class="comment">     * Make a new entry to hold the reply to be written</span></div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span><span class="comment">     * to the client.</span></div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span><span class="comment">     */</span></div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>    <span class="comment">/* TODO: This doesn&#39;t need to go through the store. Simply</span></div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span><span class="comment">     * push down the client chain</span></div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span><span class="comment">     */</span></div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>    <a class="code hl_function" href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">createStoreEntry</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>, <a class="code hl_class" href="classRequestFlags.html">RequestFlags</a>());</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span> </div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>    <a class="code hl_function" href="classclientReplyContext.html#a309764bf3b36e0af99299869fdba6c24">triggerInitialStoreRead</a>();</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span> </div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>    <span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">HttpReplyPointer</a> rep(<span class="keyword">new</span> <a class="code hl_class" href="classHttpReply.html">HttpReply</a>);</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>    rep-&gt;<a class="code hl_function" href="classHttpReply.html#a5915e24ce1c0233d7f8466a2f7d22456">setHeaders</a>(<a class="code hl_variable" href="classclientReplyContext.html#a4c5c3b93670c261a61aef36d69354169">purgeStatus</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, 0, 0, -1);</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#aae28c5e9a323d60ac8fe8ce98f6eb7c5">replaceHttpReply</a>(rep);</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a3ae4c0876a20686e558e7183b67805f4">complete</a>();</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>}</div>
</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span> </div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00987" data-start="{" data-end="}">
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#aac3fe5e8a5d5f0e2d71c531ac0ac9675">  987</a></span><a class="code hl_function" href="classclientReplyContext.html#aac3fe5e8a5d5f0e2d71c531ac0ac9675">clientReplyContext::purgeEntry</a>(<a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> &amp;entry, <span class="keyword">const</span> <a class="code hl_typedef" href="namespaceHttp.html#a0037b8798f4cd247893861d2d18e051e">Http::MethodType</a> methodType, <span class="keyword">const</span> <span class="keywordtype">char</span> *descriptionPrefix)</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>{</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 4, descriptionPrefix &lt;&lt; <a class="code hl_function" href="namespaceHttp.html#a58167438595391e06cff41c13913de23">Http::MethodStr</a>(methodType) &lt;&lt; <span class="stringliteral">&quot; &#39;&quot;</span> &lt;&lt; entry.<a class="code hl_function" href="classStoreEntry.html#a3835284a1cb3623987d557c9754e5ffc">url</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span> );</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span><span class="preprocessor">#if USE_HTCP</span></div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    <a class="code hl_function" href="neighbors_8cc.html#a2f4988cdd50e3844d829a7c363dcce5c">neighborsHtcpClear</a>(&amp;entry, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_class" href="classHttpRequestMethod.html">HttpRequestMethod</a>(methodType), <a class="code hl_enumvalue" href="enums_8h.html#a53f367a6c6ec6520d99a817d002ad400aa19c85f7acec13d3daa407a93c92f508">HTCP_CLR_PURGE</a>);</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>    entry.<a class="code hl_function" href="classStoreEntry.html#a463a7aa5404ee7401d27ebc0caeaf1fe">release</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    <a class="code hl_variable" href="classclientReplyContext.html#a4c5c3b93670c261a61aef36d69354169">purgeStatus</a> = <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722aad8d279f381aa192a9f4389158d1b25e">Http::scOkay</a>;</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>}</div>
</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span> </div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00999" data-start="{" data-end="}">
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ac7c34d6a9882a32152c928d6f1ed8e57">  999</a></span><a class="code hl_function" href="classclientReplyContext.html#ac7c34d6a9882a32152c928d6f1ed8e57">clientReplyContext::traceReply</a>()</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>{</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>    <a class="code hl_function" href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">createStoreEntry</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>, <a class="code hl_class" href="classRequestFlags.html">RequestFlags</a>());</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>    <a class="code hl_function" href="classclientReplyContext.html#a309764bf3b36e0af99299869fdba6c24">triggerInitialStoreRead</a>();</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#addfd77d9dd303940e6f323d714da2e89">releaseRequest</a>();</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#adbe63b6b215b04af68e9290dbfb7b45a">buffer</a>();</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>    <a class="code hl_class" href="classMemBuf.html">MemBuf</a> content;</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>    content.<a class="code hl_function" href="classMemBuf.html#a4a615d8e887439c66e04aab70f8be60a">init</a>();</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#a54b1b1d850d85e6ad33ff19febb6adc8">pack</a>(&amp;content, <span class="keyword">true</span> <span class="comment">/* hide authorization data */</span>);</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>    <span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">HttpReplyPointer</a> rep(<span class="keyword">new</span> <a class="code hl_class" href="classHttpReply.html">HttpReply</a>);</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>    rep-&gt;<a class="code hl_function" href="classHttpReply.html#a5915e24ce1c0233d7f8466a2f7d22456">setHeaders</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722aad8d279f381aa192a9f4389158d1b25e">Http::scOkay</a>, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;message/http&quot;</span>, content.<a class="code hl_function" href="classMemBuf.html#aaaf0cc30487417b07680613bcf518dca">contentSize</a>(), 0, <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a>);</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>    rep-&gt;<a class="code hl_variable" href="classHttpReply.html#a79019e0e1ec286b22748ca291bea0637">body</a>.<a class="code hl_function" href="classHttpBody.html#abb3eb1a004f3a6c95f77207855d2b2fd">set</a>(<a class="code hl_class" href="classSBuf.html">SBuf</a>(content.<a class="code hl_variable" href="classMemBuf.html#a78daaa064a5aa4557e283a01c4aa27f1">buf</a>, content.<a class="code hl_variable" href="classMemBuf.html#a512e0e6f4a6b327f31c9db28fe9aaeb3">size</a>));</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#aae28c5e9a323d60ac8fe8ce98f6eb7c5">replaceHttpReply</a>(rep);</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a028aa7eef91cf47c704d42ab5ab58a42">completeSuccessfully</a>(<span class="stringliteral">&quot;traceReply() stored the entire response&quot;</span>);</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>}</div>
</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span> </div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"><a class="line" href="client__side__reply_8cc.html#a32ae6205e542abf706a948cd83ec2ab0"> 1015</a></span><span class="preprocessor">#define SENDING_BODY 0</span></div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"><a class="line" href="client__side__reply_8cc.html#ac9df148be58139e68652ba4e4b119468"> 1016</a></span><span class="preprocessor">#define SENDING_HDRSONLY 1</span></div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span><span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen01018" data-start="{" data-end="}">
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a9008dda5fcc8b05839bdfd845be21d0f"> 1018</a></span><a class="code hl_function" href="classclientReplyContext.html#a9008dda5fcc8b05839bdfd845be21d0f">clientReplyContext::checkTransferDone</a>()</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>{</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *entry = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>();</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span> </div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>    <span class="keywordflow">if</span> (entry == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span> </div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span><span class="comment">     * For now, &#39;done_copying&#39; is used for special cases like</span></div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span><span class="comment">     * Range and HEAD requests.</span></div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span><span class="comment">     */</span></div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#aaa05fd2e87baa36553d2039aa92901a3">flags</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Flags.html#ada185aa70ccc6b2da21c33f453dca0b5">done_copying</a>)</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span> </div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a1e3c53bb0466b666037f1db1fc3dd00b">chunkedReply</a> &amp;&amp; !<a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#a9fd53bdc9adcf5af7aab7d5c4312ccd0">complete</a>) {</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>        <span class="comment">// last-chunk was not sent</span></div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>    }</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span> </div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span><span class="comment">     * Handle STORE_OK objects.</span></div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span><span class="comment">     * objectLen(entry) will be set properly.</span></div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span><span class="comment">     * RC: Does objectLen(entry) include the Headers?</span></div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span><span class="comment">     * RC: Yes.</span></div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span><span class="comment">     */</span></div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>    <span class="keywordflow">if</span> (entry-&gt;<a class="code hl_variable" href="classStoreEntry.html#adb1aad18212d6a162cfb59b3f23b5cf4">store_status</a> == <a class="code hl_enumvalue" href="enums_8h.html#af7404120c842ff6e605306823971959ea28557c32623d21545b6eb07a444c2de5">STORE_OK</a>) {</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classclientReplyContext.html#adc3fb054f353c7e78ef0728eaac04bb6">storeOKTransferDone</a>();</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classclientReplyContext.html#a77120a77cedbeaca1b4cb3570cef4048">storeNotOKTransferDone</a>();</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>    }</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>}</div>
</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span> </div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span><span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen01051" data-start="{" data-end="}">
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#adc3fb054f353c7e78ef0728eaac04bb6"> 1051</a></span><a class="code hl_function" href="classclientReplyContext.html#adc3fb054f353c7e78ef0728eaac04bb6">clientReplyContext::storeOKTransferDone</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#ad52e359c5dad8a74f7b28168f37f64fc">objectLen</a>() &gt;= 0);</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>    <span class="keyword">const</span> <span class="keyword">auto</span> headers_sz = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a19fd5af89e99c467c29f7bd951ac901d">mem</a>().<a class="code hl_function" href="classMemObject.html#ad5355b4679045222e5ea75b0c36f16c4">baseReply</a>().<a class="code hl_variable" href="classHttp_1_1Message.html#a7d9970e0240d7981206d051db1719d93">hdr_sz</a>;</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#ad52e359c5dad8a74f7b28168f37f64fc">objectLen</a>() &gt;= headers_sz);</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>    <span class="keyword">const</span> <span class="keyword">auto</span> done = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a> &gt;= <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#ad52e359c5dad8a74f7b28168f37f64fc">objectLen</a>() - headers_sz;</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>    <span class="keyword">const</span> <span class="keyword">auto</span> debugLevel = done ? 3 : 5;</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, debugLevel, done &lt;&lt;</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>           <span class="stringliteral">&quot; out.offset=&quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a> &lt;&lt;</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>           <span class="stringliteral">&quot; objectLen()=&quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#ad52e359c5dad8a74f7b28168f37f64fc">objectLen</a>() &lt;&lt;</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>           <span class="stringliteral">&quot; headers_sz=&quot;</span> &lt;&lt; headers_sz);</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>    <span class="keywordflow">return</span> done ? 1 : 0;</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>}</div>
</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span> </div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span><span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen01066" data-start="{" data-end="}">
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a77120a77cedbeaca1b4cb3570cef4048"> 1066</a></span><a class="code hl_function" href="classclientReplyContext.html#a77120a77cedbeaca1b4cb3570cef4048">clientReplyContext::storeNotOKTransferDone</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span><span class="comment">     * Now, handle STORE_PENDING objects</span></div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span><span class="comment">     */</span></div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>    <a class="code hl_class" href="classMemObject.html">MemObject</a> *mem = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">mem_obj</a>;</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(mem != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span> </div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a4e4ae536cc1051c029641e75c5815cfd">hasParsedReplyHeader</a>())</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>        <span class="comment">/* haven&#39;t found end of headers yet */</span></div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span> </div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>    <span class="comment">// TODO: Use MemObject::expectedReplySize(method) after resolving XXX below.</span></div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>    <span class="keyword">const</span> <span class="keyword">auto</span> expectedBodySize = mem-&gt;<a class="code hl_function" href="classMemObject.html#ad5355b4679045222e5ea75b0c36f16c4">baseReply</a>().<a class="code hl_variable" href="classHttp_1_1Message.html#aa6074e26e4827d7a52e5ae9500c10500">content_length</a>;</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span> </div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>    <span class="comment">// XXX: The code below talks about sending data, and checks stats about</span></div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>    <span class="comment">// bytes written to the client connection, but this method must determine</span></div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>    <span class="comment">// whether we are done _receiving_ data from Store. This code should work OK</span></div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>    <span class="comment">// when expectedBodySize is unknown or matches written data, but it may</span></div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>    <span class="comment">// malfunction when we are writing ranges while receiving a full response.</span></div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span> </div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span><span class="comment">     * Figure out how much data we are supposed to send.</span></div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span><span class="comment">     * If we are sending a body and we don&#39;t have a content-length,</span></div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span><span class="comment">     * then we must wait for the object to become STORE_OK.</span></div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span><span class="comment">     */</span></div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>    <span class="keywordflow">if</span> (expectedBodySize &lt; 0)</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span> </div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>    <span class="keyword">const</span> <span class="keyword">auto</span> done = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a> &gt;= expectedBodySize;</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>    <span class="keyword">const</span> <span class="keyword">auto</span> debugLevel = done ? 3 : 5;</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, debugLevel, done &lt;&lt;</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>           <span class="stringliteral">&quot; out.offset=&quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a> &lt;&lt;</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>           <span class="stringliteral">&quot; expectedBodySize=&quot;</span> &lt;&lt; expectedBodySize);</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>    <span class="keywordflow">return</span> done ? 1 : 0;</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>}</div>
</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span> </div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span><span class="comment">/* Preconditions:</span></div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span><span class="comment"> * *http is a valid structure.</span></div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span><span class="comment"> * fd is either -1, or an open fd.</span></div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span><span class="comment"> *</span></div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span><span class="comment"> * TODO: enumify this</span></div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span><span class="comment"> *</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span><span class="comment"> * This function is used by any http request sink, to determine the status</span></div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span><span class="comment"> * of the object.</span></div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span><span class="comment"> */</span></div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span><a class="code hl_enumeration" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876b">clientStream_status_t</a></div>
<div class="foldopen" id="foldopen01114" data-start="{" data-end="}">
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"><a class="line" href="client__side__reply_8cc.html#aef1e1e78645a7df766e17b65bad72d9a"> 1114</a></span><a class="code hl_variable" href="client__side__reply_8cc.html#a3d42a7ece901f14e6ec973a0feb096e1">clientReplyStatus</a>(<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> * aNode, <a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> * http)</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>{</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>    <a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *context = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *<span class="keyword">&gt;</span>(aNode-&gt;<a class="code hl_variable" href="classclientStreamNode.html#a3ffd025e7396d93b36a80c2048915ac8">data</a>.<a class="code hl_function" href="classRefCount.html#a9f2168c1df4a4ab6b7931425d85c37f0">getRaw</a>());</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a> (context);</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a> (context-&gt;<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a> == http);</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>    <span class="keywordflow">return</span> context-&gt;<a class="code hl_function" href="classclientReplyContext.html#abcc95e4098085acbe1d02a3d94583e0a">replyStatus</a>();</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>}</div>
</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span> </div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span><a class="code hl_enumeration" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876b">clientStream_status_t</a></div>
<div class="foldopen" id="foldopen01123" data-start="{" data-end="}">
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#abcc95e4098085acbe1d02a3d94583e0a"> 1123</a></span><a class="code hl_function" href="classclientReplyContext.html#abcc95e4098085acbe1d02a3d94583e0a">clientReplyContext::replyStatus</a>()</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>{</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>    <span class="keywordtype">int</span> done;</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>    <span class="comment">/* Here because lower nodes don&#39;t need it */</span></div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span> </div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>() == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;clientReplyStatus: no storeEntry&quot;</span>);</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876bae425b0891f7f866775009972cae49d71">STREAM_FAILED</a>;   <span class="comment">/* yuck, but what can we do? */</span></div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>    }</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span> </div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462af1d0ae16fcfb269505ed3e22bc2e3fe5">ENTRY_ABORTED</a>)) {</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>        <span class="comment">/* TODO: Could upstream read errors (result.flags.error) be</span></div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span><span class="comment">         * lost, and result in undersize requests being considered</span></div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span><span class="comment">         * complete. Should we tcp reset such connections ?</span></div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span><span class="comment">         */</span></div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;clientReplyStatus: aborted storeEntry&quot;</span>);</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876bae425b0891f7f866775009972cae49d71">STREAM_FAILED</a>;</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>    }</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span> </div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>    <span class="keywordflow">if</span> ((done = <a class="code hl_function" href="classclientReplyContext.html#a9008dda5fcc8b05839bdfd845be21d0f">checkTransferDone</a>()) != 0 || <a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#a9fd53bdc9adcf5af7aab7d5c4312ccd0">complete</a>) {</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;clientReplyStatus: transfer is DONE: &quot;</span> &lt;&lt; done &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#a9fd53bdc9adcf5af7aab7d5c4312ccd0">complete</a>);</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>        <span class="comment">/* Ok we&#39;re finished, but how? */</span></div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span> </div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462a04a808e82e4e3539c65424c7388dd257">ENTRY_BAD_LENGTH</a>)) {</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;clientReplyStatus: truncated response body&quot;</span>);</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876ba94d16363b82ec2278002d78080a8cb44">STREAM_UNPLANNED_COMPLETE</a>;</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>        }</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span> </div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>        <span class="keywordflow">if</span> (!done) {</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;clientReplyStatus: closing, !done, but read 0 bytes&quot;</span>);</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876bae425b0891f7f866775009972cae49d71">STREAM_FAILED</a>;</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>        }</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span> </div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>        <span class="comment">// TODO: See also (and unify with) storeNotOKTransferDone() checks.</span></div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>        <span class="keyword">const</span> int64_t expectedBodySize =</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a19fd5af89e99c467c29f7bd951ac901d">mem</a>().<a class="code hl_function" href="classMemObject.html#ad5355b4679045222e5ea75b0c36f16c4">baseReply</a>().<a class="code hl_function" href="classHttpReply.html#a74ed30d9587d67debbc07741d36609a5">bodySize</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>);</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>        <span class="keywordflow">if</span> (expectedBodySize &gt;= 0 &amp;&amp; !<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a3e8660eb3f78ddb12f5f36f716755109">gotEnough</a>()) {</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;clientReplyStatus: client didn&#39;t get all it expected&quot;</span>);</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876ba94d16363b82ec2278002d78080a8cb44">STREAM_UNPLANNED_COMPLETE</a>;</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>        }</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span> </div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;clientReplyStatus: stream complete; keepalive=&quot;</span> &lt;&lt;</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>               <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a>);</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876ba47cb242ab59c602b4398248aea577b19">STREAM_COMPLETE</a>;</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>    }</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span> </div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>    <span class="comment">// XXX: Should this be checked earlier? We could return above w/o checking.</span></div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_function" href="classHttpReply.html#a7db386a07e80943a2125267fd485169e">receivedBodyTooLarge</a>(*<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a>)) {</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;clientReplyStatus: client reply body is too large&quot;</span>);</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876bae425b0891f7f866775009972cae49d71">STREAM_FAILED</a>;</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>    }</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span> </div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876baafdb40c0b7683e2fd31711c386833017">STREAM_NONE</a>;</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>}</div>
</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span> </div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span><span class="comment">/* Responses with no body will not have a content-type header,</span></div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span><span class="comment"> * which breaks the rep_mime_type acl, which</span></div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span><span class="comment"> * coincidentally, is the most common acl for reply access lists.</span></div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span><span class="comment"> * A better long term fix for this is to allow acl matches on the various</span></div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span><span class="comment"> * status codes, and then supply a default ruleset that puts these</span></div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span><span class="comment"> * codes before any user defines access entries. That way the user</span></div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span><span class="comment"> * can choose to block these responses where appropriate, but won&#39;t get</span></div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span><span class="comment"> * mysterious breakages.</span></div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span><span class="comment"> */</span></div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen01188" data-start="{" data-end="}">
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a1f6deea197aeb4c93d27457f592811cd"> 1188</a></span><a class="code hl_function" href="classclientReplyContext.html#a1f6deea197aeb4c93d27457f592811cd">clientReplyContext::alwaysAllowResponse</a>(<a class="code hl_enumeration" href="namespaceHttp.html#a432f881deb187c726161d6435daec722">Http::StatusCode</a> sline)<span class="keyword"> const</span></div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>    <span class="keywordtype">bool</span> result;</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span> </div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>    <span class="keywordflow">switch</span> (sline) {</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span> </div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722ab4c64c106757b282a785dd2d71686616">Http::scContinue</a>:</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span> </div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722ac75e2250505c30c0d45be7f9b606c9c7">Http::scSwitchingProtocols</a>:</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span> </div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a0d4efa9ae540290c151f4034069cabc5">Http::scProcessing</a>:</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span> </div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722ab95a10cc149f601422b96a56b2acf1f7">Http::scNoContent</a>:</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span> </div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722aac99376ecec42f14e89b637dc6286ccf">Http::scNotModified</a>:</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>        result = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span> </div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>        result = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>    }</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span> </div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>}</div>
</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span> </div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01221" data-start="{" data-end="}">
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a58f125fb5351a6e1dd3eade425bed651"> 1221</a></span><a class="code hl_function" href="classclientReplyContext.html#a58f125fb5351a6e1dd3eade425bed651">clientReplyContext::buildReplyHeader</a>()</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>{</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>    <a class="code hl_class" href="classHttpHeader.html">HttpHeader</a> *hdr = &amp;<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>;</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_hit = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>().<a class="code hl_function" href="classLogTags.html#aea1194c638b43a3273a8280cee485215">isTcpHit</a>();</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>    <span class="keywordflow">if</span> (is_hit || <a class="code hl_variable" href="classclientReplyContext.html#aa68c26ab76934275c66ba1fd3414cc2e">collapsedRevalidation</a> == <a class="code hl_enumvalue" href="classclientReplyContext.html#a4895ddefadfe91421fd6a2834dee8439ace62de5377e0c03b32c400d1325d24fa">crSlave</a>)</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>        hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">delById</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a3c46461540238458a31d1afccf608cd7">Http::HdrType::SET_COOKIE</a>);</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>    <span class="comment">// TODO: RFC 2965 : Must honour Cache-Control: no-cache=&quot;set-cookie2&quot; and remove header.</span></div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span> </div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>    <span class="comment">// if there is not configured a peer proxy with login=PASS or login=PASSTHRU option enabled</span></div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>    <span class="comment">// remove the Proxy-Authenticate header</span></div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>    <span class="keywordflow">if</span> ( !request-&gt;<a class="code hl_variable" href="classHttpRequest.html#aa9ddcc721a56c9e60b16639d4fdec94d">peer_login</a> || (strcmp(request-&gt;<a class="code hl_variable" href="classHttpRequest.html#aa9ddcc721a56c9e60b16639d4fdec94d">peer_login</a>,<span class="stringliteral">&quot;PASS&quot;</span>) != 0 &amp;&amp; strcmp(request-&gt;<a class="code hl_variable" href="classHttpRequest.html#aa9ddcc721a56c9e60b16639d4fdec94d">peer_login</a>,<span class="stringliteral">&quot;PASSTHRU&quot;</span>) != 0)) {</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span><span class="preprocessor">#if USE_ADAPTATION</span></div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>        <span class="comment">// but allow adaptation services to authenticate clients</span></div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>        <span class="comment">// via request satisfaction</span></div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab7002a77dc4201885bc9c3e38aa3f26e">requestSatisfactionMode</a>())</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>            <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">delById</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4af2cf7825f44d529c50c82e9690634507">Http::HdrType::PROXY_AUTHENTICATE</a>);</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>    }</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span> </div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>    <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#a0ca2bdbdb30c64bdbeed4b355f37fc26">removeHopByHopEntries</a>();</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>    <span class="comment">// paranoid: ContentLengthInterpreter has cleaned non-generated replies</span></div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>    <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_function" href="classHttpReply.html#a7d329af2d672e50fd1bea5e727dffa53">removeIrrelevantContentLength</a>();</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span> </div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>    <span class="comment">//    if (request-&gt;range)</span></div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>    <span class="comment">//      clientBuildRangeHeader(http, reply);</span></div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span> </div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span><span class="comment">     * Add a estimated Age header on cache hits.</span></div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span><span class="comment">     */</span></div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>    <span class="keywordflow">if</span> (is_hit) {</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span><span class="comment">         * Remove any existing Age header sent by upstream caches</span></div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span><span class="comment">         * (note that the existing header is passed along unmodified</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span><span class="comment">         * on cache misses)</span></div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span><span class="comment">         */</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>        hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">delById</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a2a3cf223743e814f1545c1b319f11806">Http::HdrType::AGE</a>);</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span><span class="comment">         * This adds the calculated object age. Note that the details of the</span></div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span><span class="comment">         * age calculation is performed by adjusting the timestamp in</span></div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span><span class="comment">         * StoreEntry::timestampsSet(), not here.</span></div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span><span class="comment">         */</span></div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462a6c0b60acdcf1cefdb5f3a847b5f90224">ENTRY_SPECIAL</a>)) {</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>            hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">delById</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a0a200af415630c8982f1df9ecd312de8">Http::HdrType::DATE</a>);</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>            hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#ae04ecbfb773915c46d328d2d79ee7237">putTime</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a0a200af415630c8982f1df9ecd312de8">Http::HdrType::DATE</a>, <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a>);</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>() &amp;&amp; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classConnStateData.html#ae06c387dd773449597078259a953013b">port</a>-&gt;actAsOrigin) {</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>            <span class="comment">// Swap the Date: header to current time if we are simulating an origin</span></div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>            <a class="code hl_class" href="classHttpHeaderEntry.html">HttpHeaderEntry</a> *h = hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#acfab592ae0ede9d3934c233aacffbeeb">findEntry</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a0a200af415630c8982f1df9ecd312de8">Http::HdrType::DATE</a>);</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>            <span class="keywordflow">if</span> (h)</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>                hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#ad7bd04f01a83d7df9f84637583ba8632">putExt</a>(<span class="stringliteral">&quot;X-Origin-Date&quot;</span>, h-&gt;<a class="code hl_variable" href="classHttpHeaderEntry.html#af1721f40aef39eef4476a19f806aedaa">value</a>.<a class="code hl_function" href="classString.html#aba5551ee62c6e82730c0cb1856238c14">termedBuf</a>());</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>            hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">delById</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a0a200af415630c8982f1df9ecd312de8">Http::HdrType::DATE</a>);</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>            hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#ae04ecbfb773915c46d328d2d79ee7237">putTime</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a0a200af415630c8982f1df9ecd312de8">Http::HdrType::DATE</a>, <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a>);</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>            h = hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#acfab592ae0ede9d3934c233aacffbeeb">findEntry</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a5d240fa0f5eb4e05bf6e9d705cc1c317">Http::HdrType::EXPIRES</a>);</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>            <span class="keywordflow">if</span> (h &amp;&amp; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a42dc938e1e2a49b3d4275eabeb8eb699">expires</a> &gt;= 0) {</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>                hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#ad7bd04f01a83d7df9f84637583ba8632">putExt</a>(<span class="stringliteral">&quot;X-Origin-Expires&quot;</span>, h-&gt;<a class="code hl_variable" href="classHttpHeaderEntry.html#af1721f40aef39eef4476a19f806aedaa">value</a>.<a class="code hl_function" href="classString.html#aba5551ee62c6e82730c0cb1856238c14">termedBuf</a>());</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>                hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">delById</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a5d240fa0f5eb4e05bf6e9d705cc1c317">Http::HdrType::EXPIRES</a>);</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>                hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#ae04ecbfb773915c46d328d2d79ee7237">putTime</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a5d240fa0f5eb4e05bf6e9d705cc1c317">Http::HdrType::EXPIRES</a>, <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a> + <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a42dc938e1e2a49b3d4275eabeb8eb699">expires</a> - <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a5880b874fdaa8aa76b21a5fedd609ca0">timestamp</a>);</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>            }</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a5880b874fdaa8aa76b21a5fedd609ca0">timestamp</a> &lt;= <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a>) {</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>                <span class="comment">// put X-Cache-Age: instead of Age:</span></div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>                <span class="keywordtype">char</span> age[64];</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>                snprintf(age, <span class="keyword">sizeof</span>(age), <span class="stringliteral">&quot;%&quot;</span> <a class="code hl_define" href="types_8h.html#ae372e90b62c1e8b51dc5d95bf7f5ba48">PRId64</a>, <span class="keyword">static_cast&lt;</span>int64_t<span class="keyword">&gt;</span>(<a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a> - <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a5880b874fdaa8aa76b21a5fedd609ca0">timestamp</a>));</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>                hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#ad7bd04f01a83d7df9f84637583ba8632">putExt</a>(<span class="stringliteral">&quot;X-Cache-Age&quot;</span>, age);</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>            }</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a5880b874fdaa8aa76b21a5fedd609ca0">timestamp</a> &lt;= <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a>) {</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>            hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a4936a0d9f8086a70e0ffc6d7de87f604">putInt</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a2a3cf223743e814f1545c1b319f11806">Http::HdrType::AGE</a>,</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>                        <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a> - <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a5880b874fdaa8aa76b21a5fedd609ca0">timestamp</a>);</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>        }</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>    }</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span> </div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>    <span class="comment">/* RFC 2616: Section 14.18</span></div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span><span class="comment">     *</span></div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span><span class="comment">     * Add a Date: header if missing.</span></div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span><span class="comment">     * We have access to a clock therefore are required to amend any shortcoming in servers.</span></div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span><span class="comment">     *</span></div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span><span class="comment">     * NP: done after Age: to prevent ENTRY_SPECIAL double-handling this header.</span></div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span><span class="comment">     */</span></div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>    <span class="keywordflow">if</span> ( !hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a0a200af415630c8982f1df9ecd312de8">Http::HdrType::DATE</a>) ) {</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>())</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>            hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#ae04ecbfb773915c46d328d2d79ee7237">putTime</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a0a200af415630c8982f1df9ecd312de8">Http::HdrType::DATE</a>, <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a>);</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a5880b874fdaa8aa76b21a5fedd609ca0">timestamp</a> &gt; 0)</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>            hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#ae04ecbfb773915c46d328d2d79ee7237">putTime</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a0a200af415630c8982f1df9ecd312de8">Http::HdrType::DATE</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a5880b874fdaa8aa76b21a5fedd609ca0">timestamp</a>);</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;ERROR: Squid BUG #3279: HTTP reply without Date:&quot;</span>);</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>            <span class="comment">/* dump something useful about the problem */</span></div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a2d3a77bc0c8dad6b7b9084aaf6998251">dump</a>(<a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>);</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>        }</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>    }</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span> </div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>    <span class="comment">/* Filter unproxyable authentication types */</span></div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>().<a class="code hl_variable" href="classLogTags.html#abed628637be6b214d7860ed402927259">oldType</a> != <a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a16a4df28091bca4eda98565febc8fe36">LOG_TCP_DENIED</a> &amp;&amp;</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>            hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a986213101dcdd9ffc371bbfd07606641">Http::HdrType::WWW_AUTHENTICATE</a>)) {</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>        <a class="code hl_typedef" href="HttpHeader_8h.html#aac9fc01c2b9cda8c02b1f7f8a2a9c78b">HttpHeaderPos</a> pos = <a class="code hl_define" href="HttpHeader_8h.html#abf5d862281ddf9a5315fcfa5be166c07">HttpHeaderInitPos</a>;</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>        <a class="code hl_class" href="classHttpHeaderEntry.html">HttpHeaderEntry</a> *e;</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span> </div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>        <span class="keywordtype">int</span> connection_auth_blocked = 0;</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>        <span class="keywordflow">while</span> ((e = hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a81cb2fc85a9629783ba1e607de0f41ed">getEntry</a>(&amp;pos))) {</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>            <span class="keywordflow">if</span> (e-&gt;<a class="code hl_variable" href="classHttpHeaderEntry.html#ad4de5645a10ac4022a3667753b7904a8">id</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a986213101dcdd9ffc371bbfd07606641">Http::HdrType::WWW_AUTHENTICATE</a>) {</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>                <span class="keyword">const</span> <span class="keywordtype">char</span> *value = e-&gt;<a class="code hl_variable" href="classHttpHeaderEntry.html#af1721f40aef39eef4476a19f806aedaa">value</a>.<a class="code hl_function" href="classString.html#a77a7c8c6845f33722735772524b8034d">rawBuf</a>();</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span> </div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>                <span class="keywordflow">if</span> ((strncasecmp(value, <span class="stringliteral">&quot;NTLM&quot;</span>, 4) == 0 &amp;&amp;</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>                        (value[4] == <span class="charliteral">&#39;\0&#39;</span> || value[4] == <span class="charliteral">&#39; &#39;</span>))</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>                        ||</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>                        (strncasecmp(value, <span class="stringliteral">&quot;Negotiate&quot;</span>, 9) == 0 &amp;&amp;</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>                         (value[9] == <span class="charliteral">&#39;\0&#39;</span> || value[9] == <span class="charliteral">&#39; &#39;</span>))</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>                        ||</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>                        (strncasecmp(value, <span class="stringliteral">&quot;Kerberos&quot;</span>, 8) == 0 &amp;&amp;</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>                         (value[8] == <span class="charliteral">&#39;\0&#39;</span> || value[8] == <span class="charliteral">&#39; &#39;</span>))) {</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>                    <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#ad71e99859e4130efc5ef12af8aaefe98">connectionAuthDisabled</a>) {</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>                        hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a3d53e322173b75fa99bdd4357fd97307">delAt</a>(pos, connection_auth_blocked);</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>                    }</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>                    request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a68b0261603b2ce9f9151a053562527f4">mustKeepalive</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>                    <span class="keywordflow">if</span> (!request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a0e7db730c27abb7eac3b676961773797">accelerated</a> &amp;&amp; !request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a7feb14e42e2a35fb38fb744e98b8af7b">intercepted</a>) {</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>                        <a class="code hl_function" href="HttpHeaderTools_8cc.html#a66e35b739c80b623af93c27827d600e5">httpHeaderPutStrf</a>(hdr, <a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a35faacab7f7518d7c22be4f1fc1cb4e7">Http::HdrType::PROXY_SUPPORT</a>, <span class="stringliteral">&quot;Session-Based-Authentication&quot;</span>);</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>                        <span class="comment">/*</span></div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span><span class="comment">                          We send &quot;Connection: Proxy-Support&quot; header to mark</span></div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span><span class="comment">                          Proxy-Support as a hop-by-hop header for intermediaries that do not</span></div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span><span class="comment">                          understand the semantics of this header. The RFC should have included</span></div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span><span class="comment">                          this recommendation.</span></div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span><span class="comment">                        */</span></div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>                        <a class="code hl_function" href="HttpHeaderTools_8cc.html#a66e35b739c80b623af93c27827d600e5">httpHeaderPutStrf</a>(hdr, <a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a21db8a0f647c77f4dd700baeed4be945">Http::HdrType::CONNECTION</a>, <span class="stringliteral">&quot;Proxy-support&quot;</span>);</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>                    }</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>                }</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>            }</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>        }</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span> </div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>        <span class="keywordflow">if</span> (connection_auth_blocked)</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>            hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a6a5a2911b3e812c91b5eab549fcf2f09">refreshMask</a>();</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>    }</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span> </div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span><span class="preprocessor">#if USE_AUTH</span></div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>    <span class="comment">/* Handle authentication headers */</span></div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>().<a class="code hl_variable" href="classLogTags.html#abed628637be6b214d7860ed402927259">oldType</a> == <a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a16a4df28091bca4eda98565febc8fe36">LOG_TCP_DENIED</a> &amp;&amp;</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>            ( <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_function" href="classHttp_1_1StatusLine.html#af852e58bb3e96bc41cd16787b0a7d7db">status</a>() == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722aa140c4f7dc1624466a96d42cc209f155">Http::scProxyAuthenticationRequired</a> ||</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>              <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_function" href="classHttp_1_1StatusLine.html#af852e58bb3e96bc41cd16787b0a7d7db">status</a>() == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a3868c9f40f16676c17393a2e5565a83a">Http::scUnauthorized</a>)</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>       ) {</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>        <span class="comment">/* Add authentication header */</span></div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>        <span class="comment">/* TODO: alter errorstate to be accel on|off aware. The 0 on the next line</span></div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span><span class="comment">         * depends on authenticate behaviour: all schemes to date send no extra</span></div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span><span class="comment">         * data on 407/401 responses, and do not check the accel state on 401/407</span></div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span><span class="comment">         * responses</span></div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span><span class="comment">         */</span></div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>        <a class="code hl_function" href="classAuth_1_1UserRequest.html#a1ba1b6d925ff4df965c7c7365cf1973b">Auth::UserRequest::AddReplyAuthHeader</a>(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>, request-&gt;<a class="code hl_variable" href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">auth_user_request</a>, request, 0, 1);</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">auth_user_request</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>        <a class="code hl_function" href="classAuth_1_1UserRequest.html#a1ba1b6d925ff4df965c7c7365cf1973b">Auth::UserRequest::AddReplyAuthHeader</a>(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>, request-&gt;<a class="code hl_variable" href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">auth_user_request</a>, request, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#aaa05fd2e87baa36553d2039aa92901a3">flags</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Flags.html#a409fd4d5e3b72f06df2921bd417e0a5c">accel</a>, 0);</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span> </div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>    <a class="code hl_class" href="classSBuf.html">SBuf</a> cacheStatus(<a class="code hl_function" href="tools_8cc.html#adbe2913b25bf470a7814f9ec4a0907d9">uniqueHostname</a>());</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> hitOrFwd = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>().<a class="code hl_function" href="classLogTags.html#a2363f5b3f984b76de77f6d8bf5ffbaf9">cacheStatusSource</a>())</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>        cacheStatus.<a class="code hl_function" href="classSBuf.html#aa12ede16b167c60722946fc8fe9292da">append</a>(hitOrFwd);</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#a9b6292369a5480b33c033bfcc7f86835">firstStoreLookup_</a>) {</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>        cacheStatus.<a class="code hl_function" href="classSBuf.html#aa12ede16b167c60722946fc8fe9292da">append</a>(<span class="stringliteral">&quot;;detail=&quot;</span>);</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>        cacheStatus.<a class="code hl_function" href="classSBuf.html#aa12ede16b167c60722946fc8fe9292da">append</a>(<a class="code hl_variable" href="classclientReplyContext.html#a9b6292369a5480b33c033bfcc7f86835">firstStoreLookup_</a>);</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>    }</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>    <span class="comment">// TODO: Remove c_str() after converting HttpHeaderEntry::value to SBuf</span></div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>    hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a187949b24278b65f28338947c605b130">putStr</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4aee424720c1d99ecd044f2fd9f325d5a8">Http::HdrType::CACHE_STATUS</a>, cacheStatus.<a class="code hl_function" href="classSBuf.html#a2a7fda503e54cb36b023dcaaab633f65">c_str</a>());</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span> </div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> maySendChunkedReply = !request-&gt;<a class="code hl_function" href="classHttpRequest.html#a52c61e6b8c61c28ff10381895aa114a9">multipartRangeRequest</a>() &amp;&amp;</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>                                     <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_variable" href="classHttp_1_1StatusLine.html#a96ad58b7ae7051e95f4cc75a00942efe">version</a>.<a class="code hl_variable" href="classAnyP_1_1ProtocolVersion.html#a9b781ce0242bffdbc1694f09ceefffa5">protocol</a> == <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca62d94ce7433f7892fb4541f72ac4ac7d">AnyP::PROTO_HTTP</a> &amp;&amp; <span class="comment">// response is HTTP</span></div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>                                     (request-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#afcb0c1d278e61a1379032790c427788d">http_ver</a> &gt;= <a class="code hl_function" href="namespaceHttp.html#a8f5de7a6ddd395e9aaf0dffd043c2276">Http::ProtocolVersion</a>(1,1));</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span> </div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>    <span class="comment">/* Check whether we should send keep-alive */</span></div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#a2988594ba4cfaec3d374bdb724f73999">error_pconns</a> &amp;&amp; <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_function" href="classHttp_1_1StatusLine.html#af852e58bb3e96bc41cd16787b0a7d7db">status</a>() &gt;= 400 &amp;&amp; !request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a68b0261603b2ce9f9151a053562527f4">mustKeepalive</a>) {</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, 3, <span class="stringliteral">&quot;clientBuildReplyHeader: Error, don&#39;t keep-alive&quot;</span>);</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#a9bf3ec2cc0f359bb6a92422b46e89eae">client_pconns</a> &amp;&amp; !request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a68b0261603b2ce9f9151a053562527f4">mustKeepalive</a>) {</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, 2, <span class="stringliteral">&quot;clientBuildReplyHeader: Connection Keep-Alive not requested by admin or client&quot;</span>);</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> &amp;&amp; <a class="code hl_variable" href="globals_8h.html#a7f68568851b9c7f9291f7bb63f932c18">shutting_down</a>) {</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;clientBuildReplyHeader: Shutting down, don&#39;t keep-alive.&quot;</span>);</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a1cb8c962b36f5ebd3f897fede719dd43">connectionAuth</a> &amp;&amp; !<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttpReply.html#aeb67dd2ad47812549069ccb159b29fe8">keep_alive</a>) {</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, 2, <span class="stringliteral">&quot;clientBuildReplyHeader: Connection oriented auth but server side non-persistent&quot;</span>);</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_function" href="classHttpReply.html#a74ed30d9587d67debbc07741d36609a5">bodySize</a>(request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>) &lt; 0 &amp;&amp; !maySendChunkedReply) {</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;clientBuildReplyHeader: can&#39;t keep-alive, unknown body size&quot;</span> );</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="fd_8cc.html#ac8fc7d6a8690be1f0ebc3a29f4c88ec0">fdUsageHigh</a>()&amp;&amp; !request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a68b0261603b2ce9f9151a053562527f4">mustKeepalive</a>) {</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;clientBuildReplyHeader: Not many unused FDs, can&#39;t keep-alive&quot;</span>);</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#abbde600374891ccc540eea4812414b69">sslBumped</a> &amp;&amp; !<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_function" href="classHttp_1_1Message.html#a321ae82a5f96da7438f3054d38c8fe5c">persistent</a>()) {</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>        <span class="comment">// We do not really have to close, but we pretend we are a tunnel.</span></div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;clientBuildReplyHeader: bumped reply forces close&quot;</span>);</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (request-&gt;<a class="code hl_function" href="classHttpRequest.html#a98624db05b1d0e020b1178042857038b">pinnedConnection</a>() &amp;&amp; !<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_function" href="classHttp_1_1Message.html#a321ae82a5f96da7438f3054d38c8fe5c">persistent</a>()) {</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>        <span class="comment">// The peer wants to close the pinned connection</span></div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;pinned reply forces close&quot;</span>);</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()) {</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>        <a class="code hl_class" href="classConnStateData.html">ConnStateData</a> * conn = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>();</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a>(conn-&gt;<a class="code hl_variable" href="classConnStateData.html#ae06c387dd773449597078259a953013b">port</a>-&gt;listenConn)) {</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>            <span class="comment">// The listening port closed because of a reconfigure</span></div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;listening port closed&quot;</span>);</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>        }</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>    }</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span> </div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>    <span class="comment">// Decide if we send chunked reply</span></div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>    <span class="keywordflow">if</span> (maySendChunkedReply &amp;&amp; <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_function" href="classHttpReply.html#a74ed30d9587d67debbc07741d36609a5">bodySize</a>(request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>) &lt; 0) {</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;clientBuildReplyHeader: chunked reply&quot;</span>);</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a1e3c53bb0466b666037f1db1fc3dd00b">chunkedReply</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>        hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a187949b24278b65f28338947c605b130">putStr</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4abf644a4ab3a498ed2854c3022837e8f9">Http::HdrType::TRANSFER_ENCODING</a>, <span class="stringliteral">&quot;chunked&quot;</span>);</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>    }</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span> </div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>    hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#abd93657e973fda6b90aa8ff0b12967f1">addVia</a>(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_variable" href="classHttp_1_1StatusLine.html#a96ad58b7ae7051e95f4cc75a00942efe">version</a>);</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span> </div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>    <span class="comment">/* Signal keep-alive or close explicitly */</span></div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>    hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a187949b24278b65f28338947c605b130">putStr</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a21db8a0f647c77f4dd700baeed4be945">Http::HdrType::CONNECTION</a>, request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">proxyKeepalive</a> ? <span class="stringliteral">&quot;keep-alive&quot;</span> : <span class="stringliteral">&quot;close&quot;</span>);</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span> </div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>    <span class="comment">/* Surrogate-Control requires Surrogate-Capability from upstream to pass on */</span></div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>    <span class="keywordflow">if</span> ( hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a4c6cb289c5426015a4cd73401b690ee0">Http::HdrType::SURROGATE_CONTROL</a>) ) {</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>        <span class="keywordflow">if</span> (!request-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4ac6654c832ce51820706e243733a197c6">Http::HdrType::SURROGATE_CAPABILITY</a>)) {</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>            hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">delById</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a4c6cb289c5426015a4cd73401b690ee0">Http::HdrType::SURROGATE_CONTROL</a>);</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>        }</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>        <span class="comment">/* TODO: else case: drop any controls intended specifically for our surrogate ID */</span></div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>    }</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span> </div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>    <a class="code hl_function" href="HeaderMangling_8cc.html#a8ec4a597e9cad23e1ffd9390c1c58e7d">httpHdrMangleList</a>(hdr, request, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>, <a class="code hl_enumvalue" href="HeaderMangling_8h.html#a292ed346109090f6c9c8c27d7447f2d8aae9afd116433e45bb99f6f5151b986b5">ROR_REPLY</a>);</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>}</div>
</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span> </div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01445" data-start="{" data-end="}">
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ad7df8874888e0b2da857407f16a8cb30"> 1445</a></span><a class="code hl_function" href="classclientReplyContext.html#ad7df8874888e0b2da857407f16a8cb30">clientReplyContext::cloneReply</a>()</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>{</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a> == <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span> </div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>    <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a> = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a19fd5af89e99c467c29f7bd951ac901d">mem</a>().<a class="code hl_function" href="classMemObject.html#a89697947bc40cdbe591b9e26951b59ba">freshestReply</a>().<a class="code hl_function" href="classHttpReply.html#ae359a6d402671b8cd203ea35268e2de8">clone</a>();</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>    <a class="code hl_function" href="http_2Message_8h.html#afbf13ecd1cc5c007367ae094c1aa19a9">HTTPMSGLOCK</a>(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>);</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span> </div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a19bddcabb9a3d2f290c183a171afa4b3">reply</a> = <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>;</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span> </div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_variable" href="classHttp_1_1StatusLine.html#a96ad58b7ae7051e95f4cc75a00942efe">version</a>.<a class="code hl_variable" href="classAnyP_1_1ProtocolVersion.html#a9b781ce0242bffdbc1694f09ceefffa5">protocol</a> == <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca62d94ce7433f7892fb4541f72ac4ac7d">AnyP::PROTO_HTTP</a>) {</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>        <span class="comment">/* RFC 2616 requires us to advertise our version (but only on real HTTP traffic) */</span></div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>        <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_variable" href="classHttp_1_1StatusLine.html#a96ad58b7ae7051e95f4cc75a00942efe">version</a> = <a class="code hl_function" href="namespaceHttp.html#a8f5de7a6ddd395e9aaf0dffd043c2276">Http::ProtocolVersion</a>();</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>    }</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span> </div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>    <span class="comment">/* do header conversions */</span></div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>    <a class="code hl_function" href="classclientReplyContext.html#a58f125fb5351a6e1dd3eade425bed651">buildReplyHeader</a>();</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>}</div>
</div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span> </div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01467" data-start="{" data-end="}">
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a3263269246247f958667a1596f3fa50c"> 1467</a></span><a class="code hl_function" href="classclientReplyContext.html#a3263269246247f958667a1596f3fa50c">clientReplyContext::forgetHit</a>()</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>{</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *e = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>();</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(e); <span class="comment">// or we are not dealing with a hit</span></div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>    <span class="comment">// We probably have not locked the entry earlier, unfortunately. We lock it</span></div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>    <span class="comment">// now so that we can unlock two lines later (and trigger cleanup).</span></div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>    <span class="comment">// Ideally, ClientHttpRequest::storeEntry() should lock/unlock, but it is</span></div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>    <span class="comment">// used so inconsistently that simply adding locking there leads to bugs.</span></div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>    e-&gt;<a class="code hl_function" href="classStoreEntry.html#a53a607cfbdb22fde40edd2c72bfb6dd3">lock</a>(<span class="stringliteral">&quot;clientReplyContext::forgetHit&quot;</span>);</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>    e-&gt;<a class="code hl_function" href="classStoreEntry.html#a35618603cff249c1cc64abf8127f3b7d">unlock</a>(<span class="stringliteral">&quot;clientReplyContext::forgetHit&quot;</span>); <span class="comment">// may delete e</span></div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>}</div>
</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span> </div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01481" data-start="{" data-end="}">
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#aeee916c2def6e7a7352c7dde69e1fdbd"> 1481</a></span><a class="code hl_function" href="classclientReplyContext.html#aeee916c2def6e7a7352c7dde69e1fdbd">clientReplyContext::identifyStoreObject</a>()</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>{</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *r = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span> </div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>    <span class="comment">// client sent CC:no-cache or some other condition has been</span></div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>    <span class="comment">// encountered which prevents delivering a public/cached object.</span></div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>    <span class="comment">// XXX: The above text does not match the condition below. It might describe</span></div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>    <span class="comment">// the opposite condition, but the condition itself should be adjusted</span></div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>    <span class="comment">// (e.g., to honor flags.noCache in cache manager requests).</span></div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>    <span class="keywordflow">if</span> (!r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a452db2a617d946222557c73d97888918">noCache</a> || r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a26c4900e600bc57c506766fcbdf3c0e3">internal</a>) {</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>        <span class="keyword">const</span> <span class="keyword">auto</span> e = <a class="code hl_function" href="store_8cc.html#a70101e23661f7fe20ce50890c448e92c">storeGetPublicByRequest</a>(r);</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>        <a class="code hl_function" href="classclientReplyContext.html#a4e96f2b1ec86bd2e1a60ac36ccded9a9">identifyFoundObject</a>(e, <a class="code hl_function" href="classclientReplyContext.html#aabf64bc2c4116b2cd2181ad8bc060353">storeLookupString</a>(<span class="keywordtype">bool</span>(e)));</div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>        <span class="comment">// &quot;external&quot; no-cache requests skip Store lookups</span></div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>        <a class="code hl_function" href="classclientReplyContext.html#a4e96f2b1ec86bd2e1a60ac36ccded9a9">identifyFoundObject</a>(<span class="keyword">nullptr</span>, <span class="stringliteral">&quot;no-cache&quot;</span>);</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>    }</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>}</div>
</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span> </div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01504" data-start="{" data-end="}">
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a4e96f2b1ec86bd2e1a60ac36ccded9a9"> 1504</a></span><a class="code hl_function" href="classclientReplyContext.html#a4e96f2b1ec86bd2e1a60ac36ccded9a9">clientReplyContext::identifyFoundObject</a>(<a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *newEntry, <span class="keyword">const</span> <span class="keywordtype">char</span> *detail)</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>{</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>    <a class="code hl_function" href="classclientReplyContext.html#afe190509d5386d07c17a26759742bb3c">detailStoreLookup</a>(detail);</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span> </div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *r = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(newEntry);</div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>    <span class="keyword">const</span> <span class="keyword">auto</span> e = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>();</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span> </div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>    <span class="comment">/* Release IP-cache entries on reload */</span></div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>    <span class="keywordflow">if</span> (r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a452db2a617d946222557c73d97888918">noCache</a> || r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_function" href="classRequestFlags.html#a3785f87b7c9fa79980250415c0ba7b5a">noCacheHack</a>())</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>        <a class="code hl_function" href="group__IPCacheAPI.html#ga01f4fb0a4852b5f21c596b57b75538a4">ipcacheInvalidateNegative</a>(r-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">host</a>());</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span> </div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>    <span class="keywordflow">if</span> (!e) {</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;StoreEntry is NULL -  MISS&quot;</span>);</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>        <a class="code hl_function" href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4">doGetMoreData</a>();</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>    }</div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span> </div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#a94f4d58b36060eb76c6d6ca9eda4c755">offline</a>) {</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;offline HIT &quot;</span> &lt;&lt; *e);</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a6b18a17e02ffba088ef54d6c6570a2da">LOG_TCP_HIT</a>);</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>        <a class="code hl_function" href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4">doGetMoreData</a>();</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>    }</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span> </div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#afc0f851aa12908396cb5457c085a4e6f">redirect</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Redirect.html#a51a61e18a57f2018c331c346b4a75816">status</a>) {</div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;REDIRECT status forced StoreEntry to NULL (no body on 3XX responses) &quot;</span> &lt;&lt; *e);</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>        <a class="code hl_function" href="classclientReplyContext.html#a3263269246247f958667a1596f3fa50c">forgetHit</a>();</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a4228cbccd4cbcf5bb01cd29c88e9b313">LOG_TCP_REDIRECT</a>);</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>        <a class="code hl_function" href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4">doGetMoreData</a>();</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span>    }</div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span> </div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>    <span class="keywordflow">if</span> (!e-&gt;validToSend()) {</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;!storeEntryValidToSend MISS &quot;</span> &lt;&lt; *e);</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>        <a class="code hl_function" href="classclientReplyContext.html#a3263269246247f958667a1596f3fa50c">forgetHit</a>();</div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>        <a class="code hl_function" href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4">doGetMoreData</a>();</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>    }</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span> </div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(e-&gt;flags, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462a6c0b60acdcf1cefdb5f3a847b5f90224">ENTRY_SPECIAL</a>)) {</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>        <span class="comment">/* \li Special entries are always hits, no matter what the client says */</span></div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;ENTRY_SPECIAL HIT &quot;</span> &lt;&lt; *e);</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a6b18a17e02ffba088ef54d6c6570a2da">LOG_TCP_HIT</a>);</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>        <a class="code hl_function" href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4">doGetMoreData</a>();</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>    }</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span> </div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>    <span class="keywordflow">if</span> (r-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a452db2a617d946222557c73d97888918">noCache</a>) {</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;no-cache REFRESH MISS &quot;</span> &lt;&lt; *e);</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>        <a class="code hl_function" href="classclientReplyContext.html#a3263269246247f958667a1596f3fa50c">forgetHit</a>();</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5ae19fd4a06c3cb6bd8515559ffd304bfd">LOG_TCP_CLIENT_REFRESH_MISS</a>);</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>        <a class="code hl_function" href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4">doGetMoreData</a>();</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>    }</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span> </div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>    <span class="keywordflow">if</span> (e-&gt;hittingRequiresCollapsing() &amp;&amp; !<a class="code hl_function" href="classStoreClient.html#abb28f481b15a234bd176db48eba5bac9">startCollapsingOn</a>(*e, <span class="keyword">false</span>)) {</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;prohibited CF MISS &quot;</span> &lt;&lt; *e);</div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>        <a class="code hl_function" href="classclientReplyContext.html#a3263269246247f958667a1596f3fa50c">forgetHit</a>();</div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>        <a class="code hl_function" href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4">doGetMoreData</a>();</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>    }</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span> </div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;default HIT &quot;</span> &lt;&lt; *e);</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a6b18a17e02ffba088ef54d6c6570a2da">LOG_TCP_HIT</a>);</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>    <a class="code hl_function" href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4">doGetMoreData</a>();</div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>}</div>
</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span> </div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01583" data-start="{" data-end="}">
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#afe190509d5386d07c17a26759742bb3c"> 1583</a></span><a class="code hl_function" href="classclientReplyContext.html#afe190509d5386d07c17a26759742bb3c">clientReplyContext::detailStoreLookup</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *detail)</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>{</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classclientReplyContext.html#a9b6292369a5480b33c033bfcc7f86835">firstStoreLookup_</a>) {</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 7, detail);</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>        <a class="code hl_variable" href="classclientReplyContext.html#a9b6292369a5480b33c033bfcc7f86835">firstStoreLookup_</a> = detail;</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 7, <span class="stringliteral">&quot;ignores &quot;</span> &lt;&lt; detail &lt;&lt; <span class="stringliteral">&quot; after &quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#a9b6292369a5480b33c033bfcc7f86835">firstStoreLookup_</a>);</div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>    }</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>}</div>
</div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span> </div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01603" data-start="{" data-end="}">
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"><a class="line" href="client__side__reply_8cc.html#a27c0d884605cd340e474a0f3dd5a5952"> 1603</a></span><a class="code hl_variable" href="client__side__reply_8cc.html#ae73f7b10b6c2bd55c5f96c9d62839e8d">clientGetMoreData</a>(<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> * aNode, <a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> * http)</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>{</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>    <span class="comment">/* Test preconditions */</span></div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(aNode != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_function" href="cbdata_8cc.html#aa6ed5c53b844c6f8f3e7c39daa051835">cbdataReferenceValid</a>(aNode));</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(aNode-&gt;<a class="code hl_variable" href="classclientStreamNode.html#acd24e5a54ccd28b8c5ef2e9d4c0269e5">node</a>.<a class="code hl_variable" href="classdlink__node.html#a4660c70e36112cd329b84f7152a671fa">prev</a> == <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(aNode-&gt;<a class="code hl_variable" href="classclientStreamNode.html#acd24e5a54ccd28b8c5ef2e9d4c0269e5">node</a>.<a class="code hl_variable" href="classdlink__node.html#ad1228295f9f83f14e0c58966479cfbd7">next</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>    <a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *context = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *<span class="keyword">&gt;</span>(aNode-&gt;<a class="code hl_variable" href="classclientStreamNode.html#a3ffd025e7396d93b36a80c2048915ac8">data</a>.<a class="code hl_function" href="classRefCount.html#a9f2168c1df4a4ab6b7931425d85c37f0">getRaw</a>());</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a> (context);</div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(context-&gt;<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a> == http);</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span> </div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>    <span class="keywordflow">if</span> (!context-&gt;<a class="code hl_variable" href="classclientReplyContext.html#a0df8ee2233c180c19f80aabaf0bb8bd1">ourNode</a>)</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>        context-&gt;<a class="code hl_variable" href="classclientReplyContext.html#a0df8ee2233c180c19f80aabaf0bb8bd1">ourNode</a> = aNode;</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span> </div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>    <span class="comment">/* no cbdatareference, this is only used once, and safely */</span></div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>    <span class="keywordflow">if</span> (context-&gt;<a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#abee3bb6f7775ddc1b0ddb0b6525d110d">storelogiccomplete</a>) {</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>        context-&gt;<a class="code hl_function" href="classclientReplyContext.html#ab137b710baaf94196345dc44b26f9914">requestMoreBodyFromStore</a>();</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>    }</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span> </div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>    <span class="keywordflow">if</span> (context-&gt;<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ac284f1b2d0b0429b55542e9ca3be28d4">Http::METHOD_PURGE</a>) {</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>        context-&gt;<a class="code hl_function" href="classclientReplyContext.html#ae58ab9a507eec5431654c80222d4d6d2">purgeRequest</a>();</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>    }</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span> </div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>    <span class="comment">// OPTIONS with Max-Forwards:0 handled in clientProcessRequest()</span></div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span> </div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>    <span class="keywordflow">if</span> (context-&gt;<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a048d612501964b8d3f0d41ede55395f3">Http::METHOD_TRACE</a>) {</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>        <span class="keywordflow">if</span> (context-&gt;<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#abf9ae83ecee9c6ee5de511131993567b">getInt64</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a78311c3bedd99c69c01b5ada747f1de4">Http::HdrType::MAX_FORWARDS</a>) == 0) {</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>            context-&gt;<a class="code hl_function" href="classclientReplyContext.html#ac7c34d6a9882a32152c928d6f1ed8e57">traceReply</a>();</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>        }</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span> </div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>        <span class="comment">/* continue forwarding, not finished yet. */</span></div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>        http-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a>);</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span> </div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>        context-&gt;<a class="code hl_function" href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4">doGetMoreData</a>();</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>    } <span class="keywordflow">else</span></div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>        context-&gt;<a class="code hl_function" href="classclientReplyContext.html#aeee916c2def6e7a7352c7dde69e1fdbd">identifyStoreObject</a>();</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>}</div>
</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span> </div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01645" data-start="{" data-end="}">
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4"> 1645</a></span><a class="code hl_function" href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4">clientReplyContext::doGetMoreData</a>()</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>{</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>    <span class="comment">/* We still have to do store logic processing - vary, cache hit etc */</span></div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>() != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>        <span class="comment">/* someone found the object in the cache for us */</span></div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>        <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> localTempBuffer;</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span> </div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a53a607cfbdb22fde40edd2c72bfb6dd3">lock</a>(<span class="stringliteral">&quot;clientReplyContext::doGetMoreData&quot;</span>);</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span> </div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a249ad3e6bfa297da0fa7a0e9accf6002">ensureMemObject</a>(<a class="code hl_function" href="classclientReplyContext.html#ad42a3d89a4030a9571bd374eb1d67277">storeId</a>(), <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a3f6d0f7008f5302283e91937cdc67f75">log_uri</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>);</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span> </div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>        <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a> = <a class="code hl_function" href="store__client_8cc.html#ae077d286d865af03eb1357a8de9ba75b">storeClientListAdd</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(), <span class="keyword">this</span>);</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span><span class="preprocessor">#if USE_DELAY_POOLS</span></div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>        <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>-&gt;<a class="code hl_function" href="classstore__client.html#a31b3c123a2b2d6450f66699cf3a84bf8">setDelayId</a>(<a class="code hl_function" href="classDelayId.html#af62e27c317c2b62b8e9711410616dd42">DelayId::DelayClient</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>));</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span> </div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>        <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>().<a class="code hl_variable" href="classLogTags.html#abed628637be6b214d7860ed402927259">oldType</a> == <a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a6b18a17e02ffba088ef54d6c6570a2da">LOG_TCP_HIT</a>);</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>        <span class="comment">/* guarantee nothing has been sent yet! */</span></div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>        <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#acbc2aeb0bd5adc0d5a30e22b03532129">size</a> == 0);</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>        <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a> == 0);</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span> </div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classConnStateData.html">ConnStateData</a> *conn = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()) {</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a>.isHitTosActive()) {</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>                <a class="code hl_function" href="namespaceIp_1_1Qos.html#adc0228f1ab3df2b3b2bd54fac7f4b89b">Ip::Qos::doTosLocalHit</a>(conn-&gt;clientConnection);</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>            }</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span> </div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a>.isHitNfmarkActive()) {</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>                <a class="code hl_function" href="namespaceIp_1_1Qos.html#a53ab24bd5dd147beeb5d2bbdb5a192de">Ip::Qos::doNfmarkLocalHit</a>(conn-&gt;clientConnection);</div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>            }</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>        }</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span> </div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>        <a class="code hl_function" href="classclientReplyContext.html#a309764bf3b36e0af99299869fdba6c24">triggerInitialStoreRead</a>(<a class="code hl_variable" href="classclientReplyContext.html#a6782d4abafb931f4a2b5aa1b088f8fbf">CacheHit</a>);</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>        <span class="comment">/* MISS CASE, http-&gt;loggingTags() are already set! */</span></div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>        <a class="code hl_function" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">processMiss</a>();</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>    }</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>}</div>
</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span> </div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01685" data-start="{" data-end="}">
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"><a class="line" href="client__side__reply_8cc.html#a882f672982c92a2dd9c2238b261cf17f"> 1685</a></span><a class="code hl_variable" href="client__side__reply_8cc.html#ab806362f706a7b39732957bb45e3c2df">clientReplyDetach</a>(<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> * <a class="code hl_struct" href="structnode.html">node</a>, <a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> * http)</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>{</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>    <a class="code hl_function" href="group__ClientStreamInternal.html#gae62c467856741b9fdc6c8b919ea65462">clientStreamDetach</a>(<a class="code hl_struct" href="structnode.html">node</a>, http);</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>}</div>
</div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span> </div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span><a class="code hl_variable" href="classclientReplyContext.html#afa64e15976d047eb00f04402a0525711">clientReplyContext::SendMoreData</a>(<span class="keywordtype">void</span> *data, <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> result)</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>{</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>    <a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *context = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *<span class="keyword">&gt;</span>(data);</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>    context-&gt;<a class="code hl_function" href="classclientReplyContext.html#ab7bb9cba9e77c4e81cf83757464a4974">sendMoreData</a> (result);</div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>}</div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span> </div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01703" data-start="{" data-end="}">
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a1a51e420015bfaab501ab67039ccae6c"> 1703</a></span><a class="code hl_function" href="classclientReplyContext.html#a1a51e420015bfaab501ab67039ccae6c">clientReplyContext::makeThisHead</a>()</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>{</div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>    <span class="comment">/* At least, I think that&#39;s what this does */</span></div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>    <a class="code hl_function" href="dlink_8cc.html#a26c24944a77583bb90a7efb1455a269b">dlinkDelete</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ad2bda94a7fa9e86b17a08e3018f82c0e">active</a>, &amp;<a class="code hl_variable" href="dlink_8cc.html#a9c55f8c6c000159340141e62253dc26f">ClientActiveRequests</a>);</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>    <a class="code hl_function" href="dlink_8cc.html#a6653213a8433b9e40b94980846e0634a">dlinkAdd</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>, &amp;<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ad2bda94a7fa9e86b17a08e3018f82c0e">active</a>, &amp;<a class="code hl_variable" href="dlink_8cc.html#a9c55f8c6c000159340141e62253dc26f">ClientActiveRequests</a>);</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>}</div>
</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span> </div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen01711" data-start="{" data-end="}">
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a5f0fe361dead4a945b4fd80d7594d7b8"> 1711</a></span><a class="code hl_function" href="classclientReplyContext.html#a5f0fe361dead4a945b4fd80d7594d7b8">clientReplyContext::errorInStream</a>(<span class="keyword">const</span> <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> &amp;result)<span class="keyword"> const</span></div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>    <span class="keywordflow">return</span> <span class="comment">/* aborted request */</span></div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>        (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>() &amp;&amp; <a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462af1d0ae16fcfb269505ed3e22bc2e3fe5">ENTRY_ABORTED</a>)) ||</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>        <span class="comment">/* Upstream read error */</span> (result.<a class="code hl_variable" href="classStoreIOBuffer.html#acb67e9b7fb58fa7b15114bd024533f44">flags</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a1e3225390c0c4999a67e22a9b503ca16">error</a>);</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>}</div>
</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span> </div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01719" data-start="{" data-end="}">
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a468308db7244b1439db0c4cde60acc39"> 1719</a></span><a class="code hl_function" href="classclientReplyContext.html#a468308db7244b1439db0c4cde60acc39">clientReplyContext::sendStreamError</a>(<a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> <span class="keyword">const</span> &amp;result)</div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>{</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;A stream error has occurred, marking as complete and sending no data.&quot;</span>);</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>    <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> localTempBuffer;</div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>    <a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#a9fd53bdc9adcf5af7aab7d5c4312ccd0">complete</a> = 1;</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a7a91240cae5dac8e6819f84b31c923dc">streamError</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>    localTempBuffer.<a class="code hl_variable" href="classStoreIOBuffer.html#acb67e9b7fb58fa7b15114bd024533f44">flags</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a1e3225390c0c4999a67e22a9b503ca16">error</a> = result.<a class="code hl_variable" href="classStoreIOBuffer.html#acb67e9b7fb58fa7b15114bd024533f44">flags</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a1e3225390c0c4999a67e22a9b503ca16">error</a>;</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>    <a class="code hl_function" href="group__ClientStreamAPI.html#ga99b0c67ea123ea13bd712b3ffd77509b">clientStreamCallback</a>((<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a>*)<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a60d7fc0293487a5b5914f10acae1e120">head</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>                         localTempBuffer);</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>}</div>
</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span> </div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01736" data-start="{" data-end="}">
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a48c73104bca1be8ee82a1dfe6abdc8bc"> 1736</a></span><a class="code hl_function" href="classclientReplyContext.html#a48c73104bca1be8ee82a1dfe6abdc8bc">clientReplyContext::pushStreamData</a>(<span class="keyword">const</span> <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> &amp;result)</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>{</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>    <span class="keywordflow">if</span> (result.<a class="code hl_variable" href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">length</a> == 0) {</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <span class="stringliteral">&quot;clientReplyContext::pushStreamData: marking request as complete due to 0 length store result&quot;</span>);</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>        <a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#a9fd53bdc9adcf5af7aab7d5c4312ccd0">complete</a> = 1;</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>    }</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span> </div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(!result.<a class="code hl_variable" href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">length</a> || result.<a class="code hl_variable" href="classStoreIOBuffer.html#a61c7333c49e943c24964ae030c96b5ec">offset</a> == <a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;readBuffer.offset);</div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>    <a class="code hl_function" href="group__ClientStreamAPI.html#ga99b0c67ea123ea13bd712b3ffd77509b">clientStreamCallback</a>((<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a>*)<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a60d7fc0293487a5b5914f10acae1e120">head</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span>                         result);</div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>}</div>
</div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span> </div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span><a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *</div>
<div class="foldopen" id="foldopen01749" data-start="{" data-end="}">
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd"> 1749</a></span><a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">clientReplyContext::next</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a> ( (<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a>*)<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a60d7fc0293487a5b5914f10acae1e120">head</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#ad1228295f9f83f14e0c58966479cfbd7">next</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a> == <a class="code hl_function" href="classclientReplyContext.html#ae381916c474e872fdad5a018ecc082fe">getNextNode</a>());</div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classclientReplyContext.html#ae381916c474e872fdad5a018ecc082fe">getNextNode</a>();</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>}</div>
</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span> </div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01756" data-start="{" data-end="}">
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a9dd97cfd8b9ba9373b633651d3a59039"> 1756</a></span><a class="code hl_function" href="classclientReplyContext.html#a9dd97cfd8b9ba9373b633651d3a59039">clientReplyContext::sendBodyTooLargeError</a>()</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>{</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5abf5219eb9e74a6fdfd6dd88693619c51">LOG_TCP_DENIED_REPLY</a>);</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>    <a class="code hl_class" href="classErrorState.html">ErrorState</a> *err = <a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(<a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aab442793281e45c7214a6e3d221b49505">ERR_TOO_BIG</a>, <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>                                       <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>(), <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>    <a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">removeClientStoreReference</a>(&amp;(<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>), <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>    <a class="code hl_function" href="http_2Message_8h.html#adc5c03415efc511e2b62e809310969b6">HTTPMSGUNLOCK</a>(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>);</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>    <a class="code hl_function" href="classclientReplyContext.html#a4c65a525bd9fc6c042e060c434822948">startError</a>(err);</div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span> </div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span>}</div>
</div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span> </div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01769" data-start="{" data-end="}">
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a23ed47bc9f4ef61b40462fce26657140"> 1769</a></span><a class="code hl_function" href="classclientReplyContext.html#a23ed47bc9f4ef61b40462fce26657140">clientReplyContext::sendPreconditionFailedError</a>()</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>{</div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a6b18a17e02ffba088ef54d6c6570a2da">LOG_TCP_HIT</a>);</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>    <a class="code hl_class" href="classErrorState.html">ErrorState</a> *<span class="keyword">const</span> err =</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>        <a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(<a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa73713db5aa2fdf0bf158f4ac137e559e">ERR_PRECONDITION_FAILED</a>, <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722ad90b7aeb8c45bd49cd1ca66c17f9c3a3">Http::scPreconditionFailed</a>,</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>                         <span class="keyword">nullptr</span>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>(), <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span>    <a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">removeClientStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>    <a class="code hl_function" href="http_2Message_8h.html#adc5c03415efc511e2b62e809310969b6">HTTPMSGUNLOCK</a>(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>);</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span>    <a class="code hl_function" href="classclientReplyContext.html#a4c65a525bd9fc6c042e060c434822948">startError</a>(err);</div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span>}</div>
</div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span> </div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01782" data-start="{" data-end="}">
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a52be4e7796600f0a88e09f4b60351123"> 1782</a></span><a class="code hl_function" href="classclientReplyContext.html#a52be4e7796600f0a88e09f4b60351123">clientReplyContext::sendNotModified</a>()</div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>{</div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *e = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>();</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span>    <span class="keyword">const</span> time_t timestamp = e-&gt;<a class="code hl_variable" href="classStoreEntry.html#a5880b874fdaa8aa76b21a5fedd609ca0">timestamp</a>;</div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span>    <span class="keyword">const</span> <span class="keyword">auto</span> temprep = e-&gt;<a class="code hl_function" href="classStoreEntry.html#a19fd5af89e99c467c29f7bd951ac901d">mem</a>().<a class="code hl_function" href="classMemObject.html#a89697947bc40cdbe591b9e26951b59ba">freshestReply</a>().<a class="code hl_function" href="classHttpReply.html#a421c5bad94f77616dcd3a3005bb07dc2">make304</a>();</div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>    <span class="comment">// log as TCP_INM_HIT if code 304 generated for</span></div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span>    <span class="comment">// If-None-Match request</span></div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a12193c977b3da18c04e6e4b350e860ba">ims</a>)</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5aed35072ed898085622fe3d94b529bce1">LOG_TCP_INM_HIT</a>);</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a8dc5d16057dd49c38a9d848b24f5a9dd">LOG_TCP_IMS_HIT</a>);</div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>    <a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">removeClientStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>    <a class="code hl_function" href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">createStoreEntry</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>, <a class="code hl_class" href="classRequestFlags.html">RequestFlags</a>());</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>    e = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>();</div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>    <span class="comment">// Copy timestamp from the original entry so the 304</span></div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span>    <span class="comment">// reply has a meaningful Age: header.</span></div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span>    e-&gt;<a class="code hl_function" href="classStoreEntry.html#a5bc295d1b8532fe259f903a6e9128d66">timestampsSet</a>();</div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>    e-&gt;<a class="code hl_variable" href="classStoreEntry.html#a5880b874fdaa8aa76b21a5fedd609ca0">timestamp</a> = timestamp;</div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>    e-&gt;<a class="code hl_function" href="classStoreEntry.html#aae28c5e9a323d60ac8fe8ce98f6eb7c5">replaceHttpReply</a>(temprep);</div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>    e-&gt;<a class="code hl_function" href="classStoreEntry.html#a3ae4c0876a20686e558e7183b67805f4">complete</a>();</div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span><span class="comment">     * TODO: why put this in the store and then serialise it and</span></div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span><span class="comment">     * then parse it again. Simply mark the request complete in</span></div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span><span class="comment">     * our context and write the reply struct to the client side.</span></div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span><span class="comment">     */</span></div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>    <a class="code hl_function" href="classclientReplyContext.html#a309764bf3b36e0af99299869fdba6c24">triggerInitialStoreRead</a>();</div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>}</div>
</div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span> </div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01813" data-start="{" data-end="}">
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a0ec275cfe423205b6348b57c50fd9ca0"> 1813</a></span><a class="code hl_function" href="classclientReplyContext.html#a0ec275cfe423205b6348b57c50fd9ca0">clientReplyContext::sendNotModifiedOrPreconditionFailedError</a>()</div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>{</div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a> ||</div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b">Http::METHOD_HEAD</a>)</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>        <a class="code hl_function" href="classclientReplyContext.html#a52be4e7796600f0a88e09f4b60351123">sendNotModified</a>();</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>        <a class="code hl_function" href="classclientReplyContext.html#a23ed47bc9f4ef61b40462fce26657140">sendPreconditionFailedError</a>();</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>}</div>
</div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span> </div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01823" data-start="{" data-end="}">
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ae0d825813513d976e115fab8658d0dff"> 1823</a></span><a class="code hl_function" href="classclientReplyContext.html#ae0d825813513d976e115fab8658d0dff">clientReplyContext::processReplyAccess</a> ()</div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span>{</div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>    <span class="comment">/* NP: this should probably soft-fail to a zero-sized-reply error ?? */</span></div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>);</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span> </div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>().<a class="code hl_variable" href="classLogTags.html#abed628637be6b214d7860ed402927259">oldType</a> == <a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a16a4df28091bca4eda98565febc8fe36">LOG_TCP_DENIED</a> ||</div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>            <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>().<a class="code hl_variable" href="classLogTags.html#abed628637be6b214d7860ed402927259">oldType</a> == <a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5abf5219eb9e74a6fdfd6dd88693619c51">LOG_TCP_DENIED_REPLY</a> ||</div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>            <a class="code hl_function" href="classclientReplyContext.html#a1f6deea197aeb4c93d27457f592811cd">alwaysAllowResponse</a>(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">sline</a>.<a class="code hl_function" href="classHttp_1_1StatusLine.html#af852e58bb3e96bc41cd16787b0a7d7db">status</a>())) {</div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>        <a class="code hl_function" href="classclientReplyContext.html#a9708b6cfee00c7274a16db7a5600c91e">processReplyAccessResult</a>(<a class="code hl_enumvalue" href="group__ACLAPI.html#gga449cde9b9fa7a3ddb6d83d61080c1df5aa3d37d87d9b3887abc5466afb368cb8a">ACCESS_ALLOWED</a>);</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span>    }</div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span> </div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_function" href="classHttpReply.html#ab7284b573f7cd11a9c9d47651362e8c1">expectedBodyTooLarge</a>(*<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>)) {</div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span>        <a class="code hl_function" href="classclientReplyContext.html#a9dd97cfd8b9ba9373b633651d3a59039">sendBodyTooLargeError</a>();</div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span>    }</div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span> </div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a49a06ee4587216a830b30d56b4a37d43">reply</a>) {</div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>        <a class="code hl_function" href="classclientReplyContext.html#a9708b6cfee00c7274a16db7a5600c91e">processReplyAccessResult</a>(<a class="code hl_enumvalue" href="group__ACLAPI.html#gga449cde9b9fa7a3ddb6d83d61080c1df5aa3d37d87d9b3887abc5466afb368cb8a">ACCESS_ALLOWED</a>);</div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>    }</div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span> </div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>    <span class="keyword">auto</span> replyChecklist =</div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>        <a class="code hl_function" href="client__side_8cc.html#aa43c942879dd80b024c465afa58f85aa">clientAclChecklistCreate</a>(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a49a06ee4587216a830b30d56b4a37d43">reply</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>    replyChecklist-&gt;updateReply(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>);</div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>    <a class="code hl_function" href="classACLFilledChecklist.html#a5521f60eda45233a9424f46161cf8809">ACLFilledChecklist::NonBlockingCheck</a>(std::move(replyChecklist), <a class="code hl_variable" href="classclientReplyContext.html#a1d93c954a015240864b04716337c731a">ProcessReplyAccessResult</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>}</div>
</div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span> </div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span><a class="code hl_variable" href="classclientReplyContext.html#a1d93c954a015240864b04716337c731a">clientReplyContext::ProcessReplyAccessResult</a>(<a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> rv, <span class="keywordtype">void</span> *voidMe)</div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>{</div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span>    <a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *me = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *<span class="keyword">&gt;</span>(voidMe);</div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span>    me-&gt;<a class="code hl_function" href="classclientReplyContext.html#a9708b6cfee00c7274a16db7a5600c91e">processReplyAccessResult</a>(rv);</div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>}</div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span> </div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01863" data-start="{" data-end="}">
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a9708b6cfee00c7274a16db7a5600c91e"> 1863</a></span><a class="code hl_function" href="classclientReplyContext.html#a9708b6cfee00c7274a16db7a5600c91e">clientReplyContext::processReplyAccessResult</a>(<span class="keyword">const</span> <a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> &amp;accessAllowed)</div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>{</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 2, <span class="stringliteral">&quot;The reply for &quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a></div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span>           &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; accessAllowed &lt;&lt; <span class="stringliteral">&quot;, because it matched &quot;</span></div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span>           &lt;&lt; accessAllowed.<a class="code hl_function" href="classAcl_1_1Answer.html#a8a8bb1976fa15edce01b4af92dbafad8">lastCheckDescription</a>());</div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span> </div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span>    <span class="keywordflow">if</span> (!accessAllowed.<a class="code hl_function" href="classAcl_1_1Answer.html#af1a1444d19654eb50f7a4323b225f845">allowed</a>()) {</div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>        <a class="code hl_class" href="classErrorState.html">ErrorState</a> *err;</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span>        <span class="keyword">auto</span> page_id = <a class="code hl_function" href="acl_2Gadgets_8cc.html#a08bdf8035f35f6af7f7d4ada13655efa">FindDenyInfoPage</a>(accessAllowed, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span> </div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5abf5219eb9e74a6fdfd6dd88693619c51">LOG_TCP_DENIED_REPLY</a>);</div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span> </div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>        <span class="keywordflow">if</span> (page_id == <a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa5203071ca85e00df6bf2526855b6df0d">ERR_NONE</a>)</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>            page_id = <a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa16e7157079ceea3394a7a000af25c013">ERR_ACCESS_DENIED</a>;</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span> </div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>        err = <a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(page_id, <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>                               <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>(), <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span> </div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>        <a class="code hl_function" href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">removeClientStoreReference</a>(&amp;<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span> </div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>        <a class="code hl_function" href="http_2Message_8h.html#adc5c03415efc511e2b62e809310969b6">HTTPMSGUNLOCK</a>(<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>);</div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span> </div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>        <a class="code hl_function" href="classclientReplyContext.html#a4c65a525bd9fc6c042e060c434822948">startError</a>(err);</div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span> </div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>    }</div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span> </div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>    <span class="comment">/* Ok, the reply is allowed, */</span></div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#af52b42fc3f7ed18172aa09d69f856e55">loggingEntry</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>());</div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span> </div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>    <a class="code hl_define" href="Assure_8h.html#a1fcca4cd6cfc3b9f835aa3652eb0c2f5">Assure</a>(<a class="code hl_function" href="classclientReplyContext.html#a42f78e9406c59b07aeadb0d9c275d0be">matchesStreamBodyBuffer</a>(<a class="code hl_variable" href="classclientReplyContext.html#abca6bf899bcdd71d05414bde4a8b774f">lastStreamBufferedBytes</a>));</div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>    <a class="code hl_define" href="Assure_8h.html#a1fcca4cd6cfc3b9f835aa3652eb0c2f5">Assure</a>(!<a class="code hl_variable" href="classclientReplyContext.html#abca6bf899bcdd71d05414bde4a8b774f">lastStreamBufferedBytes</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a61c7333c49e943c24964ae030c96b5ec">offset</a>);</div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span>    <span class="keyword">auto</span> body_size = <a class="code hl_variable" href="classclientReplyContext.html#abca6bf899bcdd71d05414bde4a8b774f">lastStreamBufferedBytes</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">length</a>; <span class="comment">// may be zero</span></div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span> </div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 3, <span class="stringliteral">&quot;clientReplyContext::sendMoreData: Appending &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span>           (<span class="keywordtype">int</span>) body_size &lt;&lt; <span class="stringliteral">&quot; bytes after &quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a7d9970e0240d7981206d051db1719d93">hdr_sz</a> &lt;&lt;</div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>           <span class="stringliteral">&quot; bytes of headers&quot;</span>);</div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span> </div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b">Http::METHOD_HEAD</a>) {</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>        <span class="comment">/* do not forward body for HEAD replies */</span></div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>        body_size = 0;</div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>        <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#aaa05fd2e87baa36553d2039aa92901a3">flags</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Flags.html#ada185aa70ccc6b2da21c33f453dca0b5">done_copying</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span>        <a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#a9fd53bdc9adcf5af7aab7d5c4312ccd0">complete</a> = 1;</div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>    }</div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span> </div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a> (!<a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#aa19634b100888f59e7df68a32f7bef1f">headersSent</a>);</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>    <a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#aa19634b100888f59e7df68a32f7bef1f">headersSent</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span> </div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>    <span class="comment">// next()-&gt;readBuffer.offset may be positive for Range requests, but our</span></div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>    <span class="comment">// localTempBuffer initialization code assumes that next()-&gt;readBuffer.data</span></div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>    <span class="comment">// points to the response body at offset 0 because the first</span></div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>    <span class="comment">// storeClientCopy() request always has offset 0 (i.e. our first Store</span></div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>    <span class="comment">// request ignores next()-&gt;readBuffer.offset).</span></div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span>    <span class="comment">//</span></div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>    <span class="comment">// XXX: We cannot fully check that assumption: readBuffer.offset field is</span></div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>    <span class="comment">// often out of sync with the buffer content, and if some buggy code updates</span></div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>    <span class="comment">// the buffer while we were waiting for the processReplyAccessResult()</span></div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>    <span class="comment">// callback, we may not notice.</span></div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span> </div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>    <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> localTempBuffer;</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>    <span class="keyword">const</span> <span class="keyword">auto</span> body_buf = <a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;<a class="code hl_variable" href="classclientStreamNode.html#a0610ee06cfe7e3208cfffe67437dad9a">readBuffer</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a08224ebb5a73aa6b18c0e7a60ebf00b5">data</a>;</div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span> </div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>    <span class="comment">//Server side may disable ranges under some circumstances.</span></div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span> </div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span>    <span class="keywordflow">if</span> ((!<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a0e84a414e1c5857a0d8681f0a9c13317">range</a>))</div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>        <a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;<a class="code hl_variable" href="classclientStreamNode.html#a0610ee06cfe7e3208cfffe67437dad9a">readBuffer</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a61c7333c49e943c24964ae030c96b5ec">offset</a> = 0;</div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span> </div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;readBuffer.offset &gt; 0) {</div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="SquidMath_8h.html#ae851012a120157350a79dbdd4e9d87fd">Less</a>(body_size, <a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;readBuffer.offset)) {</div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>            <span class="comment">/* Can&#39;t use any of the body we received. send nothing */</span></div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>            localTempBuffer.<a class="code hl_variable" href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">length</a> = 0;</div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span>            localTempBuffer.<a class="code hl_variable" href="classStoreIOBuffer.html#a08224ebb5a73aa6b18c0e7a60ebf00b5">data</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>            localTempBuffer.<a class="code hl_variable" href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">length</a> = body_size - <a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;<a class="code hl_variable" href="classclientStreamNode.html#a0610ee06cfe7e3208cfffe67437dad9a">readBuffer</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a61c7333c49e943c24964ae030c96b5ec">offset</a>;</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>            localTempBuffer.<a class="code hl_variable" href="classStoreIOBuffer.html#a08224ebb5a73aa6b18c0e7a60ebf00b5">data</a> = body_buf + <a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;<a class="code hl_variable" href="classclientStreamNode.html#a0610ee06cfe7e3208cfffe67437dad9a">readBuffer</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a61c7333c49e943c24964ae030c96b5ec">offset</a>;</div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span>        }</div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>        localTempBuffer.<a class="code hl_variable" href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">length</a> = body_size;</div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>        localTempBuffer.<a class="code hl_variable" href="classStoreIOBuffer.html#a08224ebb5a73aa6b18c0e7a60ebf00b5">data</a> = body_buf;</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span>    }</div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span> </div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>    <a class="code hl_function" href="group__ClientStreamAPI.html#ga99b0c67ea123ea13bd712b3ffd77509b">clientStreamCallback</a>((<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *)<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a60d7fc0293487a5b5914f10acae1e120">head</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>,</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span>                         <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>, <a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>, localTempBuffer);</div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span> </div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>}</div>
</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span> </div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01951" data-start="{" data-end="}">
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ab7bb9cba9e77c4e81cf83757464a4974"> 1951</a></span><a class="code hl_function" href="classclientReplyContext.html#ab7bb9cba9e77c4e81cf83757464a4974">clientReplyContext::sendMoreData</a> (<a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> result)</div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span>{</div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#aa57444bb386525911015174e9042fee3">deleting</a>)</div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span> </div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> &lt;&lt; <span class="stringliteral">&quot; got &quot;</span> &lt;&lt; result);</div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span> </div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *entry = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>();</div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span> </div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classConnStateData.html">ConnStateData</a> * conn = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()) {</div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>        <span class="keywordflow">if</span> (!conn-&gt;isOpen()) {</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33,3, <span class="stringliteral">&quot;not sending more data to closing connection &quot;</span> &lt;&lt; conn-&gt;clientConnection);</div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span>        }</div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>        <span class="keywordflow">if</span> (conn-&gt;pinning.zeroReply) {</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33,3, <span class="stringliteral">&quot;not sending more data after a pinned zero reply &quot;</span> &lt;&lt; conn-&gt;clientConnection);</div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>        }</div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span> </div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#aa19634b100888f59e7df68a32f7bef1f">headersSent</a> &amp;&amp; !<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>().<a class="code hl_function" href="classLogTags.html#aea1194c638b43a3273a8280cee485215">isTcpHit</a>()) {</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>            <span class="comment">// We get here twice if processReplyAccessResult() calls startError().</span></div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>            <span class="comment">// TODO: Revise when we check/change QoS markings to reduce syscalls.</span></div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a>.isHitTosActive()) {</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span>                <a class="code hl_function" href="namespaceIp_1_1Qos.html#a8c2605e4add905a8db95e453904fc821">Ip::Qos::doTosLocalMiss</a>(conn-&gt;clientConnection, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a5c031f584be4a77277cccd49b0d4cea1">hier</a>.<a class="code hl_variable" href="classHierarchyLogEntry.html#ac79cc06b0d8333ee14e8cc66d3941e6d">code</a>);</div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>            }</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a>.isHitNfmarkActive()) {</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>                <a class="code hl_function" href="namespaceIp_1_1Qos.html#ab4475c57093eddcf462cbe95a074230d">Ip::Qos::doNfmarkLocalMiss</a>(conn-&gt;clientConnection, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a5c031f584be4a77277cccd49b0d4cea1">hier</a>.<a class="code hl_variable" href="classHierarchyLogEntry.html#ac79cc06b0d8333ee14e8cc66d3941e6d">code</a>);</div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>            }</div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>        }</div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span> </div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 5, conn-&gt;clientConnection &lt;&lt;</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span>               <span class="stringliteral">&quot; &#39;&quot;</span> &lt;&lt; entry-&gt;<a class="code hl_function" href="classStoreEntry.html#a3835284a1cb3623987d557c9754e5ffc">url</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt;</div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>               <span class="stringliteral">&quot; out.offset=&quot;</span> &lt;&lt; <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a>);</div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>    }</div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span> </div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>    <span class="comment">/* We&#39;ve got the final data to start pushing... */</span></div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>    <a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#abee3bb6f7775ddc1b0ddb0b6525d110d">storelogiccomplete</a> = 1;</div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span> </div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span> </div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>    <span class="comment">/* ESI TODO: remove this assert once everything is stable */</span></div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a60d7fc0293487a5b5914f10acae1e120">head</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a></div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span>           &amp;&amp; <a class="code hl_function" href="cbdata_8cc.html#aa6ed5c53b844c6f8f3e7c39daa051835">cbdataReferenceValid</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a60d7fc0293487a5b5914f10acae1e120">head</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>));</div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span> </div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>    <a class="code hl_function" href="classclientReplyContext.html#a1a51e420015bfaab501ab67039ccae6c">makeThisHead</a>();</div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span> </div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classclientReplyContext.html#a5f0fe361dead4a945b4fd80d7594d7b8">errorInStream</a>(result)) {</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span>        <a class="code hl_function" href="classclientReplyContext.html#a468308db7244b1439db0c4cde60acc39">sendStreamError</a>(result);</div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>    }</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span> </div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classclientReplyContext.html#a42f78e9406c59b07aeadb0d9c275d0be">matchesStreamBodyBuffer</a>(result)) {</div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>        <span class="comment">// Subsequent processing expects response body bytes to be at the start</span></div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>        <span class="comment">// of our Client Stream buffer. When given something else (e.g., bytes</span></div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>        <span class="comment">// in our tempbuf), we copy and adjust to meet those expectations.</span></div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span>        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ourClientStreamsBuffer = <a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;<a class="code hl_variable" href="classclientStreamNode.html#a0610ee06cfe7e3208cfffe67437dad9a">readBuffer</a>;</div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>        <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(result.<a class="code hl_variable" href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">length</a> &lt;= ourClientStreamsBuffer.length);</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>        memcpy(ourClientStreamsBuffer.data, result.<a class="code hl_variable" href="classStoreIOBuffer.html#a08224ebb5a73aa6b18c0e7a60ebf00b5">data</a>, result.<a class="code hl_variable" href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">length</a>);</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>        result.<a class="code hl_variable" href="classStoreIOBuffer.html#a08224ebb5a73aa6b18c0e7a60ebf00b5">data</a> = ourClientStreamsBuffer.data;</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>    }</div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span> </div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>    <a class="code hl_function" href="classclientReplyContext.html#ab6355997efa53f6426a7effa12e96a2c">noteStreamBufferredBytes</a>(result);</div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span> </div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#aa19634b100888f59e7df68a32f7bef1f">headersSent</a>) {</div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>        <a class="code hl_function" href="classclientReplyContext.html#a48c73104bca1be8ee82a1dfe6abdc8bc">pushStreamData</a>(result);</div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>    }</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span> </div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span>    <a class="code hl_function" href="classclientReplyContext.html#ad7df8874888e0b2da857407f16a8cb30">cloneReply</a>();</div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span> </div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span><span class="preprocessor">#if USE_DELAY_POOLS</span></div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>)</div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>        <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>-&gt;<a class="code hl_function" href="classstore__client.html#a31b3c123a2b2d6450f66699cf3a84bf8">setDelayId</a>(<a class="code hl_function" href="classDelayId.html#af62e27c317c2b62b8e9711410616dd42">DelayId::DelayClient</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>,<a class="code hl_variable" href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">reply</a>));</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span> </div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>    <a class="code hl_function" href="classclientReplyContext.html#ae0d825813513d976e115fab8658d0dff">processReplyAccess</a>();</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span>}</div>
</div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span> </div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen02033" data-start="{" data-end="}">
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a42f78e9406c59b07aeadb0d9c275d0be"> 2033</a></span><a class="code hl_function" href="classclientReplyContext.html#a42f78e9406c59b07aeadb0d9c275d0be">clientReplyContext::matchesStreamBodyBuffer</a>(<span class="keyword">const</span> <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> &amp;their)<span class="keyword"> const</span></div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>    <span class="comment">// the answer is undefined for errors; they are not really &quot;body buffers&quot;</span></div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span>    <a class="code hl_define" href="Assure_8h.html#a1fcca4cd6cfc3b9f835aa3652eb0c2f5">Assure</a>(!their.<a class="code hl_variable" href="classStoreIOBuffer.html#acb67e9b7fb58fa7b15114bd024533f44">flags</a>.<a class="code hl_variable" href="classStoreIOBuffer.html#a1e3225390c0c4999a67e22a9b503ca16">error</a>);</div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span> </div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span>    <span class="keywordflow">if</span> (!their.<a class="code hl_variable" href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">length</a>)</div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// an empty body area always matches our body area</span></div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span> </div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>    <span class="keywordflow">if</span> (their.<a class="code hl_variable" href="classStoreIOBuffer.html#a08224ebb5a73aa6b18c0e7a60ebf00b5">data</a> != <a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;readBuffer.<a class="code hl_variable" href="classclientStreamNode.html#a3ffd025e7396d93b36a80c2048915ac8">data</a>) {</div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(88, 7, <span class="stringliteral">&quot;no: &quot;</span> &lt;&lt; their &lt;&lt; <span class="stringliteral">&quot; vs. &quot;</span> &lt;&lt; <a class="code hl_function" href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">next</a>()-&gt;readBuffer);</div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span>    }</div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span> </div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>}</div>
</div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span> </div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen02050" data-start="{" data-end="}">
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ab6355997efa53f6426a7effa12e96a2c"> 2050</a></span><a class="code hl_function" href="classclientReplyContext.html#ab6355997efa53f6426a7effa12e96a2c">clientReplyContext::noteStreamBufferredBytes</a>(<span class="keyword">const</span> <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> &amp;result)</div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>{</div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span>    <a class="code hl_define" href="Assure_8h.html#a1fcca4cd6cfc3b9f835aa3652eb0c2f5">Assure</a>(<a class="code hl_function" href="classclientReplyContext.html#a42f78e9406c59b07aeadb0d9c275d0be">matchesStreamBodyBuffer</a>(result));</div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span>    <a class="code hl_variable" href="classclientReplyContext.html#abca6bf899bcdd71d05414bde4a8b774f">lastStreamBufferedBytes</a> = result; <span class="comment">// may be unchanged and/or zero-length</span></div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span>}</div>
</div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span> </div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen02057" data-start="{" data-end="}">
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#ae92bf01da2cf0ca237e0ef7c77cbe445"> 2057</a></span><a class="code hl_function" href="classclientReplyContext.html#ae92bf01da2cf0ca237e0ef7c77cbe445">clientReplyContext::fillChecklist</a>(<a class="code hl_class" href="classACLFilledChecklist.html">ACLFilledChecklist</a> &amp;checklist)<span class="keyword"> const</span></div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>    <a class="code hl_function" href="client__side_8cc.html#acabcacffff4309ce2ac0aa3252eaf2ba">clientAclChecklistFill</a>(checklist, <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>);</div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span>}</div>
</div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span> </div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span><span class="comment">/* Using this breaks the client layering just a little!</span></div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span><span class="comment"> */</span></div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"> 2064</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen02065" data-start="{" data-end="}">
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"><a class="line" href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c"> 2065</a></span><a class="code hl_function" href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">clientReplyContext::createStoreEntry</a>(<span class="keyword">const</span> <a class="code hl_class" href="classHttpRequestMethod.html">HttpRequestMethod</a>&amp; m, <a class="code hl_class" href="classRequestFlags.html">RequestFlags</a> reqFlags)</div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span>{</div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span><span class="comment">     * For erroneous requests, we might not have a h-&gt;request,</span></div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span><span class="comment">     * so make a fake one.</span></div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span><span class="comment">     */</span></div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span> </div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>        <span class="keyword">const</span> <span class="keyword">auto</span> connManager = <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>();</div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span>        <span class="keyword">const</span> <span class="keyword">auto</span> mx = <a class="code hl_function" href="classMasterXaction.html#af3cb33c92de57dbb4f9b5a0bf5488ad4">MasterXaction::MakePortful</a>(connManager ? connManager-&gt;port : <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span>        <span class="comment">// XXX: These fake URI parameters shadow the real (or error:...) URI.</span></div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span>        <span class="comment">// TODO: Either always set the request earlier and assert here OR use</span></div>
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"> 2078</span>        <span class="comment">// http-&gt;uri (converted to Anyp::Uri) to create this catch-all request.</span></div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span>        <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *&amp;<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>) =  <span class="keyword">new</span> <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a>(m, <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca0afa51095369614c8fa01f910aab785a">AnyP::PROTO_NONE</a>, <span class="stringliteral">&quot;http&quot;</span>, <a class="code hl_variable" href="globals_8h.html#a8a6c8d13b6170bf1847dd3921530489b">null_string</a>, mx);</div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span>        <a class="code hl_function" href="http_2Message_8h.html#afbf13ecd1cc5c007367ae094c1aa19a9">HTTPMSGLOCK</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>);</div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>    }</div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span> </div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *e = <a class="code hl_function" href="store_8cc.html#a872157d7a8c43bb5facb072ce03c4d48">storeCreateEntry</a>(<a class="code hl_function" href="classclientReplyContext.html#ad42a3d89a4030a9571bd374eb1d67277">storeId</a>(), <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a3f6d0f7008f5302283e91937cdc67f75">log_uri</a>, reqFlags, m);</div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span> </div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span>    <span class="comment">// Make entry collapsible ASAP, to increase collapsing chances for others,</span></div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>    <span class="comment">// TODO: every must-revalidate and similar request MUST reach the origin,</span></div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span>    <span class="comment">// but do we have to prohibit others from collapsing on that request?</span></div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>    <span class="keywordflow">if</span> (reqFlags.<a class="code hl_variable" href="classRequestFlags.html#af33cb0e80d9996c532479ef942d1eb91">cachable</a> &amp;&amp;</div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>            !reqFlags.<a class="code hl_variable" href="classRequestFlags.html#a0247d4ae2646e09402e31bc09c7ff4c6">needValidation</a> &amp;&amp;</div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span>            (m == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a> || m == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b">Http::METHOD_HEAD</a>) &amp;&amp;</div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>            <a class="code hl_function" href="classStoreClient.html#a97f3b428b24aefc0bd350d6b060bb8e0">mayInitiateCollapsing</a>()) {</div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>        <span class="comment">// make the entry available for future requests now</span></div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span>        (void)<a class="code hl_function" href="namespaceStore.html#a0151d620409db8bd3af40e3570a18f8c">Store::Root</a>().<a class="code hl_function" href="classStore_1_1Controller.html#a49893add4ee497be08fd54fde817a7d9">allowCollapsing</a>(e, reqFlags, m);</div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span>    }</div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span> </div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span>    <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a> = <a class="code hl_function" href="store__client_8cc.html#ae077d286d865af03eb1357a8de9ba75b">storeClientListAdd</a>(e, <span class="keyword">this</span>);</div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span> </div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span><span class="preprocessor">#if USE_DELAY_POOLS</span></div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span>    <a class="code hl_variable" href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">sc</a>-&gt;<a class="code hl_function" href="classstore__client.html#a31b3c123a2b2d6450f66699cf3a84bf8">setDelayId</a>(<a class="code hl_function" href="classDelayId.html#af62e27c317c2b62b8e9711410616dd42">DelayId::DelayClient</a>(<a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>));</div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span> </div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>    <span class="comment">/* The next line is illegal because we don&#39;t know if the client stream</span></div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span><span class="comment">     * buffers have been set up</span></div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span><span class="comment">     */</span></div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>    <span class="comment">//    storeClientCopy(http-&gt;sc, e, 0, HTTP_REQBUF_SZ, http-&gt;reqbuf,</span></div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>    <span class="comment">//        SendMoreData, this);</span></div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span>    <span class="comment">/* So, we mark the store logic as complete */</span></div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>    <a class="code hl_variable" href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">flags</a>.<a class="code hl_variable" href="structclientReplyContext_1_1Flags.html#abee3bb6f7775ddc1b0ddb0b6525d110d">storelogiccomplete</a> = 1;</div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span> </div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>    <span class="comment">/* and get the caller to request a read, from wherever they are */</span></div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>    <span class="comment">/* NOTE: after ANY data flows down the pipe, even one step,</span></div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span><span class="comment">     * this function CAN NOT be used to manage errors</span></div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span><span class="comment">     */</span></div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>    <a class="code hl_variable" href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>(e);</div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>}</div>
</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span> </div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span><a class="code hl_class" href="classErrorState.html">ErrorState</a> *</div>
<div class="foldopen" id="foldopen02118" data-start="{" data-end="}">
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"><a class="line" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39"> 2118</a></span><a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(<a class="code hl_enumeration" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1a">err_type</a> page_id, <a class="code hl_enumeration" href="namespaceHttp.html#a432f881deb187c726161d6435daec722">Http::StatusCode</a> status, <span class="keywordtype">char</span> <span class="keyword">const</span> *url,</div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span>                 <span class="keyword">const</span> <a class="code hl_class" href="classConnStateData.html">ConnStateData</a> *conn, <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request, <span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">AccessLogEntry::Pointer</a> &amp;al)</div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span>{</div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span>    <span class="keyword">const</span> <span class="keyword">auto</span> err = <span class="keyword">new</span> <a class="code hl_class" href="classErrorState.html">ErrorState</a>(page_id, status, request, al);</div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span>    err-&gt;src_addr = conn &amp;&amp; conn-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a> ? conn-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a60e1b863400f49a2ed17054982561f17">remote</a> : <a class="code hl_function" href="classIp_1_1Address.html#a6d11815f11cf7d7a0582ed800282f949">Ip::Address::NoAddr</a>();</div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span> </div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span>    <span class="keywordflow">if</span> (url)</div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span>        err-&gt;url = <a class="code hl_define" href="negotiate__wrapper_8cc.html#a5eb055ca3b42205cc134b4a438cd9a72">xstrdup</a>(url);</div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span> </div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>    <span class="keywordflow">return</span> err;</div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span>}</div>
</div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span> </div>
<div class="ttc" id="aAssure_8h_html_a1fcca4cd6cfc3b9f835aa3652eb0c2f5"><div class="ttname"><a href="Assure_8h.html#a1fcca4cd6cfc3b9f835aa3652eb0c2f5">Assure</a></div><div class="ttdeci">#define Assure(condition)</div><div class="ttdef"><b>Definition</b> <a href="Assure_8h_source.html#l00035">Assure.h:35</a></div></div>
<div class="ttc" id="aDelayPools_8h_html"><div class="ttname"><a href="DelayPools_8h.html">DelayPools.h</a></div></div>
<div class="ttc" id="aETag_8h_html"><div class="ttname"><a href="ETag_8h.html">ETag.h</a></div></div>
<div class="ttc" id="aFilledChecklist_8h_html"><div class="ttname"><a href="FilledChecklist_8h.html">FilledChecklist.h</a></div></div>
<div class="ttc" id="aFwdState_8h_html"><div class="ttname"><a href="FwdState_8h.html">FwdState.h</a></div></div>
<div class="ttc" id="aHeaderMangling_8cc_html_a8ec4a597e9cad23e1ffd9390c1c58e7d"><div class="ttname"><a href="HeaderMangling_8cc.html#a8ec4a597e9cad23e1ffd9390c1c58e7d">httpHdrMangleList</a></div><div class="ttdeci">void httpHdrMangleList(HttpHeader *l, HttpRequest *request, const AccessLogEntryPointer &amp;al, req_or_rep_t req_or_rep)</div><div class="ttdef"><b>Definition</b> <a href="HeaderMangling_8cc_source.html#l00082">HeaderMangling.cc:82</a></div></div>
<div class="ttc" id="aHeaderMangling_8h_html"><div class="ttname"><a href="HeaderMangling_8h.html">HeaderMangling.h</a></div></div>
<div class="ttc" id="aHeaderMangling_8h_html_a292ed346109090f6c9c8c27d7447f2d8aae9afd116433e45bb99f6f5151b986b5"><div class="ttname"><a href="HeaderMangling_8h.html#a292ed346109090f6c9c8c27d7447f2d8aae9afd116433e45bb99f6f5151b986b5">ROR_REPLY</a></div><div class="ttdeci">@ ROR_REPLY</div><div class="ttdef"><b>Definition</b> <a href="HeaderMangling_8h_source.html#l00035">HeaderMangling.h:34</a></div></div>
<div class="ttc" id="aHttpHeaderTools_8cc_html_a66e35b739c80b623af93c27827d600e5"><div class="ttname"><a href="HttpHeaderTools_8cc.html#a66e35b739c80b623af93c27827d600e5">httpHeaderPutStrf</a></div><div class="ttdeci">void httpHeaderPutStrf(HttpHeader *hdr, Http::HdrType id, const char *fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="HttpHeaderTools_8cc_source.html#l00025">HttpHeaderTools.cc:25</a></div></div>
<div class="ttc" id="aHttpHeaderTools_8h_html"><div class="ttname"><a href="HttpHeaderTools_8h.html">HttpHeaderTools.h</a></div></div>
<div class="ttc" id="aHttpHeader_8h_html_aac9fc01c2b9cda8c02b1f7f8a2a9c78b"><div class="ttname"><a href="HttpHeader_8h.html#aac9fc01c2b9cda8c02b1f7f8a2a9c78b">HttpHeaderPos</a></div><div class="ttdeci">ssize_t HttpHeaderPos</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00045">HttpHeader.h:45</a></div></div>
<div class="ttc" id="aHttpHeader_8h_html_abf5d862281ddf9a5315fcfa5be166c07"><div class="ttname"><a href="HttpHeader_8h.html#abf5d862281ddf9a5315fcfa5be166c07">HttpHeaderInitPos</a></div><div class="ttdeci">#define HttpHeaderInitPos</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00048">HttpHeader.h:48</a></div></div>
<div class="ttc" id="aHttpReply_8h_html"><div class="ttname"><a href="HttpReply_8h.html">HttpReply.h</a></div></div>
<div class="ttc" id="aHttpRequest_8h_html"><div class="ttname"><a href="HttpRequest_8h.html">HttpRequest.h</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a0647b915c26297fd48b107622903093c"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a0647b915c26297fd48b107622903093c">LOG_TCP_REFRESH_FAIL_ERR</a></div><div class="ttdeci">@ LOG_TCP_REFRESH_FAIL_ERR</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00046">LogTags.h:46</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a16a4df28091bca4eda98565febc8fe36"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a16a4df28091bca4eda98565febc8fe36">LOG_TCP_DENIED</a></div><div class="ttdeci">@ LOG_TCP_DENIED</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00055">LogTags.h:55</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a213d85bd40f00127b4926963c362b9de"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a213d85bd40f00127b4926963c362b9de">LOG_TCP_REFRESH</a></div><div class="ttdeci">@ LOG_TCP_REFRESH</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00048">LogTags.h:48</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a31bd86c7b936a5bb63106d8c0048abe3"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a31bd86c7b936a5bb63106d8c0048abe3">LOG_TCP_NEGATIVE_HIT</a></div><div class="ttdeci">@ LOG_TCP_NEGATIVE_HIT</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00053">LogTags.h:53</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a384d0c751acd7c3fbdf7b3b460fdcf2c"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a384d0c751acd7c3fbdf7b3b460fdcf2c">LOG_TCP_REFRESH_MODIFIED</a></div><div class="ttdeci">@ LOG_TCP_REFRESH_MODIFIED</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00047">LogTags.h:47</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a4228cbccd4cbcf5bb01cd29c88e9b313"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a4228cbccd4cbcf5bb01cd29c88e9b313">LOG_TCP_REDIRECT</a></div><div class="ttdeci">@ LOG_TCP_REDIRECT</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00058">LogTags.h:58</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a426f2351c79f420e8fead9a1ba831be3"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a426f2351c79f420e8fead9a1ba831be3">LOG_TCP_OFFLINE_HIT</a></div><div class="ttdeci">@ LOG_TCP_OFFLINE_HIT</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00057">LogTags.h:57</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a6b18a17e02ffba088ef54d6c6570a2da"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a6b18a17e02ffba088ef54d6c6570a2da">LOG_TCP_HIT</a></div><div class="ttdeci">@ LOG_TCP_HIT</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00042">LogTags.h:42</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a6b1b04ecf3a513f752a3ec377f008a6d"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a6b1b04ecf3a513f752a3ec377f008a6d">LOG_TCP_REFRESH_FAIL_OLD</a></div><div class="ttdeci">@ LOG_TCP_REFRESH_FAIL_OLD</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00045">LogTags.h:45</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a73a7b8edaf3bd5b6cfe483e4b9e068a3">LOG_TCP_MISS</a></div><div class="ttdeci">@ LOG_TCP_MISS</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00043">LogTags.h:43</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a75f8d8f24297647ede5f517c1a659fe1"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a75f8d8f24297647ede5f517c1a659fe1">LOG_TCP_MEM_HIT</a></div><div class="ttdeci">@ LOG_TCP_MEM_HIT</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00054">LogTags.h:54</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a8dc5d16057dd49c38a9d848b24f5a9dd"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a8dc5d16057dd49c38a9d848b24f5a9dd">LOG_TCP_IMS_HIT</a></div><div class="ttdeci">@ LOG_TCP_IMS_HIT</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00050">LogTags.h:50</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5ab7d48c74f5c9b5611f95f59f40b28488"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5ab7d48c74f5c9b5611f95f59f40b28488">LOG_TCP_REFRESH_UNMODIFIED</a></div><div class="ttdeci">@ LOG_TCP_REFRESH_UNMODIFIED</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00044">LogTags.h:44</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5abf5219eb9e74a6fdfd6dd88693619c51"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5abf5219eb9e74a6fdfd6dd88693619c51">LOG_TCP_DENIED_REPLY</a></div><div class="ttdeci">@ LOG_TCP_DENIED_REPLY</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00056">LogTags.h:56</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5abffe054100050f80168ef5e1d7a4cb27"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5abffe054100050f80168ef5e1d7a4cb27">LOG_TCP_SWAPFAIL_MISS</a></div><div class="ttdeci">@ LOG_TCP_SWAPFAIL_MISS</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00052">LogTags.h:52</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5ae19fd4a06c3cb6bd8515559ffd304bfd"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5ae19fd4a06c3cb6bd8515559ffd304bfd">LOG_TCP_CLIENT_REFRESH_MISS</a></div><div class="ttdeci">@ LOG_TCP_CLIENT_REFRESH_MISS</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00049">LogTags.h:49</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5aed35072ed898085622fe3d94b529bce1"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5aed35072ed898085622fe3d94b529bce1">LOG_TCP_INM_HIT</a></div><div class="ttdeci">@ LOG_TCP_INM_HIT</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00051">LogTags.h:51</a></div></div>
<div class="ttc" id="aMemObject_8h_html"><div class="ttname"><a href="MemObject_8h.html">MemObject.h</a></div></div>
<div class="ttc" id="aPool_8cc_html_a161e26ef0307ccb4300ad3ea54bf9fd4"><div class="ttname"><a href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a></div><div class="ttdeci">time_t squid_curtime</div><div class="ttdef"><b>Definition</b> <a href="stub__libtime_8cc_source.html#l00020">stub_libtime.cc:20</a></div></div>
<div class="ttc" id="aPortCfg_8h_html"><div class="ttname"><a href="PortCfg_8h.html">PortCfg.h</a></div></div>
<div class="ttc" id="aQosConfig_8h_html"><div class="ttname"><a href="QosConfig_8h.html">QosConfig.h</a></div></div>
<div class="ttc" id="aRequestFlags_8h_html"><div class="ttname"><a href="RequestFlags_8h.html">RequestFlags.h</a></div></div>
<div class="ttc" id="aSquidConfig_8cc_html_a75b136e6a1eef61424d84596a404aafe"><div class="ttname"><a href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a></div><div class="ttdeci">class SquidConfig Config</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8cc_source.html#l00012">SquidConfig.cc:12</a></div></div>
<div class="ttc" id="aSquidConfig_8cc_html_aee3a9c37e62203dfdb929215f0f8fc0a"><div class="ttname"><a href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a></div><div class="ttdeci">class SquidConfig2 Config2</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8cc_source.html#l00014">SquidConfig.cc:14</a></div></div>
<div class="ttc" id="aSquidConfig_8h_html"><div class="ttname"><a href="SquidConfig_8h.html">SquidConfig.h</a></div></div>
<div class="ttc" id="aSquidMath_8h_html"><div class="ttname"><a href="SquidMath_8h.html">SquidMath.h</a></div></div>
<div class="ttc" id="aSquidMath_8h_html_ae851012a120157350a79dbdd4e9d87fd"><div class="ttname"><a href="SquidMath_8h.html#ae851012a120157350a79dbdd4e9d87fd">Less</a></div><div class="ttdeci">constexpr bool Less(const A a, const B b)</div><div class="ttdoc">whether integer a is less than integer b, with correct overflow handling</div><div class="ttdef"><b>Definition</b> <a href="SquidMath_8h_source.html#l00048">SquidMath.h:48</a></div></div>
<div class="ttc" id="aStoreClient_8h_html_a48e07440f256e626bf7b91ee8236f028"><div class="ttname"><a href="StoreClient_8h.html#a48e07440f256e626bf7b91ee8236f028">STCB</a></div><div class="ttdeci">void(void *, StoreIOBuffer) STCB</div><div class="ttdef"><b>Definition</b> <a href="StoreClient_8h_source.html#l00032">StoreClient.h:32</a></div></div>
<div class="ttc" id="aStoreClient_8h_html_a53c9348905c2b02db1e455b92a8d3825"><div class="ttname"><a href="StoreClient_8h.html#a53c9348905c2b02db1e455b92a8d3825">storeClientIsThisAClient</a></div><div class="ttdeci">int storeClientIsThisAClient(store_client *sc, void *someClient)</div></div>
<div class="ttc" id="aStore_8h_html"><div class="ttname"><a href="Store_8h.html">Store.h</a></div></div>
<div class="ttc" id="aStrList_8h_html"><div class="ttname"><a href="StrList_8h.html">StrList.h</a></div></div>
<div class="ttc" id="aTextException_8h_html_ad79a19f4098f2506d0aa28628f18fd36"><div class="ttname"><a href="TextException_8h.html#ad79a19f4098f2506d0aa28628f18fd36">Must</a></div><div class="ttdeci">#define Must(condition)</div><div class="ttdef"><b>Definition</b> <a href="TextException_8h_source.html#l00075">TextException.h:75</a></div></div>
<div class="ttc" id="aToken_8h_html"><div class="ttname"><a href="Token_8h.html">Token.h</a></div></div>
<div class="ttc" id="aUserRequest_8h_html"><div class="ttname"><a href="UserRequest_8h.html">UserRequest.h</a></div></div>
<div class="ttc" id="aaccess__log_8h_html"><div class="ttname"><a href="access__log_8h.html">access_log.h</a></div></div>
<div class="ttc" id="aacl_2Gadgets_8cc_html_a08bdf8035f35f6af7f7d4ada13655efa"><div class="ttname"><a href="acl_2Gadgets_8cc.html#a08bdf8035f35f6af7f7d4ada13655efa">FindDenyInfoPage</a></div><div class="ttdeci">err_type FindDenyInfoPage(const Acl::Answer &amp;answer, const bool redirect_allowed)</div><div class="ttdef"><b>Definition</b> <a href="acl_2Gadgets_8cc_source.html#l00034">Gadgets.cc:34</a></div></div>
<div class="ttc" id="aacl_2Gadgets_8h_html"><div class="ttname"><a href="acl_2Gadgets_8h.html">Gadgets.h</a></div></div>
<div class="ttc" id="aassert_8h_html_a33fa45e42155e69ce8d0da0fd978b351"><div class="ttname"><a href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a></div><div class="ttdeci">#define assert(EX)</div><div class="ttdef"><b>Definition</b> <a href="assert_8h_source.html#l00017">assert.h:17</a></div></div>
<div class="ttc" id="aautoconf_8h_html_aa6119eb054c0919b333de6888ac28c75"><div class="ttname"><a href="autoconf_8h.html#aa6119eb054c0919b333de6888ac28c75">USE_AUTH</a></div><div class="ttdeci">#define USE_AUTH</div><div class="ttdef"><b>Definition</b> <a href="autoconf_8h_source.html#l01489">autoconf.h:1489</a></div></div>
<div class="ttc" id="acbdata_8cc_html_aa6ed5c53b844c6f8f3e7c39daa051835"><div class="ttname"><a href="cbdata_8cc.html#aa6ed5c53b844c6f8f3e7c39daa051835">cbdataReferenceValid</a></div><div class="ttdeci">int cbdataReferenceValid(const void *p)</div><div class="ttdef"><b>Definition</b> <a href="cbdata_8cc_source.html#l00270">cbdata.cc:270</a></div></div>
<div class="ttc" id="acbdata_8h_html_a178af3acec8011dd955016f69e307037"><div class="ttname"><a href="cbdata_8h.html#a178af3acec8011dd955016f69e307037">cbdataReferenceDone</a></div><div class="ttdeci">#define cbdataReferenceDone(var)</div><div class="ttdef"><b>Definition</b> <a href="cbdata_8h_source.html#l00357">cbdata.h:357</a></div></div>
<div class="ttc" id="acbdata_8h_html_a23338dbb451f460facd39a8a249bab46"><div class="ttname"><a href="cbdata_8h.html#a23338dbb451f460facd39a8a249bab46">cbdataReference</a></div><div class="ttdeci">#define cbdataReference(var)</div><div class="ttdef"><b>Definition</b> <a href="cbdata_8h_source.html#l00348">cbdata.h:348</a></div></div>
<div class="ttc" id="acbdata_8h_html_a4710a3530194cffbc7f74fa2b2c4529d"><div class="ttname"><a href="cbdata_8h.html#a4710a3530194cffbc7f74fa2b2c4529d">CBDATA_CLASS_INIT</a></div><div class="ttdeci">#define CBDATA_CLASS_INIT(type)</div><div class="ttdef"><b>Definition</b> <a href="cbdata_8h_source.html#l00325">cbdata.h:325</a></div></div>
<div class="ttc" id="aclassACLChecklist_html_a51ae541a90994e7ed5d11f2b242ac689"><div class="ttname"><a href="classACLChecklist.html#a51ae541a90994e7ed5d11f2b242ac689">ACLChecklist::fastCheck</a></div><div class="ttdeci">Acl::Answer const &amp; fastCheck()</div><div class="ttdef"><b>Definition</b> <a href="Checklist_8cc_source.html#l00298">Checklist.cc:298</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html"><div class="ttname"><a href="classACLFilledChecklist.html">ACLFilledChecklist</a></div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8h_source.html#l00033">FilledChecklist.h:34</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html_a5521f60eda45233a9424f46161cf8809"><div class="ttname"><a href="classACLFilledChecklist.html#a5521f60eda45233a9424f46161cf8809">ACLFilledChecklist::NonBlockingCheck</a></div><div class="ttdeci">static void NonBlockingCheck(MakingPointer &amp;&amp;p, ACLCB *cb, void *data)</div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8h_source.html#l00054">FilledChecklist.h:54</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html_a8f0f73e6ee8033be85471a92bd9d4703"><div class="ttname"><a href="classACLFilledChecklist.html#a8f0f73e6ee8033be85471a92bd9d4703">ACLFilledChecklist::updateReply</a></div><div class="ttdeci">void updateReply(const HttpReply::Pointer &amp;)</div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8cc_source.html#l00221">FilledChecklist.cc:221</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_1_1CacheDetails_html_ae7601ddfc08eef5f4af309c87f3ff59f"><div class="ttname"><a href="classAccessLogEntry_1_1CacheDetails.html#ae7601ddfc08eef5f4af309c87f3ff59f">AccessLogEntry::CacheDetails::code</a></div><div class="ttdeci">LogTags code</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00154">AccessLogEntry.h:154</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_1_1HttpDetails_html_afaef5bd16c55d6723beb468d0bc75643"><div class="ttname"><a href="classAccessLogEntry_1_1HttpDetails.html#afaef5bd16c55d6723beb468d0bc75643">AccessLogEntry::HttpDetails::code</a></div><div class="ttdeci">int code</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00093">AccessLogEntry.h:93</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html_a19bddcabb9a3d2f290c183a171afa4b3"><div class="ttname"><a href="classAccessLogEntry.html#a19bddcabb9a3d2f290c183a171afa4b3">AccessLogEntry::reply</a></div><div class="ttdeci">HttpReplyPointer reply</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00191">AccessLogEntry.h:191</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html_a4574f49181917c5496dca9ace95ea344"><div class="ttname"><a href="classAccessLogEntry.html#a4574f49181917c5496dca9ace95ea344">AccessLogEntry::cache</a></div><div class="ttdeci">class AccessLogEntry::CacheDetails cache</div></div>
<div class="ttc" id="aclassAccessLogEntry_html_a753215d3854b1129173deb898f7c7e99"><div class="ttname"><a href="classAccessLogEntry.html#a753215d3854b1129173deb898f7c7e99">AccessLogEntry::http</a></div><div class="ttdeci">class AccessLogEntry::HttpDetails http</div></div>
<div class="ttc" id="aclassAcl_1_1Answer_html"><div class="ttname"><a href="classAcl_1_1Answer.html">Acl::Answer</a></div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00053">Acl.h:54</a></div></div>
<div class="ttc" id="aclassAcl_1_1Answer_html_a8a8bb1976fa15edce01b4af92dbafad8"><div class="ttname"><a href="classAcl_1_1Answer.html#a8a8bb1976fa15edce01b4af92dbafad8">Acl::Answer::lastCheckDescription</a></div><div class="ttdeci">const SBuf &amp; lastCheckDescription() const</div><div class="ttdoc">describes the ACL that was evaluated last while obtaining this answer (for debugging)</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8cc_source.html#l00123">Acl.cc:123</a></div></div>
<div class="ttc" id="aclassAcl_1_1Answer_html_af1a1444d19654eb50f7a4323b225f845"><div class="ttname"><a href="classAcl_1_1Answer.html#af1a1444d19654eb50f7a4323b225f845">Acl::Answer::allowed</a></div><div class="ttdeci">bool allowed() const</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00082">Acl.h:82</a></div></div>
<div class="ttc" id="aclassAnyP_1_1ProtocolVersion_html_a9b781ce0242bffdbc1694f09ceefffa5"><div class="ttname"><a href="classAnyP_1_1ProtocolVersion.html#a9b781ce0242bffdbc1694f09ceefffa5">AnyP::ProtocolVersion::protocol</a></div><div class="ttdeci">ProtocolType protocol</div><div class="ttdoc">which protocol this version is for</div><div class="ttdef"><b>Definition</b> <a href="anyp_2ProtocolVersion_8h_source.html#l00039">ProtocolVersion.h:39</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_a267687947070d739a63da8a42969f12c"><div class="ttname"><a href="classAnyP_1_1Uri.html#a267687947070d739a63da8a42969f12c">AnyP::Uri::getScheme</a></div><div class="ttdeci">AnyP::UriScheme const &amp; getScheme() const</div><div class="ttdef"><b>Definition</b> <a href="Uri_8h_source.html#l00058">Uri.h:58</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_aab379cecc273683d9744197a8a2efe3f"><div class="ttname"><a href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">AnyP::Uri::host</a></div><div class="ttdeci">void host(const char *src)</div><div class="ttdef"><b>Definition</b> <a href="Uri_8cc_source.html#l00154">Uri.cc:154</a></div></div>
<div class="ttc" id="aclassAuth_1_1UserRequest_html_a1ba1b6d925ff4df965c7c7365cf1973b"><div class="ttname"><a href="classAuth_1_1UserRequest.html#a1ba1b6d925ff4df965c7c7365cf1973b">Auth::UserRequest::AddReplyAuthHeader</a></div><div class="ttdeci">static void AddReplyAuthHeader(HttpReply *rep, UserRequest::Pointer auth_user_request, HttpRequest *request, int accelerated, int internal)</div><div class="ttdoc">Add the appropriate [Proxy-]Authenticate header to the given reply.</div><div class="ttdef"><b>Definition</b> <a href="UserRequest_8cc_source.html#l00492">UserRequest.cc:492</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html"><div class="ttname"><a href="classClientHttpRequest.html">ClientHttpRequest</a></div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00030">client_side_request.h:35</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a220035029f64b125f600da80744a9ed1"><div class="ttname"><a href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">ClientHttpRequest::out</a></div><div class="ttdeci">struct ClientHttpRequest::Out out</div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a2becc63f591bbc0b40542099c1bb05a9"><div class="ttname"><a href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">ClientHttpRequest::request</a></div><div class="ttdeci">HttpRequest *const request</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00130">client_side_request.h:130</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a3e8660eb3f78ddb12f5f36f716755109"><div class="ttname"><a href="classClientHttpRequest.html#a3e8660eb3f78ddb12f5f36f716755109">ClientHttpRequest::gotEnough</a></div><div class="ttdeci">bool gotEnough() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01431">client_side_request.cc:1431</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a3f6d0f7008f5302283e91937cdc67f75"><div class="ttname"><a href="classClientHttpRequest.html#a3f6d0f7008f5302283e91937cdc67f75">ClientHttpRequest::log_uri</a></div><div class="ttdeci">char *const log_uri</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00141">client_side_request.h:141</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a4ba011f5f09d32fba56441c385752255"><div class="ttname"><a href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">ClientHttpRequest::getConn</a></div><div class="ttdeci">ConnStateData * getConn() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00068">client_side_request.h:68</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a76420f9c4799ef8132d4e11dc494b5ef"><div class="ttname"><a href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">ClientHttpRequest::updateLoggingTags</a></div><div class="ttdeci">void updateLoggingTags(const LogTags_ot code)</div><div class="ttdoc">update the code in the transaction processing tags</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00091">client_side_request.h:91</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_aaa05fd2e87baa36553d2039aa92901a3"><div class="ttname"><a href="classClientHttpRequest.html#aaa05fd2e87baa36553d2039aa92901a3">ClientHttpRequest::flags</a></div><div class="ttdeci">struct ClientHttpRequest::Flags flags</div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ab2d33ce5e3e5a930de04639ee09a1bcc"><div class="ttname"><a href="classClientHttpRequest.html#ab2d33ce5e3e5a930de04639ee09a1bcc">ClientHttpRequest::onlyIfCached</a></div><div class="ttdeci">bool onlyIfCached() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00154">client_side_request.cc:154</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ab7002a77dc4201885bc9c3e38aa3f26e"><div class="ttname"><a href="classClientHttpRequest.html#ab7002a77dc4201885bc9c3e38aa3f26e">ClientHttpRequest::requestSatisfactionMode</a></div><div class="ttdeci">bool requestSatisfactionMode() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00211">client_side_request.h:211</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ac1d305af64fb92ccfce613c1eb96d178"><div class="ttname"><a href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">ClientHttpRequest::uri</a></div><div class="ttdeci">char * uri</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00135">client_side_request.h:135</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ac8c0f73794781ce53acf6083e0077f34"><div class="ttname"><a href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">ClientHttpRequest::storeEntry</a></div><div class="ttdeci">StoreEntry * storeEntry() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00063">client_side_request.h:63</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ad2bda94a7fa9e86b17a08e3018f82c0e"><div class="ttname"><a href="classClientHttpRequest.html#ad2bda94a7fa9e86b17a08e3018f82c0e">ClientHttpRequest::active</a></div><div class="ttdeci">dlink_node active</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00173">client_side_request.h:173</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ae2f400bf3f3d140535bfa6c43908a348"><div class="ttname"><a href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">ClientHttpRequest::client_stream</a></div><div class="ttdeci">dlink_list client_stream</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00174">client_side_request.h:174</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_aee8237109aebae9e3711a066ddfa42c0"><div class="ttname"><a href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">ClientHttpRequest::loggingTags</a></div><div class="ttdeci">const LogTags &amp; loggingTags() const</div><div class="ttdoc">the processing tags associated with this request transaction.</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00094">client_side_request.h:94</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_af1ec5778cbc7fcd488df2918c821f499"><div class="ttname"><a href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">ClientHttpRequest::al</a></div><div class="ttdeci">const AccessLogEntry::Pointer al</div><div class="ttdoc">access.log entry</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00161">client_side_request.h:161</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_af52b42fc3f7ed18172aa09d69f856e55"><div class="ttname"><a href="classClientHttpRequest.html#af52b42fc3f7ed18172aa09d69f856e55">ClientHttpRequest::loggingEntry</a></div><div class="ttdeci">StoreEntry * loggingEntry() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00065">client_side_request.h:65</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_afc0f851aa12908396cb5457c085a4e6f"><div class="ttname"><a href="classClientHttpRequest.html#afc0f851aa12908396cb5457c085a4e6f">ClientHttpRequest::redirect</a></div><div class="ttdeci">struct ClientHttpRequest::Redirect redirect</div></div>
<div class="ttc" id="aclassComm_1_1Connection_html_a60e1b863400f49a2ed17054982561f17"><div class="ttname"><a href="classComm_1_1Connection.html#a60e1b863400f49a2ed17054982561f17">Comm::Connection::remote</a></div><div class="ttdeci">Ip::Address remote</div><div class="ttdef"><b>Definition</b> <a href="Connection_8h_source.html#l00152">Connection.h:152</a></div></div>
<div class="ttc" id="aclassConnStateData_html"><div class="ttname"><a href="classConnStateData.html">ConnStateData</a></div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00079">client_side.h:84</a></div></div>
<div class="ttc" id="aclassConnStateData_html_ae06c387dd773449597078259a953013b"><div class="ttname"><a href="classConnStateData.html#ae06c387dd773449597078259a953013b">ConnStateData::port</a></div><div class="ttdeci">AnyP::Port port</div><div class="ttdoc">destination port of the request that caused serverConnection</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00145">client_side.h:145</a></div></div>
<div class="ttc" id="aclassDelayId_html_af62e27c317c2b62b8e9711410616dd42"><div class="ttname"><a href="classDelayId.html#af62e27c317c2b62b8e9711410616dd42">DelayId::DelayClient</a></div><div class="ttdeci">static DelayId DelayClient(ClientHttpRequest *, HttpReply *reply=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="DelayId_8cc_source.html#l00064">DelayId.cc:64</a></div></div>
<div class="ttc" id="aclassETag_html"><div class="ttname"><a href="classETag.html">ETag</a></div><div class="ttdef"><b>Definition</b> <a href="ETag_8h_source.html#l00017">ETag.h:18</a></div></div>
<div class="ttc" id="aclassETag_html_ac85cff3313d939f356bc6e438dd01da8"><div class="ttname"><a href="classETag.html#ac85cff3313d939f356bc6e438dd01da8">ETag::weak</a></div><div class="ttdeci">int weak</div><div class="ttdoc">true if it is a weak validator</div><div class="ttdef"><b>Definition</b> <a href="ETag_8h_source.html#l00021">ETag.h:21</a></div></div>
<div class="ttc" id="aclassETag_html_aead6b3157b513d9645823d7ee9859342"><div class="ttname"><a href="classETag.html#aead6b3157b513d9645823d7ee9859342">ETag::str</a></div><div class="ttdeci">const char * str</div><div class="ttdoc">quoted-string</div><div class="ttdef"><b>Definition</b> <a href="ETag_8h_source.html#l00020">ETag.h:20</a></div></div>
<div class="ttc" id="aclassErrorState_html"><div class="ttname"><a href="classErrorState.html">ErrorState</a></div><div class="ttdef"><b>Definition</b> <a href="errorpage_8h_source.html#l00088">errorpage.h:89</a></div></div>
<div class="ttc" id="aclassErrorState_html_ada325088568d82f3396fb20e592596bc"><div class="ttname"><a href="classErrorState.html#ada325088568d82f3396fb20e592596bc">ErrorState::callback_data</a></div><div class="ttdeci">void * callback_data</div><div class="ttdef"><b>Definition</b> <a href="errorpage_8h_source.html#l00186">errorpage.h:186</a></div></div>
<div class="ttc" id="aclassErrorState_html_aeb69480d52455c3be9e80e1a77655308"><div class="ttname"><a href="classErrorState.html#aeb69480d52455c3be9e80e1a77655308">ErrorState::httpStatus</a></div><div class="ttdeci">Http::StatusCode httpStatus</div><div class="ttdef"><b>Definition</b> <a href="errorpage_8h_source.html#l00173">errorpage.h:173</a></div></div>
<div class="ttc" id="aclassFwdState_html_a391d66921577e62e543723f978062e97"><div class="ttname"><a href="classFwdState.html#a391d66921577e62e543723f978062e97">FwdState::Start</a></div><div class="ttdeci">static void Start(const Comm::ConnectionPointer &amp;client, StoreEntry *, HttpRequest *, const AccessLogEntryPointer &amp;alp)</div><div class="ttdoc">Initiates request forwarding to a peer or origin server.</div><div class="ttdef"><b>Definition</b> <a href="FwdState_8cc_source.html#l00338">FwdState.cc:338</a></div></div>
<div class="ttc" id="aclassHierarchyLogEntry_html_ac79cc06b0d8333ee14e8cc66d3941e6d"><div class="ttname"><a href="classHierarchyLogEntry.html#ac79cc06b0d8333ee14e8cc66d3941e6d">HierarchyLogEntry::code</a></div><div class="ttdeci">hier_code code</div><div class="ttdef"><b>Definition</b> <a href="HierarchyLogEntry_8h_source.html#l00046">HierarchyLogEntry.h:46</a></div></div>
<div class="ttc" id="aclassHttpBody_html_abb3eb1a004f3a6c95f77207855d2b2fd"><div class="ttname"><a href="classHttpBody.html#abb3eb1a004f3a6c95f77207855d2b2fd">HttpBody::set</a></div><div class="ttdeci">void set(const SBuf &amp;newContent)</div><div class="ttdef"><b>Definition</b> <a href="HttpBody_8h_source.html#l00026">HttpBody.h:26</a></div></div>
<div class="ttc" id="aclassHttpHeaderEntry_html"><div class="ttname"><a href="classHttpHeaderEntry.html">HttpHeaderEntry</a></div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00050">HttpHeader.h:51</a></div></div>
<div class="ttc" id="aclassHttpHeaderEntry_html_ad4de5645a10ac4022a3667753b7904a8"><div class="ttname"><a href="classHttpHeaderEntry.html#ad4de5645a10ac4022a3667753b7904a8">HttpHeaderEntry::id</a></div><div class="ttdeci">Http::HdrType id</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00066">HttpHeader.h:66</a></div></div>
<div class="ttc" id="aclassHttpHeaderEntry_html_af1721f40aef39eef4476a19f806aedaa"><div class="ttname"><a href="classHttpHeaderEntry.html#af1721f40aef39eef4476a19f806aedaa">HttpHeaderEntry::value</a></div><div class="ttdeci">String value</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00068">HttpHeader.h:68</a></div></div>
<div class="ttc" id="aclassHttpHeader_html"><div class="ttname"><a href="classHttpHeader.html">HttpHeader</a></div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00074">HttpHeader.h:75</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_a0ca2bdbdb30c64bdbeed4b355f37fc26"><div class="ttname"><a href="classHttpHeader.html#a0ca2bdbdb30c64bdbeed4b355f37fc26">HttpHeader::removeHopByHopEntries</a></div><div class="ttdeci">void removeHopByHopEntries()</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01843">HttpHeader.cc:1843</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_a187949b24278b65f28338947c605b130"><div class="ttname"><a href="classHttpHeader.html#a187949b24278b65f28338947c605b130">HttpHeader::putStr</a></div><div class="ttdeci">void putStr(Http::HdrType id, const char *str)</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01128">HttpHeader.cc:1128</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_a3d53e322173b75fa99bdd4357fd97307"><div class="ttname"><a href="classHttpHeader.html#a3d53e322173b75fa99bdd4357fd97307">HttpHeader::delAt</a></div><div class="ttdeci">void delAt(HttpHeaderPos pos, int &amp;headers_deleted)</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l00827">HttpHeader.cc:827</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_a4936a0d9f8086a70e0ffc6d7de87f604"><div class="ttname"><a href="classHttpHeader.html#a4936a0d9f8086a70e0ffc6d7de87f604">HttpHeader::putInt</a></div><div class="ttdeci">void putInt(Http::HdrType id, int number)</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01101">HttpHeader.cc:1101</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_a54dbaa59c66d44d0612450a6cc06e5ac"><div class="ttname"><a href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">HttpHeader::delById</a></div><div class="ttdeci">int delById(Http::HdrType id)</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l00799">HttpHeader.cc:799</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_a6a5a2911b3e812c91b5eab549fcf2f09"><div class="ttname"><a href="classHttpHeader.html#a6a5a2911b3e812c91b5eab549fcf2f09">HttpHeader::refreshMask</a></div><div class="ttdeci">void refreshMask()</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l00855">HttpHeader.cc:855</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_a81cb2fc85a9629783ba1e607de0f41ed"><div class="ttname"><a href="classHttpHeader.html#a81cb2fc85a9629783ba1e607de0f41ed">HttpHeader::getEntry</a></div><div class="ttdeci">HttpHeaderEntry * getEntry(HttpHeaderPos *pos) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l00716">HttpHeader.cc:716</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_abd93657e973fda6b90aa8ff0b12967f1"><div class="ttname"><a href="classHttpHeader.html#abd93657e973fda6b90aa8ff0b12967f1">HttpHeader::addVia</a></div><div class="ttdeci">void addVia(const AnyP::ProtocolVersion &amp;ver, const HttpHeader *from=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01078">HttpHeader.cc:1078</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_abe3327167942e75a78385e92bc1b26b7"><div class="ttname"><a href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">HttpHeader::has</a></div><div class="ttdeci">int has(Http::HdrType id) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01070">HttpHeader.cc:1070</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_abf9ae83ecee9c6ee5de511131993567b"><div class="ttname"><a href="classHttpHeader.html#abf9ae83ecee9c6ee5de511131993567b">HttpHeader::getInt64</a></div><div class="ttdeci">int64_t getInt64(Http::HdrType id) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01266">HttpHeader.cc:1266</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_acfab592ae0ede9d3934c233aacffbeeb"><div class="ttname"><a href="classHttpHeader.html#acfab592ae0ede9d3934c233aacffbeeb">HttpHeader::findEntry</a></div><div class="ttdeci">HttpHeaderEntry * findEntry(Http::HdrType id) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l00735">HttpHeader.cc:735</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_ad7bd04f01a83d7df9f84637583ba8632"><div class="ttname"><a href="classHttpHeader.html#ad7bd04f01a83d7df9f84637583ba8632">HttpHeader::putExt</a></div><div class="ttdeci">void putExt(const char *name, const char *value)</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01208">HttpHeader.cc:1208</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_ae04ecbfb773915c46d328d2d79ee7237"><div class="ttname"><a href="classHttpHeader.html#ae04ecbfb773915c46d328d2d79ee7237">HttpHeader::putTime</a></div><div class="ttdeci">void putTime(Http::HdrType id, time_t htime)</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01119">HttpHeader.cc:1119</a></div></div>
<div class="ttc" id="aclassHttpReply_html"><div class="ttname"><a href="classHttpReply.html">HttpReply</a></div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8h_source.html#l00024">HttpReply.h:25</a></div></div>
<div class="ttc" id="aclassHttpReply_html_a01790af23c553b590ac6009ebb693b6d"><div class="ttname"><a href="classHttpReply.html#a01790af23c553b590ac6009ebb693b6d">HttpReply::sline</a></div><div class="ttdeci">Http::StatusLine sline</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8h_source.html#l00056">HttpReply.h:56</a></div></div>
<div class="ttc" id="aclassHttpReply_html_a421c5bad94f77616dcd3a3005bb07dc2"><div class="ttname"><a href="classHttpReply.html#a421c5bad94f77616dcd3a3005bb07dc2">HttpReply::make304</a></div><div class="ttdeci">HttpReplyPointer make304() const</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8cc_source.html#l00129">HttpReply.cc:129</a></div></div>
<div class="ttc" id="aclassHttpReply_html_a5915e24ce1c0233d7f8466a2f7d22456"><div class="ttname"><a href="classHttpReply.html#a5915e24ce1c0233d7f8466a2f7d22456">HttpReply::setHeaders</a></div><div class="ttdeci">void setHeaders(Http::StatusCode status, const char *reason, const char *ctype, int64_t clen, time_t lmt, time_t expires)</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8cc_source.html#l00170">HttpReply.cc:170</a></div></div>
<div class="ttc" id="aclassHttpReply_html_a74ed30d9587d67debbc07741d36609a5"><div class="ttname"><a href="classHttpReply.html#a74ed30d9587d67debbc07741d36609a5">HttpReply::bodySize</a></div><div class="ttdeci">int64_t bodySize(const HttpRequestMethod &amp;) const</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8cc_source.html#l00377">HttpReply.cc:377</a></div></div>
<div class="ttc" id="aclassHttpReply_html_a79019e0e1ec286b22748ca291bea0637"><div class="ttname"><a href="classHttpReply.html#a79019e0e1ec286b22748ca291bea0637">HttpReply::body</a></div><div class="ttdeci">HttpBody body</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8h_source.html#l00058">HttpReply.h:58</a></div></div>
<div class="ttc" id="aclassHttpReply_html_a7d329af2d672e50fd1bea5e727dffa53"><div class="ttname"><a href="classHttpReply.html#a7d329af2d672e50fd1bea5e727dffa53">HttpReply::removeIrrelevantContentLength</a></div><div class="ttdeci">void removeIrrelevantContentLength()</div><div class="ttdoc">Some response status codes prohibit sending Content-Length (RFC 7230 section 3.3.2).</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8cc_source.html#l00646">HttpReply.cc:646</a></div></div>
<div class="ttc" id="aclassHttpReply_html_a7db386a07e80943a2125267fd485169e"><div class="ttname"><a href="classHttpReply.html#a7db386a07e80943a2125267fd485169e">HttpReply::receivedBodyTooLarge</a></div><div class="ttdeci">bool receivedBodyTooLarge(HttpRequest &amp;, int64_t receivedBodySize)</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8cc_source.html#l00557">HttpReply.cc:557</a></div></div>
<div class="ttc" id="aclassHttpReply_html_a849bd4060a868cd2b6c82e39604ee06f"><div class="ttname"><a href="classHttpReply.html#a849bd4060a868cd2b6c82e39604ee06f">HttpReply::redirect</a></div><div class="ttdeci">void redirect(Http::StatusCode, const char *)</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8cc_source.html#l00205">HttpReply.cc:205</a></div></div>
<div class="ttc" id="aclassHttpReply_html_ab7284b573f7cd11a9c9d47651362e8c1"><div class="ttname"><a href="classHttpReply.html#ab7284b573f7cd11a9c9d47651362e8c1">HttpReply::expectedBodyTooLarge</a></div><div class="ttdeci">bool expectedBodyTooLarge(HttpRequest &amp;request)</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8cc_source.html#l00565">HttpReply.cc:565</a></div></div>
<div class="ttc" id="aclassHttpReply_html_ae359a6d402671b8cd203ea35268e2de8"><div class="ttname"><a href="classHttpReply.html#ae359a6d402671b8cd203ea35268e2de8">HttpReply::clone</a></div><div class="ttdeci">HttpReply * clone() const override</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8cc_source.html#l00611">HttpReply.cc:611</a></div></div>
<div class="ttc" id="aclassHttpReply_html_aeb67dd2ad47812549069ccb159b29fe8"><div class="ttname"><a href="classHttpReply.html#aeb67dd2ad47812549069ccb159b29fe8">HttpReply::keep_alive</a></div><div class="ttdeci">short int keep_alive</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8h_source.html#l00053">HttpReply.h:53</a></div></div>
<div class="ttc" id="aclassHttpRequestMethod_html"><div class="ttname"><a href="classHttpRequestMethod.html">HttpRequestMethod</a></div><div class="ttdef"><b>Definition</b> <a href="RequestMethod_8h_source.html#l00026">RequestMethod.h:27</a></div></div>
<div class="ttc" id="aclassHttpRequest_html"><div class="ttname"><a href="classHttpRequest.html">HttpRequest</a></div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00048">HttpRequest.h:49</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a09d9b24db99ab44f59784c5682880446"><div class="ttname"><a href="classHttpRequest.html#a09d9b24db99ab44f59784c5682880446">HttpRequest::conditional</a></div><div class="ttdeci">bool conditional() const</div><div class="ttdoc">has at least one recognized If-* header</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00569">HttpRequest.cc:569</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a0e84a414e1c5857a0d8681f0a9c13317"><div class="ttname"><a href="classHttpRequest.html#a0e84a414e1c5857a0d8681f0a9c13317">HttpRequest::range</a></div><div class="ttdeci">HttpHdrRange * range</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00143">HttpRequest.h:143</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a13f1a21e71a902ac14ab9b4ee8133276"><div class="ttname"><a href="classHttpRequest.html#a13f1a21e71a902ac14ab9b4ee8133276">HttpRequest::clientConnectionManager</a></div><div class="ttdeci">CbcPointer&lt; ConnStateData &gt; clientConnectionManager</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00230">HttpRequest.h:230</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a1f0af82ff15e9a29d15319fc3cf05a54"><div class="ttname"><a href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">HttpRequest::method</a></div><div class="ttdeci">HttpRequestMethod method</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00114">HttpRequest.h:114</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a52c61e6b8c61c28ff10381895aa114a9"><div class="ttname"><a href="classHttpRequest.html#a52c61e6b8c61c28ff10381895aa114a9">HttpRequest::multipartRangeRequest</a></div><div class="ttdeci">bool multipartRangeRequest() const</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00431">HttpRequest.cc:431</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a54b1b1d850d85e6ad33ff19febb6adc8"><div class="ttname"><a href="classHttpRequest.html#a54b1b1d850d85e6ad33ff19febb6adc8">HttpRequest::pack</a></div><div class="ttdeci">void pack(Packable *p, bool maskSensitiveInfo=false) const</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00343">HttpRequest.cc:343</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a5c031f584be4a77277cccd49b0d4cea1"><div class="ttname"><a href="classHttpRequest.html#a5c031f584be4a77277cccd49b0d4cea1">HttpRequest::hier</a></div><div class="ttdeci">HierarchyLogEntry hier</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00157">HttpRequest.h:157</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a5f8f335cf16fa13580238d91973bc566"><div class="ttname"><a href="classHttpRequest.html#a5f8f335cf16fa13580238d91973bc566">HttpRequest::ims</a></div><div class="ttdeci">time_t ims</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00145">HttpRequest.h:145</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a6617b5b1e4c90874af16ac68e0f8673c"><div class="ttname"><a href="classHttpRequest.html#a6617b5b1e4c90874af16ac68e0f8673c">HttpRequest::imslen</a></div><div class="ttdeci">int imslen</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00147">HttpRequest.h:147</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a6d8609b78e8754ea45fb490b626edbae"><div class="ttname"><a href="classHttpRequest.html#a6d8609b78e8754ea45fb490b626edbae">HttpRequest::lastmod</a></div><div class="ttdeci">time_t lastmod</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00165">HttpRequest.h:165</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a76422841293a4230a1a76479e6964c04"><div class="ttname"><a href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">HttpRequest::flags</a></div><div class="ttdeci">RequestFlags flags</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00141">HttpRequest.h:141</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a8b90084ccd19905f1fc8eebc9ff3a60e"><div class="ttname"><a href="classHttpRequest.html#a8b90084ccd19905f1fc8eebc9ff3a60e">HttpRequest::vary_headers</a></div><div class="ttdeci">SBuf vary_headers</div><div class="ttdoc">The variant second-stage cache key. Generated from Vary header pattern for this request.</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00168">HttpRequest.h:168</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a8d2f98f255f306098e85800afa26eb68"><div class="ttname"><a href="classHttpRequest.html#a8d2f98f255f306098e85800afa26eb68">HttpRequest::etag</a></div><div class="ttdeci">String etag</div><div class="ttdoc">A strong etag of the cached entry. Used for refreshing that entry.</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00189">HttpRequest.h:189</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a98624db05b1d0e020b1178042857038b"><div class="ttname"><a href="classHttpRequest.html#a98624db05b1d0e020b1178042857038b">HttpRequest::pinnedConnection</a></div><div class="ttdeci">ConnStateData * pinnedConnection()</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00722">HttpRequest.cc:722</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a9d63ea3655ec440fedf74c3eb2ea99e9"><div class="ttname"><a href="classHttpRequest.html#a9d63ea3655ec440fedf74c3eb2ea99e9">HttpRequest::ignoreRange</a></div><div class="ttdeci">void ignoreRange(const char *reason)</div><div class="ttdoc">forgets about the cached Range header (for a reason)</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00618">HttpRequest.cc:618</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_aa9ddcc721a56c9e60b16639d4fdec94d"><div class="ttname"><a href="classHttpRequest.html#aa9ddcc721a56c9e60b16639d4fdec94d">HttpRequest::peer_login</a></div><div class="ttdeci">char * peer_login</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00163">HttpRequest.h:163</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_aaac8481b254d6cee121c75ae3e71ce8b"><div class="ttname"><a href="classHttpRequest.html#aaac8481b254d6cee121c75ae3e71ce8b">HttpRequest::storeId</a></div><div class="ttdeci">const SBuf storeId()</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00730">HttpRequest.cc:730</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_ac498f2030321d6bc845b115a5cabc6d1"><div class="ttname"><a href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">HttpRequest::auth_user_request</a></div><div class="ttdeci">Auth::UserRequest::Pointer auth_user_request</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00127">HttpRequest.h:127</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_af191362e7cf9b99f7f15dd20a0076e89"><div class="ttname"><a href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">HttpRequest::url</a></div><div class="ttdeci">AnyP::Uri url</div><div class="ttdoc">the request URI</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00115">HttpRequest.h:115</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_afc7b4dd61a4232033c8b06826f02ae29"><div class="ttname"><a href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">HttpRequest::effectiveRequestUri</a></div><div class="ttdeci">const SBuf &amp; effectiveRequestUri() const</div><div class="ttdoc">RFC 7230 section 5.5 - Effective Request URI.</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00741">HttpRequest.cc:741</a></div></div>
<div class="ttc" id="aclassHttp_1_1Message_html_a321ae82a5f96da7438f3054d38c8fe5c"><div class="ttname"><a href="classHttp_1_1Message.html#a321ae82a5f96da7438f3054d38c8fe5c">Http::Message::persistent</a></div><div class="ttdeci">bool persistent() const</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8cc_source.html#l00236">Message.cc:236</a></div></div>
<div class="ttc" id="aclassHttp_1_1Message_html_a79ae935ff618211b139dcfdd8a5277ec"><div class="ttname"><a href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">Http::Message::header</a></div><div class="ttdeci">HttpHeader header</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00074">Message.h:74</a></div></div>
<div class="ttc" id="aclassHttp_1_1Message_html_a7d9970e0240d7981206d051db1719d93"><div class="ttname"><a href="classHttp_1_1Message.html#a7d9970e0240d7981206d051db1719d93">Http::Message::hdr_sz</a></div><div class="ttdeci">int hdr_sz</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00081">Message.h:81</a></div></div>
<div class="ttc" id="aclassHttp_1_1Message_html_aa6074e26e4827d7a52e5ae9500c10500"><div class="ttname"><a href="classHttp_1_1Message.html#aa6074e26e4827d7a52e5ae9500c10500">Http::Message::content_length</a></div><div class="ttdeci">int64_t content_length</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00083">Message.h:83</a></div></div>
<div class="ttc" id="aclassHttp_1_1Message_html_afcb0c1d278e61a1379032790c427788d"><div class="ttname"><a href="classHttp_1_1Message.html#afcb0c1d278e61a1379032790c427788d">Http::Message::http_ver</a></div><div class="ttdeci">AnyP::ProtocolVersion http_ver</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00072">Message.h:72</a></div></div>
<div class="ttc" id="aclassHttp_1_1StatusLine_html_a96ad58b7ae7051e95f4cc75a00942efe"><div class="ttname"><a href="classHttp_1_1StatusLine.html#a96ad58b7ae7051e95f4cc75a00942efe">Http::StatusLine::version</a></div><div class="ttdeci">AnyP::ProtocolVersion version</div><div class="ttdoc">breakdown of protocol version label: (HTTP/ICY) and (0.9/1.0/1.1)</div><div class="ttdef"><b>Definition</b> <a href="StatusLine_8h_source.html#l00065">StatusLine.h:65</a></div></div>
<div class="ttc" id="aclassHttp_1_1StatusLine_html_af852e58bb3e96bc41cd16787b0a7d7db"><div class="ttname"><a href="classHttp_1_1StatusLine.html#af852e58bb3e96bc41cd16787b0a7d7db">Http::StatusLine::status</a></div><div class="ttdeci">Http::StatusCode status() const</div><div class="ttdoc">retrieve the status code for this status line</div><div class="ttdef"><b>Definition</b> <a href="StatusLine_8h_source.html#l00045">StatusLine.h:45</a></div></div>
<div class="ttc" id="aclassIp_1_1Address_html_a6d11815f11cf7d7a0582ed800282f949"><div class="ttname"><a href="classIp_1_1Address.html#a6d11815f11cf7d7a0582ed800282f949">Ip::Address::NoAddr</a></div><div class="ttdeci">static const Address &amp; NoAddr()</div><div class="ttdef"><b>Definition</b> <a href="ip_2Address_8h_source.html#l00321">Address.h:321</a></div></div>
<div class="ttc" id="aclassLogTagsErrors_html_a75b3c957f97ab0a61a830a3e1eab6f06"><div class="ttname"><a href="classLogTagsErrors.html#a75b3c957f97ab0a61a830a3e1eab6f06">LogTagsErrors::ignored</a></div><div class="ttdeci">bool ignored</div><div class="ttdoc">_IGNORED: the response was not used for anything</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00027">LogTags.h:27</a></div></div>
<div class="ttc" id="aclassLogTags_html"><div class="ttname"><a href="classLogTags.html">LogTags</a></div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00069">LogTags.h:70</a></div></div>
<div class="ttc" id="aclassLogTags_html_a1f2b07a97f2fafe2d309e37595724aab"><div class="ttname"><a href="classLogTags.html#a1f2b07a97f2fafe2d309e37595724aab">LogTags::c_str</a></div><div class="ttdeci">const char * c_str() const</div><div class="ttdoc">compute the status access.log field</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8cc_source.html#l00075">LogTags.cc:75</a></div></div>
<div class="ttc" id="aclassLogTags_html_a2363f5b3f984b76de77f6d8bf5ffbaf9"><div class="ttname"><a href="classLogTags.html#a2363f5b3f984b76de77f6d8bf5ffbaf9">LogTags::cacheStatusSource</a></div><div class="ttdeci">const char * cacheStatusSource() const</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8cc_source.html#l00124">LogTags.cc:124</a></div></div>
<div class="ttc" id="aclassLogTags_html_a2890013ea431605b918d0d24fd865af8"><div class="ttname"><a href="classLogTags.html#a2890013ea431605b918d0d24fd865af8">LogTags::err</a></div><div class="ttdeci">LogTagsErrors err</div><div class="ttdoc">various problems augmenting the primary log tag</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00087">LogTags.h:87</a></div></div>
<div class="ttc" id="aclassLogTags_html_abed628637be6b214d7860ed402927259"><div class="ttname"><a href="classLogTags.html#abed628637be6b214d7860ed402927259">LogTags::oldType</a></div><div class="ttdeci">LogTags_ot oldType</div><div class="ttdoc">a set of client protocol, cache use, and other transaction outcome tags</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00096">LogTags.h:96</a></div></div>
<div class="ttc" id="aclassLogTags_html_aea1194c638b43a3273a8280cee485215"><div class="ttname"><a href="classLogTags.html#aea1194c638b43a3273a8280cee485215">LogTags::isTcpHit</a></div><div class="ttdeci">bool isTcpHit() const</div><div class="ttdoc">determine if the log tag code indicates a cache HIT</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8cc_source.html#l00110">LogTags.cc:110</a></div></div>
<div class="ttc" id="aclassMasterXaction_html_af3cb33c92de57dbb4f9b5a0bf5488ad4"><div class="ttname"><a href="classMasterXaction.html#af3cb33c92de57dbb4f9b5a0bf5488ad4">MasterXaction::MakePortful</a></div><div class="ttdeci">static Pointer MakePortful(const AnyP::PortCfgPointer &amp;aPort)</div><div class="ttdef"><b>Definition</b> <a href="MasterXaction_8h_source.html#l00054">MasterXaction.h:54</a></div></div>
<div class="ttc" id="aclassMemBuf_html"><div class="ttname"><a href="classMemBuf.html">MemBuf</a></div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8h_source.html#l00023">MemBuf.h:24</a></div></div>
<div class="ttc" id="aclassMemBuf_html_a4a615d8e887439c66e04aab70f8be60a"><div class="ttname"><a href="classMemBuf.html#a4a615d8e887439c66e04aab70f8be60a">MemBuf::init</a></div><div class="ttdeci">void init(mb_size_t szInit, mb_size_t szMax)</div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8cc_source.html#l00093">MemBuf.cc:93</a></div></div>
<div class="ttc" id="aclassMemBuf_html_a512e0e6f4a6b327f31c9db28fe9aaeb3"><div class="ttname"><a href="classMemBuf.html#a512e0e6f4a6b327f31c9db28fe9aaeb3">MemBuf::size</a></div><div class="ttdeci">mb_size_t size</div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8h_source.html#l00135">MemBuf.h:135</a></div></div>
<div class="ttc" id="aclassMemBuf_html_a78daaa064a5aa4557e283a01c4aa27f1"><div class="ttname"><a href="classMemBuf.html#a78daaa064a5aa4557e283a01c4aa27f1">MemBuf::buf</a></div><div class="ttdeci">char * buf</div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8h_source.html#l00134">MemBuf.h:134</a></div></div>
<div class="ttc" id="aclassMemBuf_html_aaaf0cc30487417b07680613bcf518dca"><div class="ttname"><a href="classMemBuf.html#aaaf0cc30487417b07680613bcf518dca">MemBuf::contentSize</a></div><div class="ttdeci">mb_size_t contentSize() const</div><div class="ttdoc">available data size</div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8h_source.html#l00047">MemBuf.h:47</a></div></div>
<div class="ttc" id="aclassMemObject_html"><div class="ttname"><a href="classMemObject.html">MemObject</a></div><div class="ttdef"><b>Definition</b> <a href="MemObject_8h_source.html#l00033">MemObject.h:34</a></div></div>
<div class="ttc" id="aclassMemObject_html_a89697947bc40cdbe591b9e26951b59ba"><div class="ttname"><a href="classMemObject.html#a89697947bc40cdbe591b9e26951b59ba">MemObject::freshestReply</a></div><div class="ttdeci">const HttpReply &amp; freshestReply() const</div><div class="ttdef"><b>Definition</b> <a href="MemObject_8h_source.html#l00068">MemObject.h:68</a></div></div>
<div class="ttc" id="aclassMemObject_html_acf39fcf694480bb79ff0ace66f9f791e"><div class="ttname"><a href="classMemObject.html#acf39fcf694480bb79ff0ace66f9f791e">MemObject::storeId</a></div><div class="ttdeci">const char * storeId() const</div><div class="ttdef"><b>Definition</b> <a href="MemObject_8cc_source.html#l00053">MemObject.cc:53</a></div></div>
<div class="ttc" id="aclassMemObject_html_ad5355b4679045222e5ea75b0c36f16c4"><div class="ttname"><a href="classMemObject.html#ad5355b4679045222e5ea75b0c36f16c4">MemObject::baseReply</a></div><div class="ttdeci">const HttpReply &amp; baseReply() const</div><div class="ttdef"><b>Definition</b> <a href="MemObject_8h_source.html#l00060">MemObject.h:60</a></div></div>
<div class="ttc" id="aclassRefCount_html"><div class="ttname"><a href="classRefCount.html">RefCount&lt; AccessLogEntry &gt;</a></div></div>
<div class="ttc" id="aclassRefCount_html_a9f2168c1df4a4ab6b7931425d85c37f0"><div class="ttname"><a href="classRefCount.html#a9f2168c1df4a4ab6b7931425d85c37f0">RefCount::getRaw</a></div><div class="ttdeci">C * getRaw() const</div><div class="ttdef"><b>Definition</b> <a href="RefCount_8h_source.html#l00089">RefCount.h:89</a></div></div>
<div class="ttc" id="aclassRequestFlags_html"><div class="ttname"><a href="classRequestFlags.html">RequestFlags</a></div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00022">RequestFlags.h:23</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a0247d4ae2646e09402e31bc09c7ff4c6"><div class="ttname"><a href="classRequestFlags.html#a0247d4ae2646e09402e31bc09c7ff4c6">RequestFlags::needValidation</a></div><div class="ttdeci">bool needValidation</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00050">RequestFlags.h:50</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a0e7db730c27abb7eac3b676961773797"><div class="ttname"><a href="classRequestFlags.html#a0e7db730c27abb7eac3b676961773797">RequestFlags::accelerated</a></div><div class="ttdeci">bool accelerated</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00062">RequestFlags.h:62</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a12193c977b3da18c04e6e4b350e860ba"><div class="ttname"><a href="classRequestFlags.html#a12193c977b3da18c04e6e4b350e860ba">RequestFlags::ims</a></div><div class="ttdeci">bool ims</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00028">RequestFlags.h:28</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a1cb8c962b36f5ebd3f897fede719dd43"><div class="ttname"><a href="classRequestFlags.html#a1cb8c962b36f5ebd3f897fede719dd43">RequestFlags::connectionAuth</a></div><div class="ttdeci">bool connectionAuth</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00085">RequestFlags.h:85</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a1e3c53bb0466b666037f1db1fc3dd00b"><div class="ttname"><a href="classRequestFlags.html#a1e3c53bb0466b666037f1db1fc3dd00b">RequestFlags::chunkedReply</a></div><div class="ttdeci">bool chunkedReply</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00099">RequestFlags.h:99</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a26c4900e600bc57c506766fcbdf3c0e3"><div class="ttname"><a href="classRequestFlags.html#a26c4900e600bc57c506766fcbdf3c0e3">RequestFlags::internal</a></div><div class="ttdeci">bool internal</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00080">RequestFlags.h:80</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a3785f87b7c9fa79980250415c0ba7b5a"><div class="ttname"><a href="classRequestFlags.html#a3785f87b7c9fa79980250415c0ba7b5a">RequestFlags::noCacheHack</a></div><div class="ttdeci">bool noCacheHack() const</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00133">RequestFlags.h:133</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a452db2a617d946222557c73d97888918"><div class="ttname"><a href="classRequestFlags.html#a452db2a617d946222557c73d97888918">RequestFlags::noCache</a></div><div class="ttdeci">bool noCache</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00026">RequestFlags.h:26</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a4cb0ee94750e6ed9434b5924fb7804a6"><div class="ttname"><a href="classRequestFlags.html#a4cb0ee94750e6ed9434b5924fb7804a6">RequestFlags::staleIfHit</a></div><div class="ttdeci">bool staleIfHit</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00054">RequestFlags.h:54</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a68b0261603b2ce9f9151a053562527f4"><div class="ttname"><a href="classRequestFlags.html#a68b0261603b2ce9f9151a053562527f4">RequestFlags::mustKeepalive</a></div><div class="ttdeci">bool mustKeepalive</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00083">RequestFlags.h:83</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a7a91240cae5dac8e6819f84b31c923dc"><div class="ttname"><a href="classRequestFlags.html#a7a91240cae5dac8e6819f84b31c923dc">RequestFlags::streamError</a></div><div class="ttdeci">bool streamError</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00101">RequestFlags.h:101</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a7feb14e42e2a35fb38fb744e98b8af7b"><div class="ttname"><a href="classRequestFlags.html#a7feb14e42e2a35fb38fb744e98b8af7b">RequestFlags::intercepted</a></div><div class="ttdeci">bool intercepted</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00066">RequestFlags.h:66</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a8014770f9112fe68a085fc4ecec68680"><div class="ttname"><a href="classRequestFlags.html#a8014770f9112fe68a085fc4ecec68680">RequestFlags::proxyKeepalive</a></div><div class="ttdeci">bool proxyKeepalive</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00042">RequestFlags.h:42</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a8afa0524d088b358dfaaa9950638aa1f"><div class="ttname"><a href="classRequestFlags.html#a8afa0524d088b358dfaaa9950638aa1f">RequestFlags::failOnValidationError</a></div><div class="ttdeci">bool failOnValidationError</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00052">RequestFlags.h:52</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a8f900e1c576cb7ea9b979d7001540025"><div class="ttname"><a href="classRequestFlags.html#a8f900e1c576cb7ea9b979d7001540025">RequestFlags::refresh</a></div><div class="ttdeci">bool refresh</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00044">RequestFlags.h:44</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_abbde600374891ccc540eea4812414b69"><div class="ttname"><a href="classRequestFlags.html#abbde600374891ccc540eea4812414b69">RequestFlags::sslBumped</a></div><div class="ttdeci">bool sslBumped</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00110">RequestFlags.h:110</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_ace4ab3e57a3fa9e3197ce200ecdf653a"><div class="ttname"><a href="classRequestFlags.html#ace4ab3e57a3fa9e3197ce200ecdf653a">RequestFlags::loopDetected</a></div><div class="ttdeci">bool loopDetected</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00040">RequestFlags.h:40</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_ad71e99859e4130efc5ef12af8aaefe98"><div class="ttname"><a href="classRequestFlags.html#ad71e99859e4130efc5ef12af8aaefe98">RequestFlags::connectionAuthDisabled</a></div><div class="ttdeci">bool connectionAuthDisabled</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00087">RequestFlags.h:87</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_af33cb0e80d9996c532479ef942d1eb91"><div class="ttname"><a href="classRequestFlags.html#af33cb0e80d9996c532479ef942d1eb91">RequestFlags::cachable</a></div><div class="ttdeci">SupportOrVeto cachable</div><div class="ttdoc">whether the response may be stored in the cache</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00035">RequestFlags.h:35</a></div></div>
<div class="ttc" id="aclassSBuf_html"><div class="ttname"><a href="classSBuf.html">SBuf</a></div><div class="ttdef"><b>Definition</b> <a href="SBuf_8h_source.html#l00093">SBuf.h:94</a></div></div>
<div class="ttc" id="aclassSBuf_html_a1db91b2f039b38745f7d73b56ac9311f"><div class="ttname"><a href="classSBuf.html#a1db91b2f039b38745f7d73b56ac9311f">SBuf::npos</a></div><div class="ttdeci">static const size_type npos</div><div class="ttdef"><b>Definition</b> <a href="SBuf_8h_source.html#l00100">SBuf.h:100</a></div></div>
<div class="ttc" id="aclassSBuf_html_a2a7fda503e54cb36b023dcaaab633f65"><div class="ttname"><a href="classSBuf.html#a2a7fda503e54cb36b023dcaaab633f65">SBuf::c_str</a></div><div class="ttdeci">const char * c_str()</div><div class="ttdef"><b>Definition</b> <a href="SBuf_8cc_source.html#l00516">SBuf.cc:516</a></div></div>
<div class="ttc" id="aclassSBuf_html_a5ec49865cc982a78e48245f546a38ea4"><div class="ttname"><a href="classSBuf.html#a5ec49865cc982a78e48245f546a38ea4">SBuf::cmp</a></div><div class="ttdeci">int cmp(const SBuf &amp;S, const size_type n) const</div><div class="ttdoc">shorthand version for compare()</div><div class="ttdef"><b>Definition</b> <a href="SBuf_8h_source.html#l00279">SBuf.h:279</a></div></div>
<div class="ttc" id="aclassSBuf_html_a7baba649622f53390f267b15d65052be"><div class="ttname"><a href="classSBuf.html#a7baba649622f53390f267b15d65052be">SBuf::find</a></div><div class="ttdeci">size_type find(char c, size_type startPos=0) const</div><div class="ttdef"><b>Definition</b> <a href="SBuf_8cc_source.html#l00584">SBuf.cc:584</a></div></div>
<div class="ttc" id="aclassSBuf_html_a8bda8fe69e451e61946b35c2a2d2340b"><div class="ttname"><a href="classSBuf.html#a8bda8fe69e451e61946b35c2a2d2340b">SBuf::isEmpty</a></div><div class="ttdeci">bool isEmpty() const</div><div class="ttdef"><b>Definition</b> <a href="SBuf_8h_source.html#l00435">SBuf.h:435</a></div></div>
<div class="ttc" id="aclassSBuf_html_aa12ede16b167c60722946fc8fe9292da"><div class="ttname"><a href="classSBuf.html#aa12ede16b167c60722946fc8fe9292da">SBuf::append</a></div><div class="ttdeci">SBuf &amp; append(const SBuf &amp;S)</div><div class="ttdef"><b>Definition</b> <a href="SBuf_8cc_source.html#l00185">SBuf.cc:185</a></div></div>
<div class="ttc" id="aclassServer_html_a58c3313bde9ea0c6e23f047d203187dc"><div class="ttname"><a href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">Server::clientConnection</a></div><div class="ttdeci">Comm::ConnectionPointer clientConnection</div><div class="ttdef"><b>Definition</b> <a href="Server_8h_source.html#l00100">Server.h:100</a></div></div>
<div class="ttc" id="aclassSquidConfig2_html_a0b005dab9003e750f2244117a1896623"><div class="ttname"><a href="classSquidConfig2.html#a0b005dab9003e750f2244117a1896623">SquidConfig2::enable_purge</a></div><div class="ttdeci">int enable_purge</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00562">SquidConfig.h:562</a></div></div>
<div class="ttc" id="aclassSquidConfig2_html_a71811e08ee22e6566509b77f361fc571"><div class="ttname"><a href="classSquidConfig2.html#a71811e08ee22e6566509b77f361fc571">SquidConfig2::onoff</a></div><div class="ttdeci">struct SquidConfig2::@102 onoff</div></div>
<div class="ttc" id="aclassSquidConfig_html_a2988594ba4cfaec3d374bdb724f73999"><div class="ttname"><a href="classSquidConfig.html#a2988594ba4cfaec3d374bdb724f73999">SquidConfig::error_pconns</a></div><div class="ttdeci">int error_pconns</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00306">SquidConfig.h:306</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a49a06ee4587216a830b30d56b4a37d43"><div class="ttname"><a href="classSquidConfig.html#a49a06ee4587216a830b30d56b4a37d43">SquidConfig::reply</a></div><div class="ttdeci">acl_access * reply</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00379">SquidConfig.h:379</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a89bec7bc02d66eb2ab65c74c3f6b13ac"><div class="ttname"><a href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">SquidConfig::onoff</a></div><div class="ttdeci">struct SquidConfig::@90 onoff</div></div>
<div class="ttc" id="aclassSquidConfig_html_a94f4d58b36060eb76c6d6ca9eda4c755"><div class="ttname"><a href="classSquidConfig.html#a94f4d58b36060eb76c6d6ca9eda4c755">SquidConfig::offline</a></div><div class="ttdeci">int offline</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00296">SquidConfig.h:296</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a9bf3ec2cc0f359bb6a92422b46e89eae"><div class="ttname"><a href="classSquidConfig.html#a9bf3ec2cc0f359bb6a92422b46e89eae">SquidConfig::client_pconns</a></div><div class="ttdeci">int client_pconns</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00304">SquidConfig.h:304</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a9d226871b43c9f7f1415a121e2c87257"><div class="ttname"><a href="classSquidConfig.html#a9d226871b43c9f7f1415a121e2c87257">SquidConfig::collapsed_forwarding</a></div><div class="ttdeci">int collapsed_forwarding</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00323">SquidConfig.h:323</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_ac58776fd75b996c42d22bdd69c17d31f"><div class="ttname"><a href="classSquidConfig.html#ac58776fd75b996c42d22bdd69c17d31f">SquidConfig::sendHit</a></div><div class="ttdeci">acl_access * sendHit</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00367">SquidConfig.h:367</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_ac7f1138fffbdda4a9a888100e3187691"><div class="ttname"><a href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">SquidConfig::accessList</a></div><div class="ttdeci">struct SquidConfig::@91 accessList</div></div>
<div class="ttc" id="aclassStoreClient_html_a2eb1d9b74bda05ccf875d98aab7e276f"><div class="ttname"><a href="classStoreClient.html#a2eb1d9b74bda05ccf875d98aab7e276f">StoreClient::didCollapse</a></div><div class="ttdeci">bool didCollapse</div><div class="ttdoc">whether startCollapsingOn() was called and returned true</div><div class="ttdef"><b>Definition</b> <a href="StoreClient_8h_source.html#l00064">StoreClient.h:64</a></div></div>
<div class="ttc" id="aclassStoreClient_html_a97f3b428b24aefc0bd350d6b060bb8e0"><div class="ttname"><a href="classStoreClient.html#a97f3b428b24aefc0bd350d6b060bb8e0">StoreClient::mayInitiateCollapsing</a></div><div class="ttdeci">bool mayInitiateCollapsing() const</div><div class="ttdoc">whether Squid configuration allows us to become a CF initiator</div><div class="ttdef"><b>Definition</b> <a href="StoreClient_8h_source.html#l00059">StoreClient.h:59</a></div></div>
<div class="ttc" id="aclassStoreClient_html_abb28f481b15a234bd176db48eba5bac9"><div class="ttname"><a href="classStoreClient.html#abb28f481b15a234bd176db48eba5bac9">StoreClient::startCollapsingOn</a></div><div class="ttdeci">bool startCollapsingOn(const StoreEntry &amp;, const bool doingRevalidation) const</div><div class="ttdef"><b>Definition</b> <a href="store__client_8cc_source.html#l00066">store_client.cc:66</a></div></div>
<div class="ttc" id="aclassStoreEntry_html"><div class="ttname"><a href="classStoreEntry.html">StoreEntry</a></div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00037">Store.h:38</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a028aa7eef91cf47c704d42ab5ab58a42"><div class="ttname"><a href="classStoreEntry.html#a028aa7eef91cf47c704d42ab5ab58a42">StoreEntry::completeSuccessfully</a></div><div class="ttdeci">void completeSuccessfully(const char *whyWeAreSureWeStoredTheWholeReply)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01017">store.cc:1017</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a0745b88b04fa7c99bd4cf6284967f591"><div class="ttname"><a href="classStoreEntry.html#a0745b88b04fa7c99bd4cf6284967f591">StoreEntry::mem_status</a></div><div class="ttdeci">mem_status_t mem_status</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00239">Store.h:239</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a15b61bc1167a3670130a81bc5eca9f16"><div class="ttname"><a href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">StoreEntry::flags</a></div><div class="ttdeci">uint16_t flags</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00231">Store.h:231</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a19fd5af89e99c467c29f7bd951ac901d"><div class="ttname"><a href="classStoreEntry.html#a19fd5af89e99c467c29f7bd951ac901d">StoreEntry::mem</a></div><div class="ttdeci">MemObject &amp; mem()</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00047">Store.h:47</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a1c68aa08115a04dec516f91cae276f08"><div class="ttname"><a href="classStoreEntry.html#a1c68aa08115a04dec516f91cae276f08">StoreEntry::hasIfMatchEtag</a></div><div class="ttdeci">bool hasIfMatchEtag(const HttpRequest &amp;request) const</div><div class="ttdoc">has ETag matching at least one of the If-Match etags</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01873">store.cc:1873</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a249ad3e6bfa297da0fa7a0e9accf6002"><div class="ttname"><a href="classStoreEntry.html#a249ad3e6bfa297da0fa7a0e9accf6002">StoreEntry::ensureMemObject</a></div><div class="ttdeci">void ensureMemObject(const char *storeId, const char *logUri, const HttpRequestMethod &amp;aMethod)</div><div class="ttdoc">initialize mem_obj (if needed) and set URIs/method (if missing)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01589">store.cc:1589</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a29fe3b09ae97a5337dc29c741d90cfe2"><div class="ttname"><a href="classStoreEntry.html#a29fe3b09ae97a5337dc29c741d90cfe2">StoreEntry::hasIfNoneMatchEtag</a></div><div class="ttdeci">bool hasIfNoneMatchEtag(const HttpRequest &amp;request) const</div><div class="ttdoc">has ETag matching at least one of the If-None-Match etags</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01880">store.cc:1880</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a2d3a77bc0c8dad6b7b9084aaf6998251"><div class="ttname"><a href="classStoreEntry.html#a2d3a77bc0c8dad6b7b9084aaf6998251">StoreEntry::dump</a></div><div class="ttdeci">void dump(int debug_lvl) const</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01499">store.cc:1499</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a35618603cff249c1cc64abf8127f3b7d"><div class="ttname"><a href="classStoreEntry.html#a35618603cff249c1cc64abf8127f3b7d">StoreEntry::unlock</a></div><div class="ttdeci">int unlock(const char *context)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00469">store.cc:469</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a3835284a1cb3623987d557c9754e5ffc"><div class="ttname"><a href="classStoreEntry.html#a3835284a1cb3623987d557c9754e5ffc">StoreEntry::url</a></div><div class="ttdeci">const char * url() const</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01566">store.cc:1566</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a3ae4c0876a20686e558e7183b67805f4"><div class="ttname"><a href="classStoreEntry.html#a3ae4c0876a20686e558e7183b67805f4">StoreEntry::complete</a></div><div class="ttdeci">void complete()</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01031">store.cc:1031</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a42dc938e1e2a49b3d4275eabeb8eb699"><div class="ttname"><a href="classStoreEntry.html#a42dc938e1e2a49b3d4275eabeb8eb699">StoreEntry::expires</a></div><div class="ttdeci">time_t expires</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00225">Store.h:225</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a44ee484ceff3f6e9e92ab7e80ede26ab"><div class="ttname"><a href="classStoreEntry.html#a44ee484ceff3f6e9e92ab7e80ede26ab">StoreEntry::hasEtag</a></div><div class="ttdeci">bool hasEtag(ETag &amp;etag) const</div><div class="ttdoc">whether this entry has an ETag; if yes, puts ETag value into parameter</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01862">store.cc:1862</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a4550da0757f7c3aa6af8e8e9c3bcdb48"><div class="ttname"><a href="classStoreEntry.html#a4550da0757f7c3aa6af8e8e9c3bcdb48">StoreEntry::lastModified</a></div><div class="ttdeci">void lastModified(const time_t when)</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00175">Store.h:175</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a463a7aa5404ee7401d27ebc0caeaf1fe"><div class="ttname"><a href="classStoreEntry.html#a463a7aa5404ee7401d27ebc0caeaf1fe">StoreEntry::release</a></div><div class="ttdeci">void release(const bool shareable=false)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01146">store.cc:1146</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a4e4ae536cc1051c029641e75c5815cfd"><div class="ttname"><a href="classStoreEntry.html#a4e4ae536cc1051c029641e75c5815cfd">StoreEntry::hasParsedReplyHeader</a></div><div class="ttdeci">bool hasParsedReplyHeader() const</div><div class="ttdoc">whether this entry has access to [deserialized] [HTTP] response headers</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00231">store.cc:231</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a53a607cfbdb22fde40edd2c72bfb6dd3"><div class="ttname"><a href="classStoreEntry.html#a53a607cfbdb22fde40edd2c72bfb6dd3">StoreEntry::lock</a></div><div class="ttdeci">void lock(const char *context)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00445">store.cc:445</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a5880b874fdaa8aa76b21a5fedd609ca0"><div class="ttname"><a href="classStoreEntry.html#a5880b874fdaa8aa76b21a5fedd609ca0">StoreEntry::timestamp</a></div><div class="ttdeci">time_t timestamp</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00223">Store.h:223</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a5bc295d1b8532fe259f903a6e9128d66"><div class="ttname"><a href="classStoreEntry.html#a5bc295d1b8532fe259f903a6e9128d66">StoreEntry::timestampsSet</a></div><div class="ttdeci">bool timestampsSet()</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01387">store.cc:1387</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a5e2c3f8253b4deebad7a5586c16a4df0"><div class="ttname"><a href="classStoreEntry.html#a5e2c3f8253b4deebad7a5586c16a4df0">StoreEntry::clearPublicKeyScope</a></div><div class="ttdeci">void clearPublicKeyScope()</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00609">store.cc:609</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a84c7380e766ff75a4275c2778df8f068"><div class="ttname"><a href="classStoreEntry.html#a84c7380e766ff75a4275c2778df8f068">StoreEntry::storeErrorResponse</a></div><div class="ttdeci">void storeErrorResponse(HttpReply *reply)</div><div class="ttdoc">Store a prepared error response. MemObject locks the reply object.</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01688">store.cc:1688</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a851512bf2d39ef1f9564421c26ce290f"><div class="ttname"><a href="classStoreEntry.html#a851512bf2d39ef1f9564421c26ce290f">StoreEntry::mayStartHitting</a></div><div class="ttdeci">bool mayStartHitting() const</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00284">Store.h:284</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a9ff95b8b536905e70ee2b7c5a1972901"><div class="ttname"><a href="classStoreEntry.html#a9ff95b8b536905e70ee2b7c5a1972901">StoreEntry::checkNegativeHit</a></div><div class="ttdeci">int checkNegativeHit() const</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01300">store.cc:1300</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_aae28c5e9a323d60ac8fe8ce98f6eb7c5"><div class="ttname"><a href="classStoreEntry.html#aae28c5e9a323d60ac8fe8ce98f6eb7c5">StoreEntry::replaceHttpReply</a></div><div class="ttdeci">void replaceHttpReply(const HttpReplyPointer &amp;, const bool andStartWriting=true)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01705">store.cc:1705</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_ab79c9d3fba14d5c997bae61161d9992f"><div class="ttname"><a href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">StoreEntry::mem_obj</a></div><div class="ttdeci">MemObject * mem_obj</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00220">Store.h:220</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_ac7b0d2255cb46a1be80dd95ea4230543"><div class="ttname"><a href="classStoreEntry.html#ac7b0d2255cb46a1be80dd95ea4230543">StoreEntry::modifiedSince</a></div><div class="ttdeci">bool modifiedSince(const time_t ims, const int imslen=-1) const</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01836">store.cc:1836</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_ad52e359c5dad8a74f7b28168f37f64fc"><div class="ttname"><a href="classStoreEntry.html#ad52e359c5dad8a74f7b28168f37f64fc">StoreEntry::objectLen</a></div><div class="ttdeci">int64_t objectLen() const</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00253">Store.h:253</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_adb1aad18212d6a162cfb59b3f23b5cf4"><div class="ttname"><a href="classStoreEntry.html#adb1aad18212d6a162cfb59b3f23b5cf4">StoreEntry::store_status</a></div><div class="ttdeci">store_status_t store_status</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00243">Store.h:243</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_adbe63b6b215b04af68e9290dbfb7b45a"><div class="ttname"><a href="classStoreEntry.html#adbe63b6b215b04af68e9290dbfb7b45a">StoreEntry::buffer</a></div><div class="ttdeci">void buffer() override</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01601">store.cc:1601</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_addfd77d9dd303940e6f323d714da2e89"><div class="ttname"><a href="classStoreEntry.html#addfd77d9dd303940e6f323d714da2e89">StoreEntry::releaseRequest</a></div><div class="ttdeci">void releaseRequest(const bool shareable=false)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00458">store.cc:458</a></div></div>
<div class="ttc" id="aclassStoreIOBuffer_html"><div class="ttname"><a href="classStoreIOBuffer.html">StoreIOBuffer</a></div><div class="ttdef"><b>Definition</b> <a href="StoreIOBuffer_8h_source.html#l00015">StoreIOBuffer.h:16</a></div></div>
<div class="ttc" id="aclassStoreIOBuffer_html_a08224ebb5a73aa6b18c0e7a60ebf00b5"><div class="ttname"><a href="classStoreIOBuffer.html#a08224ebb5a73aa6b18c0e7a60ebf00b5">StoreIOBuffer::data</a></div><div class="ttdeci">char * data</div><div class="ttdef"><b>Definition</b> <a href="StoreIOBuffer_8h_source.html#l00059">StoreIOBuffer.h:59</a></div></div>
<div class="ttc" id="aclassStoreIOBuffer_html_a1e3225390c0c4999a67e22a9b503ca16"><div class="ttname"><a href="classStoreIOBuffer.html#a1e3225390c0c4999a67e22a9b503ca16">StoreIOBuffer::error</a></div><div class="ttdeci">unsigned error</div><div class="ttdef"><b>Definition</b> <a href="StoreIOBuffer_8h_source.html#l00055">StoreIOBuffer.h:55</a></div></div>
<div class="ttc" id="aclassStoreIOBuffer_html_a61c7333c49e943c24964ae030c96b5ec"><div class="ttname"><a href="classStoreIOBuffer.html#a61c7333c49e943c24964ae030c96b5ec">StoreIOBuffer::offset</a></div><div class="ttdeci">int64_t offset</div><div class="ttdef"><b>Definition</b> <a href="StoreIOBuffer_8h_source.html#l00058">StoreIOBuffer.h:58</a></div></div>
<div class="ttc" id="aclassStoreIOBuffer_html_a97772bf328fe745e1d1fc23ee91cec39"><div class="ttname"><a href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">StoreIOBuffer::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition</b> <a href="StoreIOBuffer_8h_source.html#l00057">StoreIOBuffer.h:57</a></div></div>
<div class="ttc" id="aclassStoreIOBuffer_html_acb67e9b7fb58fa7b15114bd024533f44"><div class="ttname"><a href="classStoreIOBuffer.html#acb67e9b7fb58fa7b15114bd024533f44">StoreIOBuffer::flags</a></div><div class="ttdeci">struct StoreIOBuffer::@123 flags</div></div>
<div class="ttc" id="aclassStore_1_1Controller_html_a49893add4ee497be08fd54fde817a7d9"><div class="ttname"><a href="classStore_1_1Controller.html#a49893add4ee497be08fd54fde817a7d9">Store::Controller::allowCollapsing</a></div><div class="ttdeci">bool allowCollapsing(StoreEntry *, const RequestFlags &amp;, const HttpRequestMethod &amp;)</div><div class="ttdoc">tries to make the entry available for collapsing future requests</div><div class="ttdef"><b>Definition</b> <a href="Controller_8cc_source.html#l00727">Controller.cc:727</a></div></div>
<div class="ttc" id="aclassStore_1_1Controller_html_aae85df3b0edba0369a4ba152e6132b1a"><div class="ttname"><a href="classStore_1_1Controller.html#aae85df3b0edba0369a4ba152e6132b1a">Store::Controller::SmpAware</a></div><div class="ttdeci">static bool SmpAware()</div><div class="ttdoc">whether there are any SMP-aware storages</div><div class="ttdef"><b>Definition</b> <a href="Controller_8cc_source.html#l00912">Controller.cc:912</a></div></div>
<div class="ttc" id="aclassStore_1_1Controller_html_aedba791b442f1fac585676381e262777"><div class="ttname"><a href="classStore_1_1Controller.html#aedba791b442f1fac585676381e262777">Store::Controller::evictIfFound</a></div><div class="ttdeci">void evictIfFound(const cache_key *) override</div><div class="ttdef"><b>Definition</b> <a href="Controller_8cc_source.html#l00492">Controller.cc:492</a></div></div>
<div class="ttc" id="aclassString_html_a60a0fdff84d3470d812b2adbcb2cbf38"><div class="ttname"><a href="classString.html#a60a0fdff84d3470d812b2adbcb2cbf38">String::clean</a></div><div class="ttdeci">void clean()</div><div class="ttdef"><b>Definition</b> <a href="String_8cc_source.html#l00104">String.cc:104</a></div></div>
<div class="ttc" id="aclassString_html_a77a7c8c6845f33722735772524b8034d"><div class="ttname"><a href="classString.html#a77a7c8c6845f33722735772524b8034d">String::rawBuf</a></div><div class="ttdeci">char const * rawBuf() const</div><div class="ttdef"><b>Definition</b> <a href="SquidString_8h_source.html#l00087">SquidString.h:87</a></div></div>
<div class="ttc" id="aclassString_html_aba5551ee62c6e82730c0cb1856238c14"><div class="ttname"><a href="classString.html#aba5551ee62c6e82730c0cb1856238c14">String::termedBuf</a></div><div class="ttdeci">char const * termedBuf() const</div><div class="ttdef"><b>Definition</b> <a href="SquidString_8h_source.html#l00093">SquidString.h:93</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html"><div class="ttname"><a href="classclientReplyContext.html">clientReplyContext</a></div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00022">client_side_reply.h:23</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a088b8d70ec990b3284a87a4fffe32fd7"><div class="ttname"><a href="classclientReplyContext.html#a088b8d70ec990b3284a87a4fffe32fd7">clientReplyContext::handleIMSReply</a></div><div class="ttdeci">void handleIMSReply(StoreIOBuffer result)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00407">client_side_reply.cc:407</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a0da0eb1eedbc3a7e7d7bf0b19feccd72"><div class="ttname"><a href="classclientReplyContext.html#a0da0eb1eedbc3a7e7d7bf0b19feccd72">clientReplyContext::purgeAllCached</a></div><div class="ttdeci">void purgeAllCached()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00886">client_side_reply.cc:886</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a0df8ee2233c180c19f80aabaf0bb8bd1"><div class="ttname"><a href="classclientReplyContext.html#a0df8ee2233c180c19f80aabaf0bb8bd1">clientReplyContext::ourNode</a></div><div class="ttdeci">clientStreamNode * ourNode</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00086">client_side_reply.h:86</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a0ebe2928939879f9afe8e3c8d08fd45c"><div class="ttname"><a href="classclientReplyContext.html#a0ebe2928939879f9afe8e3c8d08fd45c">clientReplyContext::sc</a></div><div class="ttdeci">store_client * sc</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00071">client_side_reply.h:71</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a0ec275cfe423205b6348b57c50fd9ca0"><div class="ttname"><a href="classclientReplyContext.html#a0ec275cfe423205b6348b57c50fd9ca0">clientReplyContext::sendNotModifiedOrPreconditionFailedError</a></div><div class="ttdeci">void sendNotModifiedOrPreconditionFailedError()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01813">client_side_reply.cc:1813</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a0f8952c0b6f0b7a451aa61a94cdd7ed9"><div class="ttname"><a href="classclientReplyContext.html#a0f8952c0b6f0b7a451aa61a94cdd7ed9">clientReplyContext::setReplyToReply</a></div><div class="ttdeci">void setReplyToReply(HttpReply *reply)</div><div class="ttdoc">creates a store entry for the reply and appends error reply to it</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00130">client_side_reply.cc:130</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a1a51e420015bfaab501ab67039ccae6c"><div class="ttname"><a href="classclientReplyContext.html#a1a51e420015bfaab501ab67039ccae6c">clientReplyContext::makeThisHead</a></div><div class="ttdeci">void makeThisHead()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01703">client_side_reply.cc:1703</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a1d93c954a015240864b04716337c731a"><div class="ttname"><a href="classclientReplyContext.html#a1d93c954a015240864b04716337c731a">clientReplyContext::ProcessReplyAccessResult</a></div><div class="ttdeci">static ACLCB ProcessReplyAccessResult</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00101">client_side_reply.h:101</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a1f6deea197aeb4c93d27457f592811cd"><div class="ttname"><a href="classclientReplyContext.html#a1f6deea197aeb4c93d27457f592811cd">clientReplyContext::alwaysAllowResponse</a></div><div class="ttdeci">bool alwaysAllowResponse(Http::StatusCode sline) const</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01188">client_side_reply.cc:1188</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a239cf51bf0b46a7ca7e8d23fab22b28f"><div class="ttname"><a href="classclientReplyContext.html#a239cf51bf0b46a7ca7e8d23fab22b28f">clientReplyContext::HandleIMSReply</a></div><div class="ttdeci">static STCB HandleIMSReply</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00028">client_side_reply.h:28</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a23ed47bc9f4ef61b40462fce26657140"><div class="ttname"><a href="classclientReplyContext.html#a23ed47bc9f4ef61b40462fce26657140">clientReplyContext::sendPreconditionFailedError</a></div><div class="ttdeci">void sendPreconditionFailedError()</div><div class="ttdoc">send 412 (Precondition Failed) to client</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01769">client_side_reply.cc:1769</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a2fbf8aa662028db5c9160873dc1e5399"><div class="ttname"><a href="classclientReplyContext.html#a2fbf8aa662028db5c9160873dc1e5399">clientReplyContext::old_sc</a></div><div class="ttdeci">store_client * old_sc</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00146">client_side_reply.h:146</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a309764bf3b36e0af99299869fdba6c24"><div class="ttname"><a href="classclientReplyContext.html#a309764bf3b36e0af99299869fdba6c24">clientReplyContext::triggerInitialStoreRead</a></div><div class="ttdeci">void triggerInitialStoreRead(STCB=SendMoreData)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00234">client_side_reply.cc:234</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a3263269246247f958667a1596f3fa50c"><div class="ttname"><a href="classclientReplyContext.html#a3263269246247f958667a1596f3fa50c">clientReplyContext::forgetHit</a></div><div class="ttdeci">void forgetHit()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01467">client_side_reply.cc:1467</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a334803088bd9af0377bdd7608b9a5876"><div class="ttname"><a href="classclientReplyContext.html#a334803088bd9af0377bdd7608b9a5876">clientReplyContext::cacheHit</a></div><div class="ttdeci">void cacheHit(StoreIOBuffer result)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00521">client_side_reply.cc:521</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a42f78e9406c59b07aeadb0d9c275d0be"><div class="ttname"><a href="classclientReplyContext.html#a42f78e9406c59b07aeadb0d9c275d0be">clientReplyContext::matchesStreamBodyBuffer</a></div><div class="ttdeci">bool matchesStreamBodyBuffer(const StoreIOBuffer &amp;) const</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l02033">client_side_reply.cc:2033</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a468308db7244b1439db0c4cde60acc39"><div class="ttname"><a href="classclientReplyContext.html#a468308db7244b1439db0c4cde60acc39">clientReplyContext::sendStreamError</a></div><div class="ttdeci">void sendStreamError(StoreIOBuffer const &amp;result)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01719">client_side_reply.cc:1719</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a4895ddefadfe91421fd6a2834dee8439a739ec44c2f18cae8a5b53bbd0698634f"><div class="ttname"><a href="classclientReplyContext.html#a4895ddefadfe91421fd6a2834dee8439a739ec44c2f18cae8a5b53bbd0698634f">clientReplyContext::crInitiator</a></div><div class="ttdeci">@ crInitiator</div><div class="ttdoc">we initiated collapsed revalidation request</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00154">client_side_reply.h:154</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a4895ddefadfe91421fd6a2834dee8439a9d07f0a33080790db951a2ece3e2b50f"><div class="ttname"><a href="classclientReplyContext.html#a4895ddefadfe91421fd6a2834dee8439a9d07f0a33080790db951a2ece3e2b50f">clientReplyContext::crNone</a></div><div class="ttdeci">@ crNone</div><div class="ttdoc">collapsed revalidation is not allowed for this context</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00153">client_side_reply.h:153</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a4895ddefadfe91421fd6a2834dee8439ace62de5377e0c03b32c400d1325d24fa"><div class="ttname"><a href="classclientReplyContext.html#a4895ddefadfe91421fd6a2834dee8439ace62de5377e0c03b32c400d1325d24fa">clientReplyContext::crSlave</a></div><div class="ttdeci">@ crSlave</div><div class="ttdoc">we collapsed on the existing revalidation request</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00156">client_side_reply.h:155</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a48c73104bca1be8ee82a1dfe6abdc8bc"><div class="ttname"><a href="classclientReplyContext.html#a48c73104bca1be8ee82a1dfe6abdc8bc">clientReplyContext::pushStreamData</a></div><div class="ttdeci">void pushStreamData(const StoreIOBuffer &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01736">client_side_reply.cc:1736</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a4bf46442624a01e832444fc6d9f0c732"><div class="ttname"><a href="classclientReplyContext.html#a4bf46442624a01e832444fc6d9f0c732">clientReplyContext::sendClientUpstreamResponse</a></div><div class="ttdeci">void sendClientUpstreamResponse(const StoreIOBuffer &amp;upstreamResponse)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00363">client_side_reply.cc:363</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a4c5c3b93670c261a61aef36d69354169"><div class="ttname"><a href="classclientReplyContext.html#a4c5c3b93670c261a61aef36d69354169">clientReplyContext::purgeStatus</a></div><div class="ttdeci">Http::StatusCode purgeStatus</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00065">client_side_reply.h:65</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a4c65a525bd9fc6c042e060c434822948"><div class="ttname"><a href="classclientReplyContext.html#a4c65a525bd9fc6c042e060c434822948">clientReplyContext::startError</a></div><div class="ttdeci">void startError(ErrorState *err)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00217">client_side_reply.cc:217</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a4db6cf4c6a8dca9238e0d2556fd6160b"><div class="ttname"><a href="classclientReplyContext.html#a4db6cf4c6a8dca9238e0d2556fd6160b">clientReplyContext::old_etag</a></div><div class="ttdeci">String old_etag</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00148">client_side_reply.h:148</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a4e96f2b1ec86bd2e1a60ac36ccded9a9"><div class="ttname"><a href="classclientReplyContext.html#a4e96f2b1ec86bd2e1a60ac36ccded9a9">clientReplyContext::identifyFoundObject</a></div><div class="ttdeci">void identifyFoundObject(StoreEntry *entry, const char *detail)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01504">client_side_reply.cc:1504</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a52be4e7796600f0a88e09f4b60351123"><div class="ttname"><a href="classclientReplyContext.html#a52be4e7796600f0a88e09f4b60351123">clientReplyContext::sendNotModified</a></div><div class="ttdeci">void sendNotModified()</div><div class="ttdoc">send 304 (Not Modified) to client</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01782">client_side_reply.cc:1782</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a52e1f683492128736519f7389c712b6c"><div class="ttname"><a href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">clientReplyContext::createStoreEntry</a></div><div class="ttdeci">void createStoreEntry(const HttpRequestMethod &amp;m, RequestFlags flags)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l02065">client_side_reply.cc:2065</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a54642fc1f8d38e1860d4e945d820889d"><div class="ttname"><a href="classclientReplyContext.html#a54642fc1f8d38e1860d4e945d820889d">clientReplyContext::setReplyToStoreEntry</a></div><div class="ttdeci">void setReplyToStoreEntry(StoreEntry *e, const char *reason)</div><div class="ttdoc">replaces current response store entry with the given one</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00149">client_side_reply.cc:149</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a58f125fb5351a6e1dd3eade425bed651"><div class="ttname"><a href="classclientReplyContext.html#a58f125fb5351a6e1dd3eade425bed651">clientReplyContext::buildReplyHeader</a></div><div class="ttdeci">void buildReplyHeader()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01221">client_side_reply.cc:1221</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a5f0fe361dead4a945b4fd80d7594d7b8"><div class="ttname"><a href="classclientReplyContext.html#a5f0fe361dead4a945b4fd80d7594d7b8">clientReplyContext::errorInStream</a></div><div class="ttdeci">bool errorInStream(const StoreIOBuffer &amp;result) const</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01711">client_side_reply.cc:1711</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a62122fdbe3300c20b4464e1d48e1d5a5"><div class="ttname"><a href="classclientReplyContext.html#a62122fdbe3300c20b4464e1d48e1d5a5">clientReplyContext::processOnlyIfCachedMiss</a></div><div class="ttdeci">void processOnlyIfCachedMiss()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00780">client_side_reply.cc:780</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a64862b976183a674826965486ff12948"><div class="ttname"><a href="classclientReplyContext.html#a64862b976183a674826965486ff12948">clientReplyContext::blockedHit</a></div><div class="ttdeci">bool blockedHit() const</div><div class="ttdoc">whether squid.conf send_hit prevents us from serving this hit</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00846">client_side_reply.cc:846</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a64b69e8b1134b5676180f99c9a510e7d"><div class="ttname"><a href="classclientReplyContext.html#a64b69e8b1134b5676180f99c9a510e7d">clientReplyContext::old_entry</a></div><div class="ttdeci">StoreEntry * old_entry</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00145">client_side_reply.h:145</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a6782d4abafb931f4a2b5aa1b088f8fbf"><div class="ttname"><a href="classclientReplyContext.html#a6782d4abafb931f4a2b5aa1b088f8fbf">clientReplyContext::CacheHit</a></div><div class="ttdeci">static STCB CacheHit</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00027">client_side_reply.h:27</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a75cda298aa9569171b7a4c196b13deb6"><div class="ttname"><a href="classclientReplyContext.html#a75cda298aa9569171b7a4c196b13deb6">clientReplyContext::storeClientCopy</a></div><div class="ttdeci">static decltype(::storeClientCopy) storeClientCopy</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00137">client_side_reply.h:137</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a77120a77cedbeaca1b4cb3570cef4048"><div class="ttname"><a href="classclientReplyContext.html#a77120a77cedbeaca1b4cb3570cef4048">clientReplyContext::storeNotOKTransferDone</a></div><div class="ttdeci">int storeNotOKTransferDone() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01066">client_side_reply.cc:1066</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a783c886c03fa307ec2b39c9f31bedb7f"><div class="ttname"><a href="classclientReplyContext.html#a783c886c03fa307ec2b39c9f31bedb7f">clientReplyContext::removeClientStoreReference</a></div><div class="ttdeci">void removeClientStoreReference(store_client **scp, ClientHttpRequest *http)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00178">client_side_reply.cc:178</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a7af2f4ca6c0abc63ef6265f350fa1758"><div class="ttname"><a href="classclientReplyContext.html#a7af2f4ca6c0abc63ef6265f350fa1758">clientReplyContext::clientGetMoreData</a></div><div class="ttdeci">friend CSR clientGetMoreData</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00164">client_side_reply.h:164</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a9008dda5fcc8b05839bdfd845be21d0f"><div class="ttname"><a href="classclientReplyContext.html#a9008dda5fcc8b05839bdfd845be21d0f">clientReplyContext::checkTransferDone</a></div><div class="ttdeci">int checkTransferDone()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01018">client_side_reply.cc:1018</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a9295d085f2b35f5c563b178379168ac1"><div class="ttname"><a href="classclientReplyContext.html#a9295d085f2b35f5c563b178379168ac1">clientReplyContext::~clientReplyContext</a></div><div class="ttdeci">~clientReplyContext() override</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00059">client_side_reply.cc:59</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a958236b908f2cbfadb7637844d5826ff"><div class="ttname"><a href="classclientReplyContext.html#a958236b908f2cbfadb7637844d5826ff">clientReplyContext::flags</a></div><div class="ttdeci">struct clientReplyContext::Flags flags</div></div>
<div class="ttc" id="aclassclientReplyContext_html_a9708b6cfee00c7274a16db7a5600c91e"><div class="ttname"><a href="classclientReplyContext.html#a9708b6cfee00c7274a16db7a5600c91e">clientReplyContext::processReplyAccessResult</a></div><div class="ttdeci">void processReplyAccessResult(const Acl::Answer &amp;accessAllowed)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01863">client_side_reply.cc:1863</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a9b6292369a5480b33c033bfcc7f86835"><div class="ttname"><a href="classclientReplyContext.html#a9b6292369a5480b33c033bfcc7f86835">clientReplyContext::firstStoreLookup_</a></div><div class="ttdeci">const char * firstStoreLookup_</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00142">client_side_reply.h:142</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a9dd97cfd8b9ba9373b633651d3a59039"><div class="ttname"><a href="classclientReplyContext.html#a9dd97cfd8b9ba9373b633651d3a59039">clientReplyContext::sendBodyTooLargeError</a></div><div class="ttdeci">void sendBodyTooLargeError()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01756">client_side_reply.cc:1756</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aa57444bb386525911015174e9042fee3"><div class="ttname"><a href="classclientReplyContext.html#aa57444bb386525911015174e9042fee3">clientReplyContext::deleting</a></div><div class="ttdeci">bool deleting</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00150">client_side_reply.h:150</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aa68c26ab76934275c66ba1fd3414cc2e"><div class="ttname"><a href="classclientReplyContext.html#aa68c26ab76934275c66ba1fd3414cc2e">clientReplyContext::collapsedRevalidation</a></div><div class="ttdeci">CollapsedRevalidation collapsedRevalidation</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00158">client_side_reply.h:158</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aa68c4dea99d63657588d152e9793a9cb"><div class="ttname"><a href="classclientReplyContext.html#aa68c4dea99d63657588d152e9793a9cb">clientReplyContext::sendClientOldEntry</a></div><div class="ttdeci">void sendClientOldEntry()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00383">client_side_reply.cc:383</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aa74839fedd2d5309ccaa8384a048f446"><div class="ttname"><a href="classclientReplyContext.html#aa74839fedd2d5309ccaa8384a048f446">clientReplyContext::reply</a></div><div class="ttdeci">HttpReply * reply</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00099">client_side_reply.h:99</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aa8d45c762f26cc4146fdd64561b386f3"><div class="ttname"><a href="classclientReplyContext.html#aa8d45c762f26cc4146fdd64561b386f3">clientReplyContext::tempbuf</a></div><div class="ttdeci">char tempbuf[HTTP_REQBUF_SZ]</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00077">client_side_reply.h:77</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aaa60ec684c35ec0f5ed3c92c763e5ced"><div class="ttname"><a href="classclientReplyContext.html#aaa60ec684c35ec0f5ed3c92c763e5ced">clientReplyContext::processExpired</a></div><div class="ttdeci">void processExpired()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00257">client_side_reply.cc:257</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aabf64bc2c4116b2cd2181ad8bc060353"><div class="ttname"><a href="classclientReplyContext.html#aabf64bc2c4116b2cd2181ad8bc060353">clientReplyContext::storeLookupString</a></div><div class="ttdeci">const char * storeLookupString(bool found) const</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00124">client_side_reply.h:124</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aac3fe5e8a5d5f0e2d71c531ac0ac9675"><div class="ttname"><a href="classclientReplyContext.html#aac3fe5e8a5d5f0e2d71c531ac0ac9675">clientReplyContext::purgeEntry</a></div><div class="ttdeci">bool purgeEntry(StoreEntry &amp;, const Http::MethodType, const char *descriptionPrefix=&quot;&quot;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00987">client_side_reply.cc:987</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ab137b710baaf94196345dc44b26f9914"><div class="ttname"><a href="classclientReplyContext.html#ab137b710baaf94196345dc44b26f9914">clientReplyContext::requestMoreBodyFromStore</a></div><div class="ttdeci">void requestMoreBodyFromStore()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00247">client_side_reply.cc:247</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ab3c864298f61b65ef2b2b1a97670b1fd"><div class="ttname"><a href="classclientReplyContext.html#ab3c864298f61b65ef2b2b1a97670b1fd">clientReplyContext::next</a></div><div class="ttdeci">clientStreamNode * next() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01749">client_side_reply.cc:1749</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ab6355997efa53f6426a7effa12e96a2c"><div class="ttname"><a href="classclientReplyContext.html#ab6355997efa53f6426a7effa12e96a2c">clientReplyContext::noteStreamBufferredBytes</a></div><div class="ttdeci">void noteStreamBufferredBytes(const StoreIOBuffer &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l02050">client_side_reply.cc:2050</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ab69b7434816d39d17b0bcf47825704a4"><div class="ttname"><a href="classclientReplyContext.html#ab69b7434816d39d17b0bcf47825704a4">clientReplyContext::doGetMoreData</a></div><div class="ttdeci">void doGetMoreData()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01645">client_side_reply.cc:1645</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ab7bb9cba9e77c4e81cf83757464a4974"><div class="ttname"><a href="classclientReplyContext.html#ab7bb9cba9e77c4e81cf83757464a4974">clientReplyContext::sendMoreData</a></div><div class="ttdeci">void sendMoreData(StoreIOBuffer result)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01951">client_side_reply.cc:1951</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ababe13d071231c0cf2a4956ff911bd5f"><div class="ttname"><a href="classclientReplyContext.html#ababe13d071231c0cf2a4956ff911bd5f">clientReplyContext::http</a></div><div class="ttdeci">ClientHttpRequest * http</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00070">client_side_reply.h:70</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_abca6bf899bcdd71d05414bde4a8b774f"><div class="ttname"><a href="classclientReplyContext.html#abca6bf899bcdd71d05414bde4a8b774f">clientReplyContext::lastStreamBufferedBytes</a></div><div class="ttdeci">StoreIOBuffer lastStreamBufferedBytes</div><div class="ttdoc">HTTP response body bytes stored in our Client Stream buffer (if any)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00161">client_side_reply.h:161</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_abcc95e4098085acbe1d02a3d94583e0a"><div class="ttname"><a href="classclientReplyContext.html#abcc95e4098085acbe1d02a3d94583e0a">clientReplyContext::replyStatus</a></div><div class="ttdeci">clientStream_status_t replyStatus()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01123">client_side_reply.cc:1123</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_abe6fde0ad6302abd7067028bc8cb6b0d"><div class="ttname"><a href="classclientReplyContext.html#abe6fde0ad6302abd7067028bc8cb6b0d">clientReplyContext::removeStoreReference</a></div><div class="ttdeci">void removeStoreReference(store_client **scp, StoreEntry **ep)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00163">client_side_reply.cc:163</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ac41ac51681bbc8c3db9bdf0b2a26f724"><div class="ttname"><a href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">clientReplyContext::processMiss</a></div><div class="ttdeci">void processMiss()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00704">client_side_reply.cc:704</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ac621a71c20c51fd65f0682432d2e2b57"><div class="ttname"><a href="classclientReplyContext.html#ac621a71c20c51fd65f0682432d2e2b57">clientReplyContext::loggingTags</a></div><div class="ttdeci">LogTags * loggingTags() const override</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00894">client_side_reply.cc:894</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ac7c34d6a9882a32152c928d6f1ed8e57"><div class="ttname"><a href="classclientReplyContext.html#ac7c34d6a9882a32152c928d6f1ed8e57">clientReplyContext::traceReply</a></div><div class="ttdeci">void traceReply()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00999">client_side_reply.cc:999</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_acd7c96180e2911df68078798e72f096f"><div class="ttname"><a href="classclientReplyContext.html#acd7c96180e2911df68078798e72f096f">clientReplyContext::saveState</a></div><div class="ttdeci">void saveState()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00186">client_side_reply.cc:186</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ad42a3d89a4030a9571bd374eb1d67277"><div class="ttname"><a href="classclientReplyContext.html#ad42a3d89a4030a9571bd374eb1d67277">clientReplyContext::storeId</a></div><div class="ttdeci">const char * storeId() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00063">client_side_reply.h:63</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ad7df8874888e0b2da857407f16a8cb30"><div class="ttname"><a href="classclientReplyContext.html#ad7df8874888e0b2da857407f16a8cb30">clientReplyContext::cloneReply</a></div><div class="ttdeci">void cloneReply()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01445">client_side_reply.cc:1445</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_adae8d439c917d422943d6b10d1227e40"><div class="ttname"><a href="classclientReplyContext.html#adae8d439c917d422943d6b10d1227e40">clientReplyContext::processConditional</a></div><div class="ttdeci">bool processConditional()</div><div class="ttdoc">process conditional request from client</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00792">client_side_reply.cc:792</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_adc3fb054f353c7e78ef0728eaac04bb6"><div class="ttname"><a href="classclientReplyContext.html#adc3fb054f353c7e78ef0728eaac04bb6">clientReplyContext::storeOKTransferDone</a></div><div class="ttdeci">int storeOKTransferDone() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01051">client_side_reply.cc:1051</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ae0d825813513d976e115fab8658d0dff"><div class="ttname"><a href="classclientReplyContext.html#ae0d825813513d976e115fab8658d0dff">clientReplyContext::processReplyAccess</a></div><div class="ttdeci">void processReplyAccess()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01823">client_side_reply.cc:1823</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ae381916c474e872fdad5a018ecc082fe"><div class="ttname"><a href="classclientReplyContext.html#ae381916c474e872fdad5a018ecc082fe">clientReplyContext::getNextNode</a></div><div class="ttdeci">clientStreamNode * getNextNode() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00225">client_side_reply.cc:225</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ae58ab9a507eec5431654c80222d4d6d2"><div class="ttname"><a href="classclientReplyContext.html#ae58ab9a507eec5431654c80222d4d6d2">clientReplyContext::purgeRequest</a></div><div class="ttdeci">void purgeRequest()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00903">client_side_reply.cc:903</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_ae92bf01da2cf0ca237e0ef7c77cbe445"><div class="ttname"><a href="classclientReplyContext.html#ae92bf01da2cf0ca237e0ef7c77cbe445">clientReplyContext::fillChecklist</a></div><div class="ttdeci">void fillChecklist(ACLFilledChecklist &amp;) const override</div><div class="ttdoc">configure the given checklist (to reflect the current transaction state)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l02057">client_side_reply.cc:2057</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aecee7d8e16354cd047a7e8a895c22c7f"><div class="ttname"><a href="classclientReplyContext.html#aecee7d8e16354cd047a7e8a895c22c7f">clientReplyContext::restoreState</a></div><div class="ttdeci">void restoreState()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00200">client_side_reply.cc:200</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aeee916c2def6e7a7352c7dde69e1fdbd"><div class="ttname"><a href="classclientReplyContext.html#aeee916c2def6e7a7352c7dde69e1fdbd">clientReplyContext::identifyStoreObject</a></div><div class="ttdeci">void identifyStoreObject()</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01481">client_side_reply.cc:1481</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aefdedf444de122be303a2c56dc7ef1a9"><div class="ttname"><a href="classclientReplyContext.html#aefdedf444de122be303a2c56dc7ef1a9">clientReplyContext::setReplyToError</a></div><div class="ttdeci">void setReplyToError(err_type, Http::StatusCode, char const *, const ConnStateData *, HttpRequest *, const char *, Auth::UserRequest::Pointer)</div><div class="ttdoc">builds error using clientBuildError() and calls setReplyToError() below</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00094">client_side_reply.cc:94</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_af0336f9bb37e7e98a019f71f82b78d30"><div class="ttname"><a href="classclientReplyContext.html#af0336f9bb37e7e98a019f71f82b78d30">clientReplyContext::old_lastmod</a></div><div class="ttdeci">time_t old_lastmod</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00147">client_side_reply.h:147</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_af0369b1042f9cfdbcea8c5b314c90aff"><div class="ttname"><a href="classclientReplyContext.html#af0369b1042f9cfdbcea8c5b314c90aff">clientReplyContext::purgeDoPurge</a></div><div class="ttdeci">void purgeDoPurge()</div><div class="ttdoc">releases both cached GET and HEAD entries</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00924">client_side_reply.cc:924</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_afa64e15976d047eb00f04402a0525711"><div class="ttname"><a href="classclientReplyContext.html#afa64e15976d047eb00f04402a0525711">clientReplyContext::SendMoreData</a></div><div class="ttdeci">static STCB SendMoreData</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00029">client_side_reply.h:29</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_afa825414a673993b47b3e86e1774afa3"><div class="ttname"><a href="classclientReplyContext.html#afa825414a673993b47b3e86e1774afa3">clientReplyContext::clientReplyContext</a></div><div class="ttdeci">clientReplyContext(ClientHttpRequest *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00073">client_side_reply.cc:73</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_afe190509d5386d07c17a26759742bb3c"><div class="ttname"><a href="classclientReplyContext.html#afe190509d5386d07c17a26759742bb3c">clientReplyContext::detailStoreLookup</a></div><div class="ttdeci">void detailStoreLookup(const char *detail)</div><div class="ttdoc">remembers the very first Store lookup classification, ignoring the rest</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l01583">client_side_reply.cc:1583</a></div></div>
<div class="ttc" id="aclassclientStreamNode_html"><div class="ttname"><a href="classclientStreamNode.html">clientStreamNode</a></div><div class="ttdef"><b>Definition</b> <a href="clientStream_8h_source.html#l00075">clientStream.h:76</a></div></div>
<div class="ttc" id="aclassclientStreamNode_html_a0610ee06cfe7e3208cfffe67437dad9a"><div class="ttname"><a href="classclientStreamNode.html#a0610ee06cfe7e3208cfffe67437dad9a">clientStreamNode::readBuffer</a></div><div class="ttdeci">StoreIOBuffer readBuffer</div><div class="ttdef"><b>Definition</b> <a href="clientStream_8h_source.html#l00094">clientStream.h:94</a></div></div>
<div class="ttc" id="aclassclientStreamNode_html_a3ffd025e7396d93b36a80c2048915ac8"><div class="ttname"><a href="classclientStreamNode.html#a3ffd025e7396d93b36a80c2048915ac8">clientStreamNode::data</a></div><div class="ttdeci">ClientStreamData data</div><div class="ttdef"><b>Definition</b> <a href="clientStream_8h_source.html#l00093">clientStream.h:93</a></div></div>
<div class="ttc" id="aclassclientStreamNode_html_acd24e5a54ccd28b8c5ef2e9d4c0269e5"><div class="ttname"><a href="classclientStreamNode.html#acd24e5a54ccd28b8c5ef2e9d4c0269e5">clientStreamNode::node</a></div><div class="ttdeci">dlink_node node</div><div class="ttdef"><b>Definition</b> <a href="clientStream_8h_source.html#l00087">clientStream.h:87</a></div></div>
<div class="ttc" id="aclassdlink__list_html_a60d7fc0293487a5b5914f10acae1e120"><div class="ttname"><a href="classdlink__list.html#a60d7fc0293487a5b5914f10acae1e120">dlink_list::head</a></div><div class="ttdeci">dlink_node * head</div><div class="ttdef"><b>Definition</b> <a href="dlink_8h_source.html#l00026">dlink.h:26</a></div></div>
<div class="ttc" id="aclassdlink__node_html_a06bd2bfe93cc751ab5b29b033e6ac65e"><div class="ttname"><a href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">dlink_node::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition</b> <a href="dlink_8h_source.html#l00018">dlink.h:18</a></div></div>
<div class="ttc" id="aclassdlink__node_html_a4660c70e36112cd329b84f7152a671fa"><div class="ttname"><a href="classdlink__node.html#a4660c70e36112cd329b84f7152a671fa">dlink_node::prev</a></div><div class="ttdeci">dlink_node * prev</div><div class="ttdef"><b>Definition</b> <a href="dlink_8h_source.html#l00019">dlink.h:19</a></div></div>
<div class="ttc" id="aclassdlink__node_html_ad1228295f9f83f14e0c58966479cfbd7"><div class="ttname"><a href="classdlink__node.html#ad1228295f9f83f14e0c58966479cfbd7">dlink_node::next</a></div><div class="ttdeci">dlink_node * next</div><div class="ttdef"><b>Definition</b> <a href="dlink_8h_source.html#l00020">dlink.h:20</a></div></div>
<div class="ttc" id="aclassstore__client_html"><div class="ttname"><a href="classstore__client.html">store_client</a></div><div class="ttdef"><b>Definition</b> <a href="StoreClient_8h_source.html#l00073">StoreClient.h:74</a></div></div>
<div class="ttc" id="aclassstore__client_html_a31b3c123a2b2d6450f66699cf3a84bf8"><div class="ttname"><a href="classstore__client.html#a31b3c123a2b2d6450f66699cf3a84bf8">store_client::setDelayId</a></div><div class="ttdeci">void setDelayId(DelayId delay_id)</div><div class="ttdef"><b>Definition</b> <a href="store__client_8cc_source.html#l01099">store_client.cc:1099</a></div></div>
<div class="ttc" id="aclientStreamForward_8h_html_ad7a8fcb0c65e986028978be921f80b4f"><div class="ttname"><a href="clientStreamForward_8h.html#ad7a8fcb0c65e986028978be921f80b4f">CSD</a></div><div class="ttdeci">void CSD(clientStreamNode *, ClientHttpRequest *)</div><div class="ttdoc">client stream detach</div><div class="ttdef"><b>Definition</b> <a href="clientStreamForward_8h_source.html#l00033">clientStreamForward.h:33</a></div></div>
<div class="ttc" id="aclientStreamForward_8h_html_adfeb9a20de88d7ad3433ca3c7f50a364"><div class="ttname"><a href="clientStreamForward_8h.html#adfeb9a20de88d7ad3433ca3c7f50a364">CSR</a></div><div class="ttdeci">void CSR(clientStreamNode *, ClientHttpRequest *)</div><div class="ttdoc">client stream read</div><div class="ttdef"><b>Definition</b> <a href="clientStreamForward_8h_source.html#l00030">clientStreamForward.h:30</a></div></div>
<div class="ttc" id="aclientStreamForward_8h_html_afe231eb7220220dab4804637c286f6e0"><div class="ttname"><a href="clientStreamForward_8h.html#afe231eb7220220dab4804637c286f6e0">CSS</a></div><div class="ttdeci">clientStream_status_t CSS(clientStreamNode *, ClientHttpRequest *)</div><div class="ttdef"><b>Definition</b> <a href="clientStreamForward_8h_source.html#l00035">clientStreamForward.h:35</a></div></div>
<div class="ttc" id="aclientStream_8h_html"><div class="ttname"><a href="clientStream_8h.html">clientStream.h</a></div></div>
<div class="ttc" id="aclient__side_8cc_html_aa43c942879dd80b024c465afa58f85aa"><div class="ttname"><a href="client__side_8cc.html#aa43c942879dd80b024c465afa58f85aa">clientAclChecklistCreate</a></div><div class="ttdeci">ACLFilledChecklist::MakingPointer clientAclChecklistCreate(const acl_access *acl, ClientHttpRequest *http)</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l03458">client_side.cc:3458</a></div></div>
<div class="ttc" id="aclient__side_8cc_html_abc48bb93b6bb570b3ffee98f883c7f79"><div class="ttname"><a href="client__side_8cc.html#abc48bb93b6bb570b3ffee98f883c7f79">varyEvaluateMatch</a></div><div class="ttdeci">int varyEvaluateMatch(StoreEntry *entry, HttpRequest *request)</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l03394">client_side.cc:3394</a></div></div>
<div class="ttc" id="aclient__side_8cc_html_acabcacffff4309ce2ac0aa3252eaf2ba"><div class="ttname"><a href="client__side_8cc.html#acabcacffff4309ce2ac0aa3252eaf2ba">clientAclChecklistFill</a></div><div class="ttdeci">void clientAclChecklistFill(ACLFilledChecklist &amp;checklist, ClientHttpRequest *http)</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l03466">client_side.cc:3466</a></div></div>
<div class="ttc" id="aclient__side__reply_8cc_html_a3d42a7ece901f14e6ec973a0feb096e1"><div class="ttname"><a href="client__side__reply_8cc.html#a3d42a7ece901f14e6ec973a0feb096e1">clientReplyStatus</a></div><div class="ttdeci">CSS clientReplyStatus</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00054">client_side_reply.cc:54</a></div></div>
<div class="ttc" id="aclient__side__reply_8cc_html_a5e20e5ac82c3458028aa12cee83c7b39"><div class="ttname"><a href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a></div><div class="ttdeci">ErrorState * clientBuildError(err_type, Http::StatusCode, char const *, const ConnStateData *, HttpRequest *, const AccessLogEntry::Pointer &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l02118">client_side_reply.cc:2118</a></div></div>
<div class="ttc" id="aclient__side__reply_8cc_html_ab806362f706a7b39732957bb45e3c2df"><div class="ttname"><a href="client__side__reply_8cc.html#ab806362f706a7b39732957bb45e3c2df">clientReplyDetach</a></div><div class="ttdeci">CSD clientReplyDetach</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00507">client_side_reply.cc:507</a></div></div>
<div class="ttc" id="aclient__side__reply_8cc_html_ac5bafe6dcd14e8927161d0ea22a77a7d"><div class="ttname"><a href="client__side__reply_8cc.html#ac5bafe6dcd14e8927161d0ea22a77a7d">purgeEntriesByUrl</a></div><div class="ttdeci">void purgeEntriesByUrl(HttpRequest *req, const char *url)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00869">client_side_reply.cc:869</a></div></div>
<div class="ttc" id="aclient__side__reply_8cc_html_ae73f7b10b6c2bd55c5f96c9d62839e8d"><div class="ttname"><a href="client__side__reply_8cc.html#ae73f7b10b6c2bd55c5f96c9d62839e8d">clientGetMoreData</a></div><div class="ttdeci">CSR clientGetMoreData</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00506">client_side_reply.cc:506</a></div></div>
<div class="ttc" id="aclient__side__reply_8h_html"><div class="ttname"><a href="client__side__reply_8h.html">client_side_reply.h</a></div></div>
<div class="ttc" id="aclient__side__reply_8h_html_ae60b3e554dff5b38d232bd69c129e3b2"><div class="ttname"><a href="client__side__reply_8h.html#ae60b3e554dff5b38d232bd69c129e3b2">purgeEntriesByUrl</a></div><div class="ttdeci">void purgeEntriesByUrl(HttpRequest *, const char *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00869">client_side_reply.cc:869</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_ad1f6f001d275799243ee96d0b1519d3a"><div class="ttname"><a href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a></div><div class="ttdeci">#define DBG_IMPORTANT</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00038">Stream.h:38</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_ad8cd33a7d75c0efd4d3fd369dc6a8f13"><div class="ttname"><a href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a></div><div class="ttdeci">#define debugs(SECTION, LEVEL, CONTENT)</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00192">Stream.h:192</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_af0ecf487aee4d8ff164c0f40e71c5150"><div class="ttname"><a href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a></div><div class="ttdeci">#define DBG_CRITICAL</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00037">Stream.h:37</a></div></div>
<div class="ttc" id="adefines_8h_html_ac1f8e975d5c9f901f8ec9f29db1aca92"><div class="ttname"><a href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a></div><div class="ttdeci">#define EBIT_TEST(flag, bit)</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00067">defines.h:67</a></div></div>
<div class="ttc" id="adlink_8cc_html_a26c24944a77583bb90a7efb1455a269b"><div class="ttname"><a href="dlink_8cc.html#a26c24944a77583bb90a7efb1455a269b">dlinkDelete</a></div><div class="ttdeci">void dlinkDelete(dlink_node *m, dlink_list *list)</div><div class="ttdef"><b>Definition</b> <a href="dlink_8cc_source.html#l00064">dlink.cc:64</a></div></div>
<div class="ttc" id="adlink_8cc_html_a6653213a8433b9e40b94980846e0634a"><div class="ttname"><a href="dlink_8cc.html#a6653213a8433b9e40b94980846e0634a">dlinkAdd</a></div><div class="ttdeci">void dlinkAdd(void *data, dlink_node *m, dlink_list *list)</div><div class="ttdef"><b>Definition</b> <a href="dlink_8cc_source.html#l00015">dlink.cc:15</a></div></div>
<div class="ttc" id="adlink_8cc_html_a9c55f8c6c000159340141e62253dc26f"><div class="ttname"><a href="dlink_8cc.html#a9c55f8c6c000159340141e62253dc26f">ClientActiveRequests</a></div><div class="ttdeci">dlink_list ClientActiveRequests</div><div class="ttdef"><b>Definition</b> <a href="dlink_8cc_source.html#l00012">dlink.cc:12</a></div></div>
<div class="ttc" id="aenums_8h_html_a16685eea158879e41b101ca3634de462a04a808e82e4e3539c65424c7388dd257"><div class="ttname"><a href="enums_8h.html#a16685eea158879e41b101ca3634de462a04a808e82e4e3539c65424c7388dd257">ENTRY_BAD_LENGTH</a></div><div class="ttdeci">@ ENTRY_BAD_LENGTH</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00109">enums.h:109</a></div></div>
<div class="ttc" id="aenums_8h_html_a16685eea158879e41b101ca3634de462a6c0b60acdcf1cefdb5f3a847b5f90224"><div class="ttname"><a href="enums_8h.html#a16685eea158879e41b101ca3634de462a6c0b60acdcf1cefdb5f3a847b5f90224">ENTRY_SPECIAL</a></div><div class="ttdeci">@ ENTRY_SPECIAL</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00079">enums.h:79</a></div></div>
<div class="ttc" id="aenums_8h_html_a16685eea158879e41b101ca3634de462af1d0ae16fcfb269505ed3e22bc2e3fe5"><div class="ttname"><a href="enums_8h.html#a16685eea158879e41b101ca3634de462af1d0ae16fcfb269505ed3e22bc2e3fe5">ENTRY_ABORTED</a></div><div class="ttdeci">@ ENTRY_ABORTED</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00110">enums.h:110</a></div></div>
<div class="ttc" id="aenums_8h_html_a1fb9092bcdeada2d206bdc74afbbe122a117633d22d4a5338627c410f0289f627"><div class="ttname"><a href="enums_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a117633d22d4a5338627c410f0289f627">VARY_OTHER</a></div><div class="ttdeci">@ VARY_OTHER</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00190">enums.h:190</a></div></div>
<div class="ttc" id="aenums_8h_html_a1fb9092bcdeada2d206bdc74afbbe122a23c487ebaabba2cc8dcd41323b136aa9"><div class="ttname"><a href="enums_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a23c487ebaabba2cc8dcd41323b136aa9">VARY_NONE</a></div><div class="ttdeci">@ VARY_NONE</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00188">enums.h:188</a></div></div>
<div class="ttc" id="aenums_8h_html_a1fb9092bcdeada2d206bdc74afbbe122a5dec4f1a3a983ae7827f08367330b4ab"><div class="ttname"><a href="enums_8h.html#a1fb9092bcdeada2d206bdc74afbbe122a5dec4f1a3a983ae7827f08367330b4ab">VARY_CANCEL</a></div><div class="ttdeci">@ VARY_CANCEL</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00192">enums.h:191</a></div></div>
<div class="ttc" id="aenums_8h_html_a1fb9092bcdeada2d206bdc74afbbe122ae9e4dfb086bac9073f90a3b614cc6c6d"><div class="ttname"><a href="enums_8h.html#a1fb9092bcdeada2d206bdc74afbbe122ae9e4dfb086bac9073f90a3b614cc6c6d">VARY_MATCH</a></div><div class="ttdeci">@ VARY_MATCH</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00189">enums.h:189</a></div></div>
<div class="ttc" id="aenums_8h_html_a4b579b085278da684923630e626c6351af00ce42df4a8aaf2747d419dfc43ee34"><div class="ttname"><a href="enums_8h.html#a4b579b085278da684923630e626c6351af00ce42df4a8aaf2747d419dfc43ee34">IN_MEMORY</a></div><div class="ttdeci">@ IN_MEMORY</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00032">enums.h:31</a></div></div>
<div class="ttc" id="aenums_8h_html_a53f367a6c6ec6520d99a817d002ad400a09b1e395245d61c0ede69b66df4bf704"><div class="ttname"><a href="enums_8h.html#a53f367a6c6ec6520d99a817d002ad400a09b1e395245d61c0ede69b66df4bf704">HTCP_CLR_INVALIDATION</a></div><div class="ttdeci">@ HTCP_CLR_INVALIDATION</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00237">enums.h:236</a></div></div>
<div class="ttc" id="aenums_8h_html_a53f367a6c6ec6520d99a817d002ad400aa19c85f7acec13d3daa407a93c92f508"><div class="ttname"><a href="enums_8h.html#a53f367a6c6ec6520d99a817d002ad400aa19c85f7acec13d3daa407a93c92f508">HTCP_CLR_PURGE</a></div><div class="ttdeci">@ HTCP_CLR_PURGE</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00235">enums.h:235</a></div></div>
<div class="ttc" id="aenums_8h_html_ad7d12a8ac0392194bda3900e7f4f876b"><div class="ttname"><a href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876b">clientStream_status_t</a></div><div class="ttdeci">clientStream_status_t</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00120">enums.h:120</a></div></div>
<div class="ttc" id="aenums_8h_html_ad7d12a8ac0392194bda3900e7f4f876ba47cb242ab59c602b4398248aea577b19"><div class="ttname"><a href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876ba47cb242ab59c602b4398248aea577b19">STREAM_COMPLETE</a></div><div class="ttdeci">@ STREAM_COMPLETE</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00122">enums.h:122</a></div></div>
<div class="ttc" id="aenums_8h_html_ad7d12a8ac0392194bda3900e7f4f876ba94d16363b82ec2278002d78080a8cb44"><div class="ttname"><a href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876ba94d16363b82ec2278002d78080a8cb44">STREAM_UNPLANNED_COMPLETE</a></div><div class="ttdeci">@ STREAM_UNPLANNED_COMPLETE</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00127">enums.h:127</a></div></div>
<div class="ttc" id="aenums_8h_html_ad7d12a8ac0392194bda3900e7f4f876baafdb40c0b7683e2fd31711c386833017"><div class="ttname"><a href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876baafdb40c0b7683e2fd31711c386833017">STREAM_NONE</a></div><div class="ttdeci">@ STREAM_NONE</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00121">enums.h:121</a></div></div>
<div class="ttc" id="aenums_8h_html_ad7d12a8ac0392194bda3900e7f4f876bae425b0891f7f866775009972cae49d71"><div class="ttname"><a href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876bae425b0891f7f866775009972cae49d71">STREAM_FAILED</a></div><div class="ttdeci">@ STREAM_FAILED</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00133">enums.h:132</a></div></div>
<div class="ttc" id="aenums_8h_html_af7404120c842ff6e605306823971959ea28557c32623d21545b6eb07a444c2de5"><div class="ttname"><a href="enums_8h.html#af7404120c842ff6e605306823971959ea28557c32623d21545b6eb07a444c2de5">STORE_OK</a></div><div class="ttdeci">@ STORE_OK</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00045">enums.h:45</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1a"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1a">err_type</a></div><div class="ttdeci">err_type</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00014">forward.h:14</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aa16e7157079ceea3394a7a000af25c013"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa16e7157079ceea3394a7a000af25c013">ERR_ACCESS_DENIED</a></div><div class="ttdeci">@ ERR_ACCESS_DENIED</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00018">forward.h:18</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aa5203071ca85e00df6bf2526855b6df0d"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa5203071ca85e00df6bf2526855b6df0d">ERR_NONE</a></div><div class="ttdeci">@ ERR_NONE</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00015">forward.h:15</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aa73713db5aa2fdf0bf158f4ac137e559e"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa73713db5aa2fdf0bf158f4ac137e559e">ERR_PRECONDITION_FAILED</a></div><div class="ttdeci">@ ERR_PRECONDITION_FAILED</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00047">forward.h:47</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aab442793281e45c7214a6e3d221b49505"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aab442793281e45c7214a6e3d221b49505">ERR_TOO_BIG</a></div><div class="ttdeci">@ ERR_TOO_BIG</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00040">forward.h:40</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aaf7b4c272b06f31b6c285d7fd110b72fd"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aaf7b4c272b06f31b6c285d7fd110b72fd">ERR_ONLY_IF_CACHED_MISS</a></div><div class="ttdeci">@ ERR_ONLY_IF_CACHED_MISS</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00039">forward.h:39</a></div></div>
<div class="ttc" id="aerrorpage_8h_html"><div class="ttname"><a href="errorpage_8h.html">errorpage.h</a></div></div>
<div class="ttc" id="afd_8cc_html_ac8fc7d6a8690be1f0ebc3a29f4c88ec0"><div class="ttname"><a href="fd_8cc.html#ac8fc7d6a8690be1f0ebc3a29f4c88ec0">fdUsageHigh</a></div><div class="ttdeci">int fdUsageHigh(void)</div><div class="ttdef"><b>Definition</b> <a href="fd_8cc_source.html#l00268">fd.cc:268</a></div></div>
<div class="ttc" id="afd_8h_html"><div class="ttname"><a href="fd_8h.html">fd.h</a></div></div>
<div class="ttc" id="afde_8h_html"><div class="ttname"><a href="fde_8h.html">fde.h</a></div></div>
<div class="ttc" id="aglobals_8h_html"><div class="ttname"><a href="globals_8h.html">globals.h</a></div></div>
<div class="ttc" id="aglobals_8h_html_a7f68568851b9c7f9291f7bb63f932c18"><div class="ttname"><a href="globals_8h.html#a7f68568851b9c7f9291f7bb63f932c18">shutting_down</a></div><div class="ttdeci">int shutting_down</div><div class="ttdef"><b>Definition</b> <a href="testConfigParser_8cc_source.html#l00032">testConfigParser.cc:32</a></div></div>
<div class="ttc" id="aglobals_8h_html_a8a6c8d13b6170bf1847dd3921530489b"><div class="ttname"><a href="globals_8h.html#a8a6c8d13b6170bf1847dd3921530489b">null_string</a></div><div class="ttdeci">const char * null_string</div></div>
<div class="ttc" id="agroup__ACLAPI_html_gga449cde9b9fa7a3ddb6d83d61080c1df5aa3d37d87d9b3887abc5466afb368cb8a"><div class="ttname"><a href="group__ACLAPI.html#gga449cde9b9fa7a3ddb6d83d61080c1df5aa3d37d87d9b3887abc5466afb368cb8a">ACCESS_ALLOWED</a></div><div class="ttdeci">@ ACCESS_ALLOWED</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00042">Acl.h:42</a></div></div>
<div class="ttc" id="agroup__ClientStreamAPI_html_ga99b0c67ea123ea13bd712b3ffd77509b"><div class="ttname"><a href="group__ClientStreamAPI.html#ga99b0c67ea123ea13bd712b3ffd77509b">clientStreamCallback</a></div><div class="ttdeci">void clientStreamCallback(clientStreamNode *thisObject, ClientHttpRequest *http, HttpReply *rep, StoreIOBuffer replyBuffer)</div><div class="ttdef"><b>Definition</b> <a href="clientStream_8cc_source.html#l00150">clientStream.cc:150</a></div></div>
<div class="ttc" id="agroup__ClientStreamInternal_html_gae62c467856741b9fdc6c8b919ea65462"><div class="ttname"><a href="group__ClientStreamInternal.html#gae62c467856741b9fdc6c8b919ea65462">clientStreamDetach</a></div><div class="ttdeci">void clientStreamDetach(clientStreamNode *thisObject, ClientHttpRequest *http)</div><div class="ttdef"><b>Definition</b> <a href="clientStream_8cc_source.html#l00192">clientStream.cc:192</a></div></div>
<div class="ttc" id="agroup__ErrorPageAPI_html_gae984c9bcabfcfb5f0f732a501169a388"><div class="ttname"><a href="group__ErrorPageAPI.html#gae984c9bcabfcfb5f0f732a501169a388">errorAppendEntry</a></div><div class="ttdeci">void errorAppendEntry(StoreEntry *entry, ErrorState *err)</div><div class="ttdef"><b>Definition</b> <a href="errorpage_8cc_source.html#l00738">errorpage.cc:738</a></div></div>
<div class="ttc" id="agroup__IPCacheAPI_html_ga01f4fb0a4852b5f21c596b57b75538a4"><div class="ttname"><a href="group__IPCacheAPI.html#ga01f4fb0a4852b5f21c596b57b75538a4">ipcacheInvalidateNegative</a></div><div class="ttdeci">void ipcacheInvalidateNegative(const char *name)</div><div class="ttdef"><b>Definition</b> <a href="ipcache_8cc_source.html#l00882">ipcache.cc:882</a></div></div>
<div class="ttc" id="agroup__IPCacheAPI_html_ga58164ac8ac971b97bca837a3d4bb9efe"><div class="ttname"><a href="group__IPCacheAPI.html#ga58164ac8ac971b97bca837a3d4bb9efe">ipcacheInvalidate</a></div><div class="ttdeci">void ipcacheInvalidate(const char *name)</div><div class="ttdef"><b>Definition</b> <a href="ipcache_8cc_source.html#l00865">ipcache.cc:865</a></div></div>
<div class="ttc" id="ahttp_2Message_8h_html_adc5c03415efc511e2b62e809310969b6"><div class="ttname"><a href="http_2Message_8h.html#adc5c03415efc511e2b62e809310969b6">HTTPMSGUNLOCK</a></div><div class="ttdeci">void HTTPMSGUNLOCK(M *&amp;a)</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00150">Message.h:150</a></div></div>
<div class="ttc" id="ahttp_2Message_8h_html_afbf13ecd1cc5c007367ae094c1aa19a9"><div class="ttname"><a href="http_2Message_8h.html#afbf13ecd1cc5c007367ae094c1aa19a9">HTTPMSGLOCK</a></div><div class="ttdeci">void HTTPMSGLOCK(Http::Message *a)</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00161">Message.h:161</a></div></div>
<div class="ttc" id="ahttp_2Stream_8h_html"><div class="ttname"><a href="http_2Stream_8h.html">Stream.h</a></div></div>
<div class="ttc" id="ahttp_2forward_8h_html_a196f6d12d102aebcc7a2778bea3e6b19"><div class="ttname"><a href="http_2forward_8h.html#a196f6d12d102aebcc7a2778bea3e6b19">HTTP_REQBUF_SZ</a></div><div class="ttdeci">#define HTTP_REQBUF_SZ</div><div class="ttdef"><b>Definition</b> <a href="http_2forward_8h_source.html#l00014">forward.h:14</a></div></div>
<div class="ttc" id="aipcache_8h_html"><div class="ttname"><a href="ipcache_8h.html">ipcache.h</a></div></div>
<div class="ttc" id="amime__header_8h_html"><div class="ttname"><a href="mime__header_8h.html">mime_header.h</a></div></div>
<div class="ttc" id="anamespaceAnyP_html_af0ba7042d4344a04b758836b3e6e7acca0afa51095369614c8fa01f910aab785a"><div class="ttname"><a href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca0afa51095369614c8fa01f910aab785a">AnyP::PROTO_NONE</a></div><div class="ttdeci">@ PROTO_NONE</div><div class="ttdef"><b>Definition</b> <a href="ProtocolType_8h_source.html#l00024">ProtocolType.h:24</a></div></div>
<div class="ttc" id="anamespaceAnyP_html_af0ba7042d4344a04b758836b3e6e7acca0f99ccafd63891be16873f9f2abe94ba"><div class="ttname"><a href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca0f99ccafd63891be16873f9f2abe94ba">AnyP::PROTO_HTTPS</a></div><div class="ttdeci">@ PROTO_HTTPS</div><div class="ttdef"><b>Definition</b> <a href="ProtocolType_8h_source.html#l00027">ProtocolType.h:27</a></div></div>
<div class="ttc" id="anamespaceAnyP_html_af0ba7042d4344a04b758836b3e6e7acca62d94ce7433f7892fb4541f72ac4ac7d"><div class="ttname"><a href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca62d94ce7433f7892fb4541f72ac4ac7d">AnyP::PROTO_HTTP</a></div><div class="ttdeci">@ PROTO_HTTP</div><div class="ttdef"><b>Definition</b> <a href="ProtocolType_8h_source.html#l00025">ProtocolType.h:25</a></div></div>
<div class="ttc" id="anamespaceComm_html_a91f0a0e22e74a7ad6f7c44c137c6f005"><div class="ttname"><a href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a></div><div class="ttdeci">bool IsConnOpen(const Comm::ConnectionPointer &amp;conn)</div><div class="ttdef"><b>Definition</b> <a href="Connection_8cc_source.html#l00027">Connection.cc:27</a></div></div>
<div class="ttc" id="anamespaceHttp_html"><div class="ttname"><a href="namespaceHttp.html">Http</a></div><div class="ttdef"><b>Definition</b> <a href="clients_2forward_8h_source.html#l00017">forward.h:18</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a0037b8798f4cd247893861d2d18e051e"><div class="ttname"><a href="namespaceHttp.html#a0037b8798f4cd247893861d2d18e051e">Http::MethodType</a></div><div class="ttdeci">enum Http::_method_t MethodType</div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722">Http::StatusCode</a></div><div class="ttdeci">StatusCode</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00020">StatusCode.h:20</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a0d4efa9ae540290c151f4034069cabc5"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a0d4efa9ae540290c151f4034069cabc5">Http::scProcessing</a></div><div class="ttdeci">@ scProcessing</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00024">StatusCode.h:24</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a16974375186a414ff6a7a9837581904f"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a16974375186a414ff6a7a9837581904f">Http::scGatewayTimeout</a></div><div class="ttdeci">@ scGatewayTimeout</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00077">StatusCode.h:77</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a></div><div class="ttdeci">@ scForbidden</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00048">StatusCode.h:48</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a3868c9f40f16676c17393a2e5565a83a"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a3868c9f40f16676c17393a2e5565a83a">Http::scUnauthorized</a></div><div class="ttdeci">@ scUnauthorized</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00046">StatusCode.h:46</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a3a896c4c837cff6ec3414fcc23adac68"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a3a896c4c837cff6ec3414fcc23adac68">Http::scNotImplemented</a></div><div class="ttdeci">@ scNotImplemented</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00074">StatusCode.h:74</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a6f94589e93c5e1111f2b2ccfc538d9cc"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a6f94589e93c5e1111f2b2ccfc538d9cc">Http::scInternalServerError</a></div><div class="ttdeci">@ scInternalServerError</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00073">StatusCode.h:73</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a9156f33c4844fa3aa50606ebacb750f7"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a9156f33c4844fa3aa50606ebacb750f7">Http::scNotFound</a></div><div class="ttdeci">@ scNotFound</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00049">StatusCode.h:49</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722aa140c4f7dc1624466a96d42cc209f155"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722aa140c4f7dc1624466a96d42cc209f155">Http::scProxyAuthenticationRequired</a></div><div class="ttdeci">@ scProxyAuthenticationRequired</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00052">StatusCode.h:52</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722aab61d70dce6e121feb658b24ef1cd815"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722aab61d70dce6e121feb658b24ef1cd815">Http::scNone</a></div><div class="ttdeci">@ scNone</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00021">StatusCode.h:21</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722aac99376ecec42f14e89b637dc6286ccf"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722aac99376ecec42f14e89b637dc6286ccf">Http::scNotModified</a></div><div class="ttdeci">@ scNotModified</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00041">StatusCode.h:41</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722aad8d279f381aa192a9f4389158d1b25e"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722aad8d279f381aa192a9f4389158d1b25e">Http::scOkay</a></div><div class="ttdeci">@ scOkay</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00027">StatusCode.h:27</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722ab4c64c106757b282a785dd2d71686616"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722ab4c64c106757b282a785dd2d71686616">Http::scContinue</a></div><div class="ttdeci">@ scContinue</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00022">StatusCode.h:22</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722ab95a10cc149f601422b96a56b2acf1f7"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722ab95a10cc149f601422b96a56b2acf1f7">Http::scNoContent</a></div><div class="ttdeci">@ scNoContent</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00031">StatusCode.h:31</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722ac75e2250505c30c0d45be7f9b606c9c7"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722ac75e2250505c30c0d45be7f9b606c9c7">Http::scSwitchingProtocols</a></div><div class="ttdeci">@ scSwitchingProtocols</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00023">StatusCode.h:23</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722ad90b7aeb8c45bd49cd1ca66c17f9c3a3"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722ad90b7aeb8c45bd49cd1ca66c17f9c3a3">Http::scPreconditionFailed</a></div><div class="ttdeci">@ scPreconditionFailed</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00057">StatusCode.h:57</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a58167438595391e06cff41c13913de23"><div class="ttname"><a href="namespaceHttp.html#a58167438595391e06cff41c13913de23">Http::MethodStr</a></div><div class="ttdeci">const SBuf &amp; MethodStr(const MethodType m)</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00100">MethodType.h:100</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787a048d612501964b8d3f0d41ede55395f3"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a048d612501964b8d3f0d41ede55395f3">Http::METHOD_TRACE</a></div><div class="ttdeci">@ METHOD_TRACE</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00030">MethodType.h:30</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787a17353570f8312493328aa9ade6ff514a"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a17353570f8312493328aa9ade6ff514a">Http::METHOD_NONE</a></div><div class="ttdeci">@ METHOD_NONE</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00022">MethodType.h:22</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787a1fa639d2eb3bfb92c2b42d4703450ba9"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a1fa639d2eb3bfb92c2b42d4703450ba9">Http::METHOD_OTHER</a></div><div class="ttdeci">@ METHOD_OTHER</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00093">MethodType.h:93</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787aaf87eb41a8f3de92bb4f977918d2f575"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787aaf87eb41a8f3de92bb4f977918d2f575">Http::METHOD_ENUM_END</a></div><div class="ttdeci">@ METHOD_ENUM_END</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00095">MethodType.h:94</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a></div><div class="ttdeci">@ METHOD_GET</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00025">MethodType.h:25</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787ac284f1b2d0b0429b55542e9ca3be28d4"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ac284f1b2d0b0429b55542e9ca3be28d4">Http::METHOD_PURGE</a></div><div class="ttdeci">@ METHOD_PURGE</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00092">MethodType.h:92</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b">Http::METHOD_HEAD</a></div><div class="ttdeci">@ METHOD_HEAD</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00028">MethodType.h:28</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a8f5de7a6ddd395e9aaf0dffd043c2276"><div class="ttname"><a href="namespaceHttp.html#a8f5de7a6ddd395e9aaf0dffd043c2276">Http::ProtocolVersion</a></div><div class="ttdeci">AnyP::ProtocolVersion ProtocolVersion()</div><div class="ttdef"><b>Definition</b> <a href="http_2ProtocolVersion_8h_source.html#l00032">ProtocolVersion.h:32</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a0a200af415630c8982f1df9ecd312de8"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a0a200af415630c8982f1df9ecd312de8">Http::DATE</a></div><div class="ttdeci">@ DATE</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00049">RegisteredHeaders.h:49</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a21db8a0f647c77f4dd700baeed4be945"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a21db8a0f647c77f4dd700baeed4be945">Http::CONNECTION</a></div><div class="ttdeci">@ CONNECTION</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00037">RegisteredHeaders.h:37</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a2a3cf223743e814f1545c1b319f11806"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a2a3cf223743e814f1545c1b319f11806">Http::AGE</a></div><div class="ttdeci">@ AGE</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00029">RegisteredHeaders.h:29</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a35faacab7f7518d7c22be4f1fc1cb4e7"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a35faacab7f7518d7c22be4f1fc1cb4e7">Http::PROXY_SUPPORT</a></div><div class="ttdeci">@ PROXY_SUPPORT</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00084">RegisteredHeaders.h:84</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a3c46461540238458a31d1afccf608cd7"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a3c46461540238458a31d1afccf608cd7">Http::SET_COOKIE</a></div><div class="ttdeci">@ SET_COOKIE</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00091">RegisteredHeaders.h:91</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a4c6cb289c5426015a4cd73401b690ee0"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a4c6cb289c5426015a4cd73401b690ee0">Http::SURROGATE_CONTROL</a></div><div class="ttdeci">@ SURROGATE_CONTROL</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00113">RegisteredHeaders.h:113</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a5d240fa0f5eb4e05bf6e9d705cc1c317"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a5d240fa0f5eb4e05bf6e9d705cc1c317">Http::EXPIRES</a></div><div class="ttdeci">@ EXPIRES</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00056">RegisteredHeaders.h:56</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a77e5b4d86480fd03b87843c0cdfdbdfd"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a77e5b4d86480fd03b87843c0cdfdbdfd">Http::IF_MATCH</a></div><div class="ttdeci">@ IF_MATCH</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00062">RegisteredHeaders.h:62</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a78311c3bedd99c69c01b5ada747f1de4"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a78311c3bedd99c69c01b5ada747f1de4">Http::MAX_FORWARDS</a></div><div class="ttdeci">@ MAX_FORWARDS</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00073">RegisteredHeaders.h:73</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a986213101dcdd9ffc371bbfd07606641"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a986213101dcdd9ffc371bbfd07606641">Http::WWW_AUTHENTICATE</a></div><div class="ttdeci">@ WWW_AUTHENTICATE</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00107">RegisteredHeaders.h:107</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4aa83838d4c8ca01ddfbec2af8759a0c3e"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4aa83838d4c8ca01ddfbec2af8759a0c3e">Http::IF_NONE_MATCH</a></div><div class="ttdeci">@ IF_NONE_MATCH</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00064">RegisteredHeaders.h:64</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4ab72dfe4a5620a1e4d7b096afe4aca653"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4ab72dfe4a5620a1e4d7b096afe4aca653">Http::IF_MODIFIED_SINCE</a></div><div class="ttdeci">@ IF_MODIFIED_SINCE</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00063">RegisteredHeaders.h:63</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4abf644a4ab3a498ed2854c3022837e8f9"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4abf644a4ab3a498ed2854c3022837e8f9">Http::TRANSFER_ENCODING</a></div><div class="ttdeci">@ TRANSFER_ENCODING</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00099">RegisteredHeaders.h:99</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4ac6654c832ce51820706e243733a197c6"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4ac6654c832ce51820706e243733a197c6">Http::SURROGATE_CAPABILITY</a></div><div class="ttdeci">@ SURROGATE_CAPABILITY</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00112">RegisteredHeaders.h:112</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4aee424720c1d99ecd044f2fd9f325d5a8"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4aee424720c1d99ecd044f2fd9f325d5a8">Http::CACHE_STATUS</a></div><div class="ttdeci">@ CACHE_STATUS</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00035">RegisteredHeaders.h:35</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4af2cf7825f44d529c50c82e9690634507"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4af2cf7825f44d529c50c82e9690634507">Http::PROXY_AUTHENTICATE</a></div><div class="ttdeci">@ PROXY_AUTHENTICATE</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00080">RegisteredHeaders.h:80</a></div></div>
<div class="ttc" id="anamespaceIp_1_1Qos_html_a53ab24bd5dd147beeb5d2bbdb5a192de"><div class="ttname"><a href="namespaceIp_1_1Qos.html#a53ab24bd5dd147beeb5d2bbdb5a192de">Ip::Qos::doNfmarkLocalHit</a></div><div class="ttdeci">int doNfmarkLocalHit(const Comm::ConnectionPointer &amp;conn)</div><div class="ttdef"><b>Definition</b> <a href="QosConfig_8cc_source.html#l00280">QosConfig.cc:280</a></div></div>
<div class="ttc" id="anamespaceIp_1_1Qos_html_a82d2b4c8d940bbb4853ccafbb33da971"><div class="ttname"><a href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a></div><div class="ttdeci">Config TheConfig</div><div class="ttdoc">Globally available instance of Qos::Config.</div><div class="ttdef"><b>Definition</b> <a href="QosConfig_8cc_source.html#l00288">QosConfig.cc:288</a></div></div>
<div class="ttc" id="anamespaceIp_1_1Qos_html_a8c2605e4add905a8db95e453904fc821"><div class="ttname"><a href="namespaceIp_1_1Qos.html#a8c2605e4add905a8db95e453904fc821">Ip::Qos::doTosLocalMiss</a></div><div class="ttdeci">int doTosLocalMiss(const Comm::ConnectionPointer &amp;conn, const hier_code hierCode)</div><div class="ttdef"><b>Definition</b> <a href="QosConfig_8cc_source.html#l00231">QosConfig.cc:231</a></div></div>
<div class="ttc" id="anamespaceIp_1_1Qos_html_ab4475c57093eddcf462cbe95a074230d"><div class="ttname"><a href="namespaceIp_1_1Qos.html#ab4475c57093eddcf462cbe95a074230d">Ip::Qos::doNfmarkLocalMiss</a></div><div class="ttdeci">int doNfmarkLocalMiss(const Comm::ConnectionPointer &amp;conn, const hier_code hierCode)</div><div class="ttdef"><b>Definition</b> <a href="QosConfig_8cc_source.html#l00252">QosConfig.cc:252</a></div></div>
<div class="ttc" id="anamespaceIp_1_1Qos_html_adc0228f1ab3df2b3b2bd54fac7f4b89b"><div class="ttname"><a href="namespaceIp_1_1Qos.html#adc0228f1ab3df2b3b2bd54fac7f4b89b">Ip::Qos::doTosLocalHit</a></div><div class="ttdeci">int doTosLocalHit(const Comm::ConnectionPointer &amp;conn)</div><div class="ttdef"><b>Definition</b> <a href="QosConfig_8cc_source.html#l00273">QosConfig.cc:273</a></div></div>
<div class="ttc" id="anamespaceStore_html_a0151d620409db8bd3af40e3570a18f8c"><div class="ttname"><a href="namespaceStore.html#a0151d620409db8bd3af40e3570a18f8c">Store::Root</a></div><div class="ttdeci">Controller &amp; Root()</div><div class="ttdoc">safely access controller singleton</div><div class="ttdef"><b>Definition</b> <a href="Controller_8cc_source.html#l00926">Controller.cc:926</a></div></div>
<div class="ttc" id="anegotiate__wrapper_8cc_html_a5eb055ca3b42205cc134b4a438cd9a72"><div class="ttname"><a href="negotiate__wrapper_8cc.html#a5eb055ca3b42205cc134b4a438cd9a72">xstrdup</a></div><div class="ttdeci">#define xstrdup</div><div class="ttdef"><b>Definition</b> <a href="negotiate__wrapper_8cc_source.html#l00047">negotiate_wrapper.cc:47</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a2f4988cdd50e3844d829a7c363dcce5c"><div class="ttname"><a href="neighbors_8cc.html#a2f4988cdd50e3844d829a7c363dcce5c">neighborsHtcpClear</a></div><div class="ttdeci">void neighborsHtcpClear(StoreEntry *e, HttpRequest *req, const HttpRequestMethod &amp;method, htcp_clr_reason reason)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01675">neighbors.cc:1675</a></div></div>
<div class="ttc" id="aneighbors_8h_html"><div class="ttname"><a href="neighbors_8h.html">neighbors.h</a></div></div>
<div class="ttc" id="arefresh_8cc_html_ae41c498580ee2ca2a2e6ea07a01573fd"><div class="ttname"><a href="refresh_8cc.html#ae41c498580ee2ca2a2e6ea07a01573fd">refreshCheckHTTP</a></div><div class="ttdeci">int refreshCheckHTTP(const StoreEntry *entry, HttpRequest *request)</div><div class="ttdef"><b>Definition</b> <a href="refresh_8cc_source.html#l00582">refresh.cc:582</a></div></div>
<div class="ttc" id="arefresh_8h_html"><div class="ttname"><a href="refresh_8h.html">refresh.h</a></div></div>
<div class="ttc" id="asquid_8h_html"><div class="ttname"><a href="squid_8h.html">squid.h</a></div></div>
<div class="ttc" id="astore_2forward_8h_html_ab1424e1b13666cc28f4c5cb05f8c8305"><div class="ttname"><a href="store_2forward_8h.html#ab1424e1b13666cc28f4c5cb05f8c8305">cache_key</a></div><div class="ttdeci">unsigned char cache_key</div><div class="ttdoc">Store key.</div><div class="ttdef"><b>Definition</b> <a href="store_2forward_8h_source.html#l00029">forward.h:29</a></div></div>
<div class="ttc" id="astore_8cc_html_a6ffbfacd8471ff973b224f96bdf702ca"><div class="ttname"><a href="store_8cc.html#a6ffbfacd8471ff973b224f96bdf702ca">storeGetPublicByRequestMethod</a></div><div class="ttdeci">StoreEntry * storeGetPublicByRequestMethod(HttpRequest *req, const HttpRequestMethod &amp;method, const KeyScope keyScope)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00510">store.cc:510</a></div></div>
<div class="ttc" id="astore_8cc_html_a70101e23661f7fe20ce50890c448e92c"><div class="ttname"><a href="store_8cc.html#a70101e23661f7fe20ce50890c448e92c">storeGetPublicByRequest</a></div><div class="ttdeci">StoreEntry * storeGetPublicByRequest(HttpRequest *req, const KeyScope keyScope)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00516">store.cc:516</a></div></div>
<div class="ttc" id="astore_8cc_html_a872157d7a8c43bb5facb072ce03c4d48"><div class="ttname"><a href="store_8cc.html#a872157d7a8c43bb5facb072ce03c4d48">storeCreateEntry</a></div><div class="ttdeci">StoreEntry * storeCreateEntry(const char *url, const char *logUrl, const RequestFlags &amp;flags, const HttpRequestMethod &amp;method)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00759">store.cc:759</a></div></div>
<div class="ttc" id="astore_8cc_html_a925dbf2023674d27f243e19c35f5c008"><div class="ttname"><a href="store_8cc.html#a925dbf2023674d27f243e19c35f5c008">storeGetPublic</a></div><div class="ttdeci">StoreEntry * storeGetPublic(const char *uri, const HttpRequestMethod &amp;method)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00504">store.cc:504</a></div></div>
<div class="ttc" id="astore__client_8cc_html_a06631df680fe4de46f305a34874175f9"><div class="ttname"><a href="store__client_8cc.html#a06631df680fe4de46f305a34874175f9">storeUnregister</a></div><div class="ttdeci">int storeUnregister(store_client *sc, StoreEntry *e, void *data)</div><div class="ttdef"><b>Definition</b> <a href="store__client_8cc_source.html#l00765">store_client.cc:765</a></div></div>
<div class="ttc" id="astore__client_8cc_html_ae077d286d865af03eb1357a8de9ba75b"><div class="ttname"><a href="store__client_8cc.html#ae077d286d865af03eb1357a8de9ba75b">storeClientListAdd</a></div><div class="ttdeci">store_client * storeClientListAdd(StoreEntry *e, void *data)</div><div class="ttdef"><b>Definition</b> <a href="store__client_8cc_source.html#l00124">store_client.cc:124</a></div></div>
<div class="ttc" id="astore__key__md5_8cc_html_a9a805f970e159065a2c53ac9ef027fb3"><div class="ttname"><a href="store__key__md5_8cc.html#a9a805f970e159065a2c53ac9ef027fb3">storeKeyPublic</a></div><div class="ttdeci">const cache_key * storeKeyPublic(const char *url, const HttpRequestMethod &amp;method, const KeyScope keyScope)</div><div class="ttdef"><b>Definition</b> <a href="store__key__md5_8cc_source.html#l00095">store_key_md5.cc:95</a></div></div>
<div class="ttc" id="astore__key__md5_8cc_html_ae14de11fa2cd3e2dc15d4763a06d0850"><div class="ttname"><a href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a></div><div class="ttdeci">const char * storeKeyText(const cache_key *key)</div><div class="ttdef"><b>Definition</b> <a href="store__key__md5_8cc_source.html#l00017">store_key_md5.cc:17</a></div></div>
<div class="ttc" id="astore__key__md5_8h_html_a49cd576e8f2ba2c00d8e65364ec7c44daad451bfc625f4ffe79db789aa3b04dee"><div class="ttname"><a href="store__key__md5_8h.html#a49cd576e8f2ba2c00d8e65364ec7c44daad451bfc625f4ffe79db789aa3b04dee">ksRevalidation</a></div><div class="ttdeci">@ ksRevalidation</div><div class="ttdef"><b>Definition</b> <a href="store__key__md5_8h_source.html#l00021">store_key_md5.h:20</a></div></div>
<div class="ttc" id="astructClientHttpRequest_1_1Flags_html_a409fd4d5e3b72f06df2921bd417e0a5c"><div class="ttname"><a href="structClientHttpRequest_1_1Flags.html#a409fd4d5e3b72f06df2921bd417e0a5c">ClientHttpRequest::Flags::accel</a></div><div class="ttdeci">bool accel</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00164">client_side_request.h:164</a></div></div>
<div class="ttc" id="astructClientHttpRequest_1_1Flags_html_ada185aa70ccc6b2da21c33f453dca0b5"><div class="ttname"><a href="structClientHttpRequest_1_1Flags.html#ada185aa70ccc6b2da21c33f453dca0b5">ClientHttpRequest::Flags::done_copying</a></div><div class="ttdeci">bool done_copying</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00165">client_side_request.h:165</a></div></div>
<div class="ttc" id="astructClientHttpRequest_1_1Out_html_a4d7061fef2fd2cd55f1cc534cb43f040"><div class="ttname"><a href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">ClientHttpRequest::Out::offset</a></div><div class="ttdeci">int64_t offset</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00151">client_side_request.h:151</a></div></div>
<div class="ttc" id="astructClientHttpRequest_1_1Out_html_acbc2aeb0bd5adc0d5a30e22b03532129"><div class="ttname"><a href="structClientHttpRequest_1_1Out.html#acbc2aeb0bd5adc0d5a30e22b03532129">ClientHttpRequest::Out::size</a></div><div class="ttdeci">uint64_t size</div><div class="ttdoc">Response header and body bytes written to the client connection.</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00153">client_side_request.h:153</a></div></div>
<div class="ttc" id="astructClientHttpRequest_1_1Redirect_html_a51a61e18a57f2018c331c346b4a75816"><div class="ttname"><a href="structClientHttpRequest_1_1Redirect.html#a51a61e18a57f2018c331c346b4a75816">ClientHttpRequest::Redirect::status</a></div><div class="ttdeci">Http::StatusCode status</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00169">client_side_request.h:169</a></div></div>
<div class="ttc" id="astructClientHttpRequest_1_1Redirect_html_a98ac56cf94b890c981797389fba6b520"><div class="ttname"><a href="structClientHttpRequest_1_1Redirect.html#a98ac56cf94b890c981797389fba6b520">ClientHttpRequest::Redirect::location</a></div><div class="ttdeci">char * location</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00170">client_side_request.h:170</a></div></div>
<div class="ttc" id="astructclientReplyContext_1_1Flags_html_a9fd53bdc9adcf5af7aab7d5c4312ccd0"><div class="ttname"><a href="structclientReplyContext_1_1Flags.html#a9fd53bdc9adcf5af7aab7d5c4312ccd0">clientReplyContext::Flags::complete</a></div><div class="ttdeci">unsigned complete</div><div class="ttdoc">we have read all we can from upstream</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00083">client_side_reply.h:83</a></div></div>
<div class="ttc" id="astructclientReplyContext_1_1Flags_html_aa19634b100888f59e7df68a32f7bef1f"><div class="ttname"><a href="structclientReplyContext_1_1Flags.html#aa19634b100888f59e7df68a32f7bef1f">clientReplyContext::Flags::headersSent</a></div><div class="ttdeci">bool headersSent</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00084">client_side_reply.h:84</a></div></div>
<div class="ttc" id="astructclientReplyContext_1_1Flags_html_abee3bb6f7775ddc1b0ddb0b6525d110d"><div class="ttname"><a href="structclientReplyContext_1_1Flags.html#abee3bb6f7775ddc1b0ddb0b6525d110d">clientReplyContext::Flags::storelogiccomplete</a></div><div class="ttdeci">unsigned storelogiccomplete</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00082">client_side_reply.h:82</a></div></div>
<div class="ttc" id="astructnode_html"><div class="ttname"><a href="structnode.html">node</a></div><div class="ttdef"><b>Definition</b> <a href="parse_8c_source.html#l00104">parse.c:104</a></div></div>
<div class="ttc" id="atools_8cc_html_adbe2913b25bf470a7814f9ec4a0907d9"><div class="ttname"><a href="tools_8cc.html#adbe2913b25bf470a7814f9ec4a0907d9">uniqueHostname</a></div><div class="ttdeci">const char * uniqueHostname(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00548">tools.cc:548</a></div></div>
<div class="ttc" id="atools_8h_html"><div class="ttname"><a href="tools_8h.html">tools.h</a></div></div>
<div class="ttc" id="atypes_8h_html_ae372e90b62c1e8b51dc5d95bf7f5ba48"><div class="ttname"><a href="types_8h.html#ae372e90b62c1e8b51dc5d95bf7f5ba48">PRId64</a></div><div class="ttdeci">#define PRId64</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00104">types.h:104</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3c69fff7f634b97773a4d39d4565ffb4.html">squid</a></li><li class="navelem"><a class="el" href="dir_27a06220d184fcc3bd2c56b7794ae45b.html">src</a></li><li class="navelem"><a class="el" href="client__side__reply_8cc.html">client_side_reply.cc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
