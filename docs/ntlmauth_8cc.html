<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Squid Web Cache: squid/lib/ntlmauth/ntlmauth.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Squid Web Cache<span id="projectnumber">&#160;master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ntlmauth_8cc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ntlmauth.cc File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="squid_8h_source.html">squid.h</a>&quot;</code><br />
<code>#include &lt;cstring&gt;</code><br />
<code>#include &lt;ctime&gt;</code><br />
<code>#include &lt;random&gt;</code><br />
<code>#include &quot;<a class="el" href="ntlmauth_8h_source.html">ntlmauth/ntlmauth.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ntlmauth.cc:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ntlmauth_8cc__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="ntlmauth_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab7c8849f3a775f9ec146d3a42778d291" id="r_ab7c8849f3a775f9ec146d3a42778d291"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ntlmauth_8cc.html#ab7c8849f3a775f9ec146d3a42778d291">ntlm_dump_ntlmssp_flags</a> (uint32_t flags)</td></tr>
<tr class="separator:ab7c8849f3a775f9ec146d3a42778d291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40e6a35f49b9f6db37dc4876807edde8" id="r_a40e6a35f49b9f6db37dc4876807edde8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654">NtlmError</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ntlmauth_8cc.html#a40e6a35f49b9f6db37dc4876807edde8">ntlm_validate_packet</a> (const <a class="el" href="ntlmauth_8h.html#ad5f9fd7eace03bd3ad3c6b88fd59671e">ntlmhdr</a> *hdr, const int32_t type)</td></tr>
<tr class="separator:a40e6a35f49b9f6db37dc4876807edde8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5706ef5b4d90b6fb8a0544fb39ad735" id="r_ac5706ef5b4d90b6fb8a0544fb39ad735"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ntlmauth_8h.html#acb3571be89fc778d4c2cb2d1fe9857ff">lstring</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ntlmauth_8cc.html#ac5706ef5b4d90b6fb8a0544fb39ad735">ntlm_fetch_string</a> (const <a class="el" href="ntlmauth_8h.html#ad5f9fd7eace03bd3ad3c6b88fd59671e">ntlmhdr</a> *packet, const int32_t packet_size, const <a class="el" href="ntlmauth_8h.html#a646ceac26b877d96395e67e952ed4a6b">strhdr</a> *str, const uint32_t flags)</td></tr>
<tr class="separator:ac5706ef5b4d90b6fb8a0544fb39ad735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb6231b1a4894a9a0bd2e27a50cd1e9c" id="r_aeb6231b1a4894a9a0bd2e27a50cd1e9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ntlmauth_8cc.html#aeb6231b1a4894a9a0bd2e27a50cd1e9c">ntlm_add_to_payload</a> (const <a class="el" href="ntlmauth_8h.html#ad5f9fd7eace03bd3ad3c6b88fd59671e">ntlmhdr</a> *packet_hdr, char *payload, <a class="el" href="stub__fd_8cc.html#a2f81796204b7bbe80bac6d6599203024">int</a> *payload_length, <a class="el" href="ntlmauth_8h.html#a646ceac26b877d96395e67e952ed4a6b">strhdr</a> *hdr, const char *toadd, const uint16_t toadd_length)</td></tr>
<tr class="separator:aeb6231b1a4894a9a0bd2e27a50cd1e9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb176a361ea7ed244bf184b14839de37" id="r_afb176a361ea7ed244bf184b14839de37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ntlmauth_8cc.html#afb176a361ea7ed244bf184b14839de37">ntlm_make_nonce</a> (char *nonce)</td></tr>
<tr class="separator:afb176a361ea7ed244bf184b14839de37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eccd99e37894904e786e83836f92954" id="r_a9eccd99e37894904e786e83836f92954"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ntlmauth_8cc.html#a9eccd99e37894904e786e83836f92954">ntlm_make_challenge</a> (<a class="el" href="ntlmauth_8h.html#a36afb82f35e15e1ab4f127279e8d4ed6">ntlm_challenge</a> *ch, const char *domain, const char *, const char *challenge_nonce, const <a class="el" href="stub__fd_8cc.html#a2f81796204b7bbe80bac6d6599203024">int</a> challenge_nonce_len, const uint32_t flags)</td></tr>
<tr class="separator:a9eccd99e37894904e786e83836f92954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dfc656a110298d8731c06cb46aad672" id="r_a0dfc656a110298d8731c06cb46aad672"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654">NtlmError</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ntlmauth_8cc.html#a0dfc656a110298d8731c06cb46aad672">ntlm_unpack_auth</a> (const <a class="el" href="ntlmauth_8h.html#a2fe6ee08c415029a8cb3de1b6e76f445">ntlm_authenticate</a> *auth, char *user, char *domain, const int32_t <a class="el" href="ModDevPoll_8cc.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</td></tr>
<tr class="separator:a0dfc656a110298d8731c06cb46aad672"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aeb6231b1a4894a9a0bd2e27a50cd1e9c" name="aeb6231b1a4894a9a0bd2e27a50cd1e9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb6231b1a4894a9a0bd2e27a50cd1e9c">&#9670;&#160;</a></span>ntlm_add_to_payload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ntlm_add_to_payload </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ntlmauth_8h.html#ad5f9fd7eace03bd3ad3c6b88fd59671e">ntlmhdr</a> *&#160;</td>
          <td class="paramname"><em>packet_hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stub__fd_8cc.html#a2f81796204b7bbe80bac6d6599203024">int</a> *&#160;</td>
          <td class="paramname"><em>payload_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ntlmauth_8h.html#a646ceac26b877d96395e67e952ed4a6b">strhdr</a> *&#160;</td>
          <td class="paramname"><em>hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>toadd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>toadd_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds something to the payload. The caller must guarantee that there is enough space in the payload string to accommodate the added value. payload_length and hdr will be modified as a side-effect. </p>

<p class="definition">Definition at line <a class="el" href="ntlmauth_8cc_source.html#l00165">165</a> of file <a class="el" href="ntlmauth_8cc_source.html">ntlmauth.cc</a>.</p>

<p class="reference">References <a class="el" href="support__endian_8h.html#a3ea73a6089f61223b225c46e2ba58a47">htole16</a>, <a class="el" href="support__endian_8h.html#a9bea1e76e277f13ae39ac86095510bfa">htole32</a>, <a class="el" href="struct__strhdr.html#aec0e8fec4c0567c66bffe584ecb8debd">_strhdr::len</a>, <a class="el" href="struct__strhdr.html#a0713226fbd56c8e812032d3c20d7d32b">_strhdr::maxlen</a>, and <a class="el" href="struct__strhdr.html#aa9a93757ad6e4860614e4a1a5713d41e">_strhdr::offset</a>.</p>

<p class="reference">Referenced by <a class="el" href="ntlmauth_8cc.html#a9eccd99e37894904e786e83836f92954">ntlm_make_challenge()</a>.</p>

</div>
</div>
<a id="ab7c8849f3a775f9ec146d3a42778d291" name="ab7c8849f3a775f9ec146d3a42778d291"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7c8849f3a775f9ec146d3a42778d291">&#9670;&#160;</a></span>ntlm_dump_ntlmssp_flags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ntlm_dump_ntlmssp_flags </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Dumps NTLM flags to standard error for debugging purposes </p>

<p class="definition">Definition at line <a class="el" href="ntlmauth_8cc_source.html#l00030">30</a> of file <a class="el" href="ntlmauth_8cc_source.html">ntlmauth.cc</a>.</p>

<p class="reference">References <a class="el" href="ntlmauth_8h.html#ae460064a63430c510f4c88d480e9bd04">NTLM_CHALLENGE_TARGET_IS_DOMAIN</a>, <a class="el" href="ntlmauth_8h.html#acb00816c27739215907a2bb8641f7f62">NTLM_CHALLENGE_TARGET_IS_SERVER</a>, <a class="el" href="ntlmauth_8h.html#a9b7126be06783ba0c170e9c2dc3e03ca">NTLM_CHALLENGE_TARGET_IS_SHARE</a>, <a class="el" href="ntlmauth_8h.html#af17b0ea7fafdd30da6fbdbfeb3deb030">NTLM_NEGOTIATE_ALWAYS_SIGN</a>, <a class="el" href="ntlmauth_8h.html#ac45124fd3aa4da465a5ce8f51a05c3b7">NTLM_NEGOTIATE_ASCII</a>, <a class="el" href="ntlmauth_8h.html#a794b8f585a5a80b3f37e979ead187b17">NTLM_NEGOTIATE_DATAGRAM_STYLE</a>, <a class="el" href="ntlmauth_8h.html#a3945722452953e707585d71055d2cd37">NTLM_NEGOTIATE_DOMAIN_SUPPLIED</a>, <a class="el" href="ntlmauth_8h.html#a2a5edc64642c56278775acebf936e978">NTLM_NEGOTIATE_REQUEST_SEAL</a>, <a class="el" href="ntlmauth_8h.html#a7707427c01b85402653332aad7b0c365">NTLM_NEGOTIATE_REQUEST_SIGN</a>, <a class="el" href="ntlmauth_8h.html#a46e461dc71033c9d042dc452e7ca782f">NTLM_NEGOTIATE_REQUEST_TARGET</a>, <a class="el" href="ntlmauth_8h.html#aae62b50c3a666ba7e8f4aea075cfcb07">NTLM_NEGOTIATE_THIS_IS_LOCAL_CALL</a>, <a class="el" href="ntlmauth_8h.html#a366d03c98252fe7641e206ca5a60535d">NTLM_NEGOTIATE_UNICODE</a>, <a class="el" href="ntlmauth_8h.html#a7cd2dcd625ae4ac6bebc1c639a077c4d">NTLM_NEGOTIATE_USE_LM</a>, <a class="el" href="ntlmauth_8h.html#a6fe6b1a264f225f3506294da386e07f8">NTLM_NEGOTIATE_USE_NETWARE</a>, <a class="el" href="ntlmauth_8h.html#a616b10f92f60c72fbbdbfa2b92571904">NTLM_NEGOTIATE_USE_NTLM</a>, <a class="el" href="ntlmauth_8h.html#ad66c6fd916142407657619df8c27bd1e">NTLM_NEGOTIATE_WORKSTATION_SUPPLIED</a>, <a class="el" href="ntlmauth_8h.html#a05203cda90c68017a5c3f80576aa8ea6">NTLM_REQUEST_ACCEPT_RESPONSE</a>, <a class="el" href="ntlmauth_8h.html#acf4e4eb85073c10c5a13fbe14d1d2af3">NTLM_REQUEST_INIT_RESPONSE</a>, and <a class="el" href="ntlmauth_8h.html#a246edb7be03b77e87ec3da77ce0b7166">NTLM_REQUEST_NON_NT_SESSION_KEY</a>.</p>

</div>
</div>
<a id="ac5706ef5b4d90b6fb8a0544fb39ad735" name="ac5706ef5b4d90b6fb8a0544fb39ad735"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5706ef5b4d90b6fb8a0544fb39ad735">&#9670;&#160;</a></span>ntlm_fetch_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ntlmauth_8h.html#acb3571be89fc778d4c2cb2d1fe9857ff">lstring</a> ntlm_fetch_string </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ntlmauth_8h.html#ad5f9fd7eace03bd3ad3c6b88fd59671e">ntlmhdr</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>packet_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ntlmauth_8h.html#a646ceac26b877d96395e67e952ed4a6b">strhdr</a> *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fetches a string from the authentication packet. The lstring data-part may point to inside the packet itself or a temporary static buffer. It's up to the user to memcpy() that if the value needs to be used in any way that requires a tailing \0. (can check whether the value is there though, in that case lstring.length == -1).</p>
<p><a class="el" href="classString.html">String</a> may be either ASCII or UNICODE depending on whether flags contains NTLM_NEGOTIATE_ASCII </p>

<p class="definition">Definition at line <a class="el" href="ntlmauth_8cc_source.html#l00098">98</a> of file <a class="el" href="ntlmauth_8cc_source.html">ntlmauth.cc</a>.</p>

<p class="reference">References <a class="el" href="compat_2debug_8cc.html#adacf73b93ca6fa3985f2999f7d6b3b29">debug()</a>, <a class="el" href="struct__lstring.html#ae456a318d977949779a032496ae66567">_lstring::l</a>, <a class="el" href="support__endian_8h.html#a684a5d26d1989cbd925e97292cc81c72">le16toh</a>, <a class="el" href="support__endian_8h.html#ad2dfbafcefb3add65ea44e581398e90a">le32toh</a>, <a class="el" href="struct__strhdr.html#aec0e8fec4c0567c66bffe584ecb8debd">_strhdr::len</a>, <a class="el" href="ntlmauth_8h.html#a07082d3bf42d6e873804dfb7211c0cf5">NTLM_MAX_FIELD_LENGTH</a>, <a class="el" href="ntlmauth_8h.html#ac45124fd3aa4da465a5ce8f51a05c3b7">NTLM_NEGOTIATE_ASCII</a>, <a class="el" href="struct__strhdr.html#aa9a93757ad6e4860614e4a1a5713d41e">_strhdr::offset</a>, <a class="el" href="struct__lstring.html#a2fe24253fc4e6820915d53977a884137">_lstring::str</a>, and <a class="el" href="xis_8h.html#afb9643867ba3784300e08f4b6ba2a1a3">xisprint</a>.</p>

<p class="reference">Referenced by <a class="el" href="ntlmauth_8cc.html#a0dfc656a110298d8731c06cb46aad672">ntlm_unpack_auth()</a>.</p>

</div>
</div>
<a id="a9eccd99e37894904e786e83836f92954" name="a9eccd99e37894904e786e83836f92954"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9eccd99e37894904e786e83836f92954">&#9670;&#160;</a></span>ntlm_make_challenge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ntlm_make_challenge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ntlmauth_8h.html#a36afb82f35e15e1ab4f127279e8d4ed6">ntlm_challenge</a> *&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>domain_controller</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>challenge_nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stub__fd_8cc.html#a2f81796204b7bbe80bac6d6599203024">int</a>&#160;</td>
          <td class="paramname"><em>challenge_nonce_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prepares a challenge packet to be sent to the client </p><dl class="section note"><dt>Note</dt><dd>domain should be upper_case </dd></dl>

<p class="definition">Definition at line <a class="el" href="ntlmauth_8cc_source.html#l00210">210</a> of file <a class="el" href="ntlmauth_8cc_source.html">ntlmauth.cc</a>.</p>

<p class="reference">References <a class="el" href="struct__ntlm__challenge.html#a07e5ae7a54c3f4ff7ebfaa0ce6a6682f">_ntlm_challenge::challenge</a>, <a class="el" href="struct__ntlm__challenge.html#a401e6cdc0d5049d7fe8eb8c805c257c0">_ntlm_challenge::context_high</a>, <a class="el" href="struct__ntlm__challenge.html#ac919b7376de7d3c8bf7b287f5835c757">_ntlm_challenge::context_low</a>, <a class="el" href="struct__ntlm__challenge.html#a98045ef15fcb54b601bc1b520406cad3">_ntlm_challenge::flags</a>, <a class="el" href="struct__ntlm__challenge.html#a883cc88fd2dd2aa29df1a4c50c0c70d8">_ntlm_challenge::hdr</a>, <a class="el" href="support__endian_8h.html#a9bea1e76e277f13ae39ac86095510bfa">htole32</a>, <a class="el" href="ntlmauth_8cc.html#aeb6231b1a4894a9a0bd2e27a50cd1e9c">ntlm_add_to_payload()</a>, <a class="el" href="ntlmauth_8h.html#a9c451e2cf4bc9480739f85c8c356a999">NTLM_CHALLENGE</a>, <a class="el" href="struct__ntlm__challenge.html#a9bd594727e6c28747f94c1ecdc3d8741">_ntlm_challenge::payload</a>, <a class="el" href="struct__ntlmhdr.html#adf86b7d973296f94fc9d894766ebcf8f">_ntlmhdr::signature</a>, <a class="el" href="struct__ntlm__challenge.html#a3c81085328ce4e26d9c69f0a04d487c7">_ntlm_challenge::target</a>, and <a class="el" href="struct__ntlmhdr.html#a78c750a1488bc39ffd6042ff003b5e4e">_ntlmhdr::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="ntlm__fake__auth_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="afb176a361ea7ed244bf184b14839de37" name="afb176a361ea7ed244bf184b14839de37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb176a361ea7ed244bf184b14839de37">&#9670;&#160;</a></span>ntlm_make_nonce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ntlm_make_nonce </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>nonce</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate a challenge request nonce. </p>

<p class="definition">Definition at line <a class="el" href="ntlmauth_8cc_source.html#l00196">196</a> of file <a class="el" href="ntlmauth_8cc_source.html">ntlmauth.cc</a>.</p>

<p class="reference">References <a class="el" href="ntlmauth_8h.html#ad07162fe35d0aab30b54bc641479ee0a">NTLM_NONCE_LEN</a>.</p>

<p class="reference">Referenced by <a class="el" href="ntlm__fake__auth_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="a0dfc656a110298d8731c06cb46aad672" name="a0dfc656a110298d8731c06cb46aad672"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dfc656a110298d8731c06cb46aad672">&#9670;&#160;</a></span>ntlm_unpack_auth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654">NtlmError</a> ntlm_unpack_auth </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ntlmauth_8h.html#a2fe6ee08c415029a8cb3de1b6e76f445">ntlm_authenticate</a> *&#160;</td>
          <td class="paramname"><em>auth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unpack the strings in an NTLM authentication response from client. The caller is responsible for initializing the user and domain buffers this function will only insert data if the packet contains any. Otherwise the buffers will be left untouched.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654a6adf97f83acf6453d4a6a4b1070f3754">NtlmError::None</a></td><td>username present, maybe also domain. </td></tr>
    <tr><td class="paramname"><a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654aca3da8f495e4e628912a7798655da6c2">NtlmError::ProtocolError</a></td><td>packet type is not an authentication packet. </td></tr>
    <tr><td class="paramname"><a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654a3404f7f59a50f67a3c5f4cc0c71debe8">NtlmError::LoginEror</a></td><td>no username. </td></tr>
    <tr><td class="paramname"><a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654a0f9795644c10b535f90f05facdddcf90">NtlmError::BlobError</a></td><td>domain field is apparently larger than the packet. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ntlmauth_8cc_source.html#l00247">247</a> of file <a class="el" href="ntlmauth_8cc_source.html">ntlmauth.cc</a>.</p>

<p class="reference">References <a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654a0f9795644c10b535f90f05facdddcf90">BlobError</a>, <a class="el" href="compat_2debug_8cc.html#adacf73b93ca6fa3985f2999f7d6b3b29">debug()</a>, <a class="el" href="struct__ntlm__authenticate.html#a5ae358a3fedfef50a76e0795691edd2d">_ntlm_authenticate::domain</a>, <a class="el" href="struct__ntlm__authenticate.html#a16988d31595f9cfa1bf58bff645f2744">_ntlm_authenticate::flags</a>, <a class="el" href="struct__ntlm__authenticate.html#a16345e7f64393d26392a7b357ebbcc6c">_ntlm_authenticate::hdr</a>, <a class="el" href="struct__lstring.html#ae456a318d977949779a032496ae66567">_lstring::l</a>, <a class="el" href="support__endian_8h.html#ad2dfbafcefb3add65ea44e581398e90a">le32toh</a>, <a class="el" href="struct__strhdr.html#aec0e8fec4c0567c66bffe584ecb8debd">_strhdr::len</a>, <a class="el" href="struct__ntlm__authenticate.html#a98b27b58fc11b053ba4cd1021573ebb7">_ntlm_authenticate::lmresponse</a>, <a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654a3404f7f59a50f67a3c5f4cc0c71debe8">LoginEror</a>, <a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654a6adf97f83acf6453d4a6a4b1070f3754">None</a>, <a class="el" href="ntlmauth_8h.html#a34df54c67adb6b1d674903d2551180e5">NTLM_AUTHENTICATE</a>, <a class="el" href="ntlmauth_8cc.html#ac5706ef5b4d90b6fb8a0544fb39ad735">ntlm_fetch_string()</a>, <a class="el" href="ntlmauth_8h.html#a07082d3bf42d6e873804dfb7211c0cf5">NTLM_MAX_FIELD_LENGTH</a>, <a class="el" href="ntlmauth_8cc.html#a40e6a35f49b9f6db37dc4876807edde8">ntlm_validate_packet()</a>, <a class="el" href="struct__ntlm__authenticate.html#a84ed58d983d0c15f132a5d54daddc5d7">_ntlm_authenticate::ntresponse</a>, <a class="el" href="struct__strhdr.html#aa9a93757ad6e4860614e4a1a5713d41e">_strhdr::offset</a>, <a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654aca3da8f495e4e628912a7798655da6c2">ProtocolError</a>, <a class="el" href="struct__ntlm__authenticate.html#aaf91c93a22956401e78c27ccec27c099">_ntlm_authenticate::sessionkey</a>, <a class="el" href="ModDevPoll_8cc.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, <a class="el" href="struct__lstring.html#a2fe24253fc4e6820915d53977a884137">_lstring::str</a>, <a class="el" href="struct__ntlm__authenticate.html#af3f6a177e9e33cb98c5276f20fe568d5">_ntlm_authenticate::user</a>, and <a class="el" href="struct__ntlm__authenticate.html#ae64ef08800c9af19770d946ceac2b690">_ntlm_authenticate::workstation</a>.</p>

<p class="reference">Referenced by <a class="el" href="ntlm__fake__auth_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="a40e6a35f49b9f6db37dc4876807edde8" name="a40e6a35f49b9f6db37dc4876807edde8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40e6a35f49b9f6db37dc4876807edde8">&#9670;&#160;</a></span>ntlm_validate_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654">NtlmError</a> ntlm_validate_packet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ntlmauth_8h.html#ad5f9fd7eace03bd3ad3c6b88fd59671e">ntlmhdr</a> *&#160;</td>
          <td class="paramname"><em>hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check the validity of a decoded NTLM packet.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654a6adf97f83acf6453d4a6a4b1070f3754">NtlmError::None</a></td><td>Packet is okay </td></tr>
    <tr><td class="paramname"><a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654a0f9795644c10b535f90f05facdddcf90">NtlmError::BlobError</a></td><td>Packet is not even an NTLMSSP packet at all. </td></tr>
    <tr><td class="paramname"><a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654aca3da8f495e4e628912a7798655da6c2">NtlmError::ProtocolError</a></td><td>Packet is not the expected type. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ntlmauth_8cc_source.html#l00067">67</a> of file <a class="el" href="ntlmauth_8cc_source.html">ntlmauth.cc</a>.</p>

<p class="reference">References <a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654a0f9795644c10b535f90f05facdddcf90">BlobError</a>, <a class="el" href="compat_2debug_8cc.html#adacf73b93ca6fa3985f2999f7d6b3b29">debug()</a>, <a class="el" href="support__endian_8h.html#ad2dfbafcefb3add65ea44e581398e90a">le32toh</a>, <a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654a6adf97f83acf6453d4a6a4b1070f3754">None</a>, <a class="el" href="ntlmauth_8h.html#ab99ccf821fe6af3ecf2530af842e331b">NTLM_ANY</a>, <a class="el" href="ntlmauth_8h.html#a8e729efaace1807c0446d86f98c3e654aca3da8f495e4e628912a7798655da6c2">ProtocolError</a>, <a class="el" href="struct__ntlmhdr.html#adf86b7d973296f94fc9d894766ebcf8f">_ntlmhdr::signature</a>, and <a class="el" href="struct__ntlmhdr.html#a78c750a1488bc39ffd6042ff003b5e4e">_ntlmhdr::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="ntlm__fake__auth_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="ntlmauth_8cc.html#a0dfc656a110298d8731c06cb46aad672">ntlm_unpack_auth()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3c69fff7f634b97773a4d39d4565ffb4.html">squid</a></li><li class="navelem"><a class="el" href="dir_94dae81ba4a513a137753445de77fca5.html">lib</a></li><li class="navelem"><a class="el" href="dir_2f70efcc2970118a194fcf01c98a87b0.html">ntlmauth</a></li><li class="navelem"><a class="el" href="ntlmauth_8cc.html">ntlmauth.cc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
