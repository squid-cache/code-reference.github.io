<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Squid Web Cache: Coding and Other Conventions used in Squid</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Squid Web Cache<span id="projectnumber">&#160;master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('Conventions.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Coding and Other Conventions used in Squid</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Coding"></a>
Code Conventions</h1>
<dl class="section user"><dt></dt><dd>Most custom types and tools are documented in the code or the relevant portions of this manual. Some key points apply globally however.</dd></dl>
<h1><a class="anchor" id="FWT"></a>
Fixed Width types</h1>
<dl class="section user"><dt></dt><dd>If you need to use specific width types - such as a 16 bit unsigned integer, use one of the following types. To access them simply include "squid.h".</dd></dl>
<pre class="fragment">        int16_t    -  16 bit signed.
        uint16_t  -  16 bit unsigned.
        int32_t    -  32 bit signed.
        uint32_t  -  32 bit unsigned.
        int64_t    -  64 bit signed.
        uint64_t  -  64 bit unsigned.
</pre><h1><a class="anchor" id="Documentation"></a>
Documentation Conventions</h1>
<dl class="section user"><dt></dt><dd>Now that documentation is generated automatically from the sources some common comment conventions need to be adopted.</dd></dl>
<h2><a class="anchor" id="CommentComponents"></a>
API vs Internal Component Commenting</h2>
<dl class="section user"><dt></dt><dd>First among these is a definition separation between component API and Internal operations. API functions and objects should always be commented and in the *.h file for the component. Internal logic and objects should be commented in the *.cc file where they are defined. The group is to be defined in the components main files with the overview paragraphs about the API usage or component structure.</dd></dl>
<dl class="section user"><dt></dt><dd>With C++ classes it is easy to separate API and Internals with the C++ public: and private: distinctions on whichever class defines the component API. An Internal group may not be required if there are no additional items in the Internals (rare as globals are common in squid).</dd></dl>
<dl class="section user"><dt></dt><dd>With unconverted modules still coded in Objective-C, the task is harder. In these cases two sub-groups must be defined *API and *Internal into which naturally individual functions, variables, etc. are grouped using the <b>\ingroup</b> tag. The API group is usually a sub-group of Components and the Internal is always a sub-group of the API.</dd></dl>
<dl class="section user"><dt>Rule of thumb:</dt><dd>For both items, if its referenced from elsewhere in the code or defined in the .h file it should be part of the API. Everything else should be in the Internals group and kept out of the .h file.</dd></dl>
<h2><a class="anchor" id="FunctionComments"></a>
Function/Method Comments</h2>
<dl class="section user"><dt></dt><dd>All descriptions may be more than one line, and while whitespace formatting is ignored by doxygen, it is good to keep it clear for manual reading of the code.</dd></dl>
<dl class="section user"><dt></dt><dd>Any text directly following a <b>\par</b> tag will be highlighted in bold automatically (like all the 'For Examples' below) so be careful what is placed there.</dd></dl>
<h3><a class="anchor" id="PARAM"></a>
Function Parameters</h3>
<dl class="section user"><dt></dt><dd>Function and Method parameters MUST be named in both the definition and in the declaration, and they also MUST be the same text. The doxygen parser needs them to be identical to accurately link the two with documentation. Particularly linking function with documentation of the label itself.</dd></dl>
<dl class="section user"><dt></dt><dd>Each function that takes parameters should have the possible range of values commented in the pre-function descriptor. For API function this is as usual in the .h file, for Internal functions it is i the .(cc|cci) file.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>\param</b> tag is used to describe these. It takes two required parameters; the name of the function parameter being documented followed immediately by either [in], [out], or [in,out]. Followed by an optional description of what the parameter represents.</dd></dl>
<dl class="section user"><dt>For Example:</dt><dd><pre class="fragment">/**
 \param g[out]      Buffer to receive something
 \param glen[in]    Length of buffer available to write
 */
void
X::getFubar(char *g, int glen)
...
</pre></dd></dl>
<h3><a class="anchor" id="RETVAL"></a>
Return Values</h3>
<dl class="section user"><dt></dt><dd>Each function that returns a value should have the possible range of values commented in the pre-function descriptor. </dd></dl>
<dl class="section user"><dt></dt><dd>The <b>\retval</b> tag is used to describe these. It takes one required parameter; the value or range of values returned. Followed by an optional description of what/why of that value.</dd></dl>
<dl class="section user"><dt>For Example:</dt><dd><pre class="fragment">/**
 \retval 0  when FUBAR does not start with 'F'
 \retval 1  when FUBAR starts with F
 */
int
X::saidFubar()
...
</pre></dd></dl>
<dl class="section user"><dt>Alternatively</dt><dd>when a state or other context-dependent object is returned the <b>\return</b> tag is used. It is followed by a description of the object and ideally its content.</dd></dl>
<h3><a class="anchor" id="FLOW"></a>
Function Actions / Internal Flows</h3>
<dl class="section user"><dt>Simple functions</dt><dd>do not exactly need a detailed description of their operation. The <a class="el" href="Conventions.html#PARAM">Function Parameters</a> and <a class="el" href="Conventions.html#RETVAL">Return Values</a> should be enough for any developer to understand the function.</dd></dl>
<dl class="section user"><dt>Long or Complex Functions</dt><dd>do however need some commenting. A well-designed function does all its operations in distinct blocks; <ul>
<li>Input validation </li>
<li>Processing on some state </li>
<li>Processing on the output of that earlier processing </li>
<li>etc, etc.</li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>Each of these design blocks inside the function should be given a comment indicating what they do. The comments should begin with <pre class="fragment">/** \\par </pre> The resulting function description will then contain a paragraph on each of the blocks in the order they occur in the function.</dd></dl>
<dl class="section user"><dt>For example:</dt><dd><pre class="fragment">/**
 \param g   The buffer to be used
 \param glen    Length of buffer provided
 \param state   Object of type X storing foo
 */
void
fubar(char *g, int glen, void *state) {
</pre> Designed validation part of the function <pre class="fragment">    /** \par
     * When g is NULL or gen is 0 nothing is done */
    if(g == NULL || glen &lt; 1)
        return;

   /** \par
     * When glen is longer than the accepted length it gets truncated */
   if(glen &gt; MAX_FOO) glen = MAX_FOO;
</pre> now we get on to the active part of the function <pre class="fragment">   /** \par
     * Appends up to MAX_FOO bytes from g onto the end of state-&gt;foo
     * then passes the state off to FUBAR.
     * No check for null-termination is done.
     */
   memcpy(g, glen, state-&gt;foo_end_ptr );
   state-&gt;foo_end_ptr += glen;
   fubar(state);
}
</pre></dd></dl>
<dl class="section user"><dt></dt><dd>Of course, this is a very simple example. This type of comment should only be needed in the larger functions with many side effects. A function this small could reasonably have all its commenting done just ahead of the parameter description. </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
