<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Squid Web Cache: squid/src/tools.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Squid Web Cache<span id="projectnumber">&#160;master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('tools_8cc_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">tools.cc</div></div>
</div><!--header-->
<div class="contents">
<a href="tools_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> * Copyright (C) 1996-2026 The Squid Software Foundation and contributors</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> *</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> * Squid software is distributed under GPLv2+ license and includes</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * contributions from numerous individuals and organizations.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * Please see the COPYING and CONTRIBUTORS files for details.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> */</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">/* DEBUG: section 21    Misc Functions */</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &quot;<a class="code" href="squid_8h.html">squid.h</a>&quot;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &quot;<a class="code" href="PortCfg_8h.html">anyp/PortCfg.h</a>&quot;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &quot;<a class="code" href="Subscription_8h.html">base/Subscription.h</a>&quot;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &quot;<a class="code" href="client__side_8h.html">client_side.h</a>&quot;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;<a class="code" href="unistd_8h.html">compat/unistd.h</a>&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;<a class="code" href="fatal_8h.html">fatal.h</a>&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;<a class="code" href="fde_8h.html">fde.h</a>&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &quot;<a class="code" href="fqdncache_8h.html">fqdncache.h</a>&quot;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;<a class="code" href="fs__io_8h.html">fs_io.h</a>&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &quot;<a class="code" href="htcp_8h.html">htcp.h</a>&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &quot;<a class="code" href="http_2Stream_8h.html">http/Stream.h</a>&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &quot;<a class="code" href="ICP_8h.html">ICP.h</a>&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &quot;<a class="code" href="Intercept_8h.html">ip/Intercept.h</a>&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="QosConfig_8h.html">ip/QosConfig.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="Coordinator_8h.html">ipc/Coordinator.h</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="Kids_8h.html">ipc/Kids.h</a>&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="ipcache_8h.html">ipcache.h</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="MemBuf_8h.html">MemBuf.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="sbuf_2Stream_8h.html">sbuf/Stream.h</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="SquidConfig_8h.html">SquidConfig.h</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="SquidMath_8h.html">SquidMath.h</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="Disks_8h.html">store/Disks.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &quot;<a class="code" href="tools_8h.html">tools.h</a>&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;<a class="code" href="wordlist_8h.html">wordlist.h</a>&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &lt;cerrno&gt;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#if HAVE_SYS_CAPABILITY_H</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &lt;sys/capability.h&gt;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#if HAVE_SYS_PRCTL_H</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &lt;sys/prctl.h&gt;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#if HAVE_SYS_PROCCTL_H</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#include &lt;sys/procctl.h&gt;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#if HAVE_PRIV_H</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#include &lt;priv.h&gt;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#if HAVE_PSAPI_H</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &lt;psapi.h&gt;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#if HAVE_SYS_STAT_H</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="preprocessor">#if HAVE_SYS_WAIT_H</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#include &lt;sys/wait.h&gt;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#if HAVE_GRP_H</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="preprocessor">#include &lt;grp.h&gt;</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno"><a class="line" href="tools_8cc.html#a70f753e1b684b3b9a4cefbc91b87d323">   62</a></span><span class="preprocessor">#define DEAD_MSG &quot;\</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="preprocessor">The Squid Cache (version %s) died.\n\</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="preprocessor">\n\</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="preprocessor">You&#39;ve encountered a fatal error in the Squid Cache version %s.\n\</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="preprocessor">If a core file was created (possibly in the swap directory),\n\</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="preprocessor">please execute &#39;gdb squid core&#39; or &#39;dbx squid core&#39;, then type &#39;where&#39;,\n\</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="preprocessor">and report the trace back to squid-bugs@lists.squid-cache.org.\n\</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="preprocessor">\n\</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="preprocessor">Thanks!\n&quot;</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="tools_8cc.html#a913579133199a9fb7b4c5f52500449cb">mail_warranty</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="tools_8cc.html#aa2651f5e7d5ea2941a2004f3b115aa5f">restoreCapabilities</a>(<span class="keywordtype">bool</span> keep);</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno"><a class="line" href="tools_8cc.html#aa82acdab9e76fb7e5f1e527dd3743af7">   74</a></span><span class="keywordtype">int</span> <a class="code hl_variable" href="tools_8cc.html#aa82acdab9e76fb7e5f1e527dd3743af7">DebugSignal</a> = -1;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno"><a class="line" href="tools_8cc.html#a688c14dce4c0f8b98f4477810a47cdf7">   75</a></span><a class="code hl_class" href="classSBuf.html">SBuf</a> <a class="code hl_variable" href="tools_8cc.html#a688c14dce4c0f8b98f4477810a47cdf7">service_name</a>(<a class="code hl_define" href="version_8h.html#acaa588a71a8c9170b999736091d8b1bc">APP_SHORTNAME</a>);</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="preprocessor">#if _SQUID_LINUX_</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span><span class="comment">/* Workaround for crappy glic header files */</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><a class="code hl_define" href="squid_8h.html#a5a27f30c91ea4f16ae5ea4cf73a3af1e">SQUIDCEXTERN</a> <span class="keywordtype">int</span> backtrace(<span class="keywordtype">void</span> *, <span class="keywordtype">int</span>);</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span><a class="code hl_define" href="squid_8h.html#a5a27f30c91ea4f16ae5ea4cf73a3af1e">SQUIDCEXTERN</a> <span class="keywordtype">void</span> backtrace_symbols_fd(<span class="keywordtype">void</span> *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span><a class="code hl_define" href="squid_8h.html#a5a27f30c91ea4f16ae5ea4cf73a3af1e">SQUIDCEXTERN</a> <span class="keywordtype">int</span> setresuid(uid_t, uid_t, uid_t);</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span><span class="preprocessor">#else </span><span class="comment">/* _SQUID_LINUX_ */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="comment">/* needed on Opensolaris for backtrace_symbols_fd */</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="preprocessor">#if HAVE_EXECINFO_H</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span><span class="preprocessor">#include &lt;execinfo.h&gt;</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_EXECINFO_H */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="preprocessor">#endif </span><span class="comment">/* _SQUID_LINUX */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno"><a class="line" href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">   90</a></span><span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">tmp_error_buf</a>[32768]; <span class="comment">/* 32KB */</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00093" data-start="{" data-end="}">
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno"><a class="line" href="tools_8cc.html#ae01a14bde16513f1e27bdc329a07d8c6">   93</a></span><a class="code hl_function" href="tools_8cc.html#ae01a14bde16513f1e27bdc329a07d8c6">releaseServerSockets</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>{</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <span class="comment">// Release the main ports as early as possible</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    <span class="comment">// clear http_port, https_port, and ftp_port lists</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <a class="code hl_function" href="client__side_8cc.html#ae29c88c073239e35ef8f8a82e9d5f689">clientConnectionsClose</a>();</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    <span class="comment">// clear icp_port&#39;s</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <a class="code hl_function" href="group__ServerProtocolICPAPI.html#gaaab2644af97fc6b985191a986b334115">icpClosePorts</a>();</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    <span class="comment">// XXX: Why not the HTCP, SNMP, DNS ports as well?</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <span class="comment">// XXX: why does this differ from main closeServerConnections() anyway ?</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>}</div>
</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span><span class="keyword">static</span> <span class="keywordtype">char</span> *</div>
<div class="foldopen" id="foldopen00108" data-start="{" data-end="}">
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno"><a class="line" href="tools_8cc.html#a5211acae55fc0688663f278e5adb4fd2">  108</a></span><a class="code hl_function" href="tools_8cc.html#a5211acae55fc0688663f278e5adb4fd2">dead_msg</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>{</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    <a class="code hl_define" href="squid_8h.html#a9b17dd86bdde2e8cb89abe153a0f4f23">LOCAL_ARRAY</a>(<span class="keywordtype">char</span>, msg, 1024);</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    snprintf(msg, 1024, <a class="code hl_define" href="tools_8cc.html#a70f753e1b684b3b9a4cefbc91b87d323">DEAD_MSG</a>, <a class="code hl_variable" href="globals_8h.html#a8042d0ef3deb220500d4c3a0c1382f07">version_string</a>, <a class="code hl_variable" href="globals_8h.html#a8042d0ef3deb220500d4c3a0c1382f07">version_string</a>);</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="keywordflow">return</span> msg;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>}</div>
</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span> </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00116" data-start="{" data-end="}">
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno"><a class="line" href="tools_8cc.html#a913579133199a9fb7b4c5f52500449cb">  116</a></span><a class="code hl_function" href="tools_8cc.html#a913579133199a9fb7b4c5f52500449cb">mail_warranty</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>{</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    FILE *fp = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> command[256];</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span><span class="comment">     * NP: umask() takes the mask of bits we DONT want set.</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span><span class="comment">     *</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span><span class="comment">     * We want the current user to have read/write access</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span><span class="comment">     * and since this file will be passed to mailsystem,</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span><span class="comment">     * the group and other must have read access.</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span><span class="comment">     */</span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="types_8h.html#a51b5bca3280ca743227e9b07c4f839a1">mode_t</a> prev_umask=umask(S_IXUSR|S_IXGRP|S_IWGRP|S_IWOTH|S_IXOTH);</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span> </div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span><span class="preprocessor">#if HAVE_MKSTEMP</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <span class="keywordtype">char</span> filename[] = <span class="stringliteral">&quot;/tmp/squid-XXXXXX&quot;</span>;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <span class="keywordtype">int</span> tfd = mkstemp(filename);</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <span class="keywordflow">if</span> (tfd &lt; 0 || (fp = fdopen(tfd, <span class="stringliteral">&quot;w&quot;</span>)) == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>        umask(prev_umask);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    }</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    <span class="keywordtype">char</span> *filename;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="comment">// XXX tempnam is obsolete since POSIX.2008-1</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <span class="comment">// tmpfile is not an option, we want the created files to stick around</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <span class="keywordflow">if</span> ((filename = <a class="code hl_function" href="tempnam_8c.html#a2e4097d8f42453a291c13ba31fabb8fe">tempnam</a>(<span class="keyword">nullptr</span>, <a class="code hl_define" href="version_8h.html#acaa588a71a8c9170b999736091d8b1bc">APP_SHORTNAME</a>)) == <a class="code hl_define" href="types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>            (fp = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)) == <a class="code hl_define" href="types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>        umask(prev_umask);</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    }</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    umask(prev_umask);</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a2ac9602c982f06bd961c7f8cdc811c4a">EmailFrom</a>)</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>        fprintf(fp, <span class="stringliteral">&quot;From: %s\n&quot;</span>, <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a2ac9602c982f06bd961c7f8cdc811c4a">EmailFrom</a>);</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        fprintf(fp, <span class="stringliteral">&quot;From: %s@%s\n&quot;</span>, <a class="code hl_define" href="version_8h.html#acaa588a71a8c9170b999736091d8b1bc">APP_SHORTNAME</a>, <a class="code hl_function" href="tools_8cc.html#adbe2913b25bf470a7814f9ec4a0907d9">uniqueHostname</a>());</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    fprintf(fp, <span class="stringliteral">&quot;To: %s\n&quot;</span>, <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ab4795036e0bac3bea76a98114a49c3bd">adminEmail</a>);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    fprintf(fp, <span class="stringliteral">&quot;Subject: %s\n&quot;</span>, <a class="code hl_function" href="tools_8cc.html#a5211acae55fc0688663f278e5adb4fd2">dead_msg</a>());</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    fclose(fp);</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    snprintf(command, 256, <span class="stringliteral">&quot;%s %s &lt; %s&quot;</span>, <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#acc970d633b01dee4e5431a55dce44861">EmailProgram</a>, <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ab4795036e0bac3bea76a98114a49c3bd">adminEmail</a>, filename);</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    <span class="keywordflow">if</span> (system(command)) {}     <span class="comment">/* XXX should avoid system(3) */</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    unlink(filename);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span><span class="preprocessor">#if !HAVE_MKSTEMP</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <a class="code hl_define" href="negotiate__wrapper_8cc.html#a2c3897f7c46ca54a2e0dd7b24a40c7cb">xfree</a>(filename); <span class="comment">// tempnam() requires us to free its allocation</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>}</div>
</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00167" data-start="{" data-end="}">
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno"><a class="line" href="tools_8cc.html#ae172c5dc1ff2a4e1e5fa32f121a5325a">  167</a></span><a class="code hl_function" href="tools_8cc.html#ae172c5dc1ff2a4e1e5fa32f121a5325a">dumpMallocStats</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>{</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span><span class="preprocessor">#if HAVE_MSTATS &amp;&amp; HAVE_GNUMALLOC_H</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    <span class="keyword">struct </span>mstats ms = mstats();</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    fprintf(<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>(), <span class="stringliteral">&quot;\ttotal space in arena:  %6d KB\n&quot;</span>,</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>            (<span class="keywordtype">int</span>) (ms.bytes_total &gt;&gt; 10));</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    fprintf(<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>(), <span class="stringliteral">&quot;\tTotal free:            %6d KB %d%%\n&quot;</span>,</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>            (<span class="keywordtype">int</span>) (ms.bytes_free &gt;&gt; 10),</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>            <a class="code hl_function" href="namespaceMath.html#a5c5c74f00ace4f0a2b80f1b13900b6ce">Math::intPercent</a>(ms.bytes_free, ms.bytes_total));</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>}</div>
</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00181" data-start="{" data-end="}">
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno"><a class="line" href="tools_8cc.html#a4e2c8a2a4f25987670751ba91129ee64">  181</a></span><a class="code hl_function" href="tools_8cc.html#a4e2c8a2a4f25987670751ba91129ee64">squid_getrusage</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structrusage.html">rusage</a> *r)</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>{</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    memset(r, <span class="charliteral">&#39;\0&#39;</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structrusage.html">rusage</a>));</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span><span class="preprocessor">#if HAVE_GETRUSAGE &amp;&amp; defined(RUSAGE_SELF)</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span><span class="preprocessor">#if _SQUID_SOLARIS_</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="comment">/* Solaris 2.5 has getrusage() permission bug -- Arjan de Vet */</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <a class="code hl_function" href="tools_8cc.html#a7e908148934cae35e8e5f8b294f273f0">enter_suid</a>();</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    getrusage(RUSAGE_SELF, r);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span><span class="preprocessor">#if _SQUID_SOLARIS_</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <a class="code hl_function" href="tools_8cc.html#a08dbd97a5d802d0e1d9aa371fd78d833">leave_suid</a>();</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="preprocessor">#elif defined(PSAPI_VERSION)</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    <span class="comment">// Windows has an alternative method if there is no POSIX getrusage defined.</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="keywordflow">if</span> (WIN32_OS_version &gt;= _WIN_OS_WINNT) {</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        <span class="comment">/* On Windows NT and later call PSAPI.DLL for process Memory */</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        <span class="comment">/* information -- Guido Serassio                       */</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        HANDLE hProcess;</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        PROCESS_MEMORY_COUNTERS pmc;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        hProcess = OpenProcess(PROCESS_QUERY_INFORMATION |</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>                               PROCESS_VM_READ,</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>                               <a class="code hl_define" href="defines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, GetCurrentProcessId());</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        {</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>            <span class="comment">/* Microsoft CRT doesn&#39;t have getrusage function,  */</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>            <span class="comment">/* so we get process CPU time information from PSAPI.DLL. */</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>            FILETIME ftCreate, ftExit, ftKernel, ftUser;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>            <span class="keywordflow">if</span> (GetProcessTimes(hProcess, &amp;ftCreate, &amp;ftExit, &amp;ftKernel, &amp;ftUser)) {</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>                int64_t *ptUser = (int64_t *)&amp;ftUser;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>                int64_t tUser64 = *ptUser / 10;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>                int64_t *ptKernel = (int64_t *)&amp;ftKernel;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>                int64_t tKernel64 = *ptKernel / 10;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>                r-&gt;<a class="code hl_variable" href="structrusage.html#a42c294483743ea16b9a77f22a2e7660a">ru_utime</a>.tv_sec =(long)(tUser64 / 1000000);</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>                r-&gt;<a class="code hl_variable" href="structrusage.html#a7776ee7a6ec11f32ad4c8d1b0862ceb8">ru_stime</a>.tv_sec =(long)(tKernel64 / 1000000);</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>                r-&gt;<a class="code hl_variable" href="structrusage.html#a42c294483743ea16b9a77f22a2e7660a">ru_utime</a>.tv_usec =(long)(tUser64 % 1000000);</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>                r-&gt;<a class="code hl_variable" href="structrusage.html#a7776ee7a6ec11f32ad4c8d1b0862ceb8">ru_stime</a>.tv_usec =(long)(tKernel64 % 1000000);</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>                CloseHandle( hProcess );</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            }</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>        }</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>        <span class="keywordflow">if</span> (GetProcessMemoryInfo( hProcess, &amp;pmc, <span class="keyword">sizeof</span>(pmc))) {</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>            r-&gt;<a class="code hl_variable" href="structrusage.html#ac6be8a64711191559acb2a53b5aee13f">ru_maxrss</a>=(DWORD)(pmc.WorkingSetSize / getpagesize());</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>            r-&gt;<a class="code hl_variable" href="structrusage.html#aaab0520284d00829128c9d4f7b4e8e5c">ru_majflt</a>=pmc.PageFaultCount;</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>            CloseHandle( hProcess );</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        }</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        CloseHandle( hProcess );</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    }</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>}</div>
</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span> </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span><span class="keywordtype">double</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span> </div>
<div class="foldopen" id="foldopen00239" data-start="{" data-end="}">
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno"><a class="line" href="tools_8cc.html#a54bfd25568e58b17214890f121ada9f5">  239</a></span><a class="code hl_function" href="tools_8cc.html#a54bfd25568e58b17214890f121ada9f5">rusage_cputime</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structrusage.html">rusage</a> *r)</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>{</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="keywordflow">return</span> (<span class="keywordtype">double</span>) r-&gt;<a class="code hl_variable" href="structrusage.html#a7776ee7a6ec11f32ad4c8d1b0862ceb8">ru_stime</a>.tv_sec +</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>           (<a class="code hl_variable" href="stub__event_8cc.html#a0c9547f061079f5587b085091da968bc">double</a>) r-&gt;<a class="code hl_variable" href="structrusage.html#a42c294483743ea16b9a77f22a2e7660a">ru_utime</a>.tv_sec +</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>           (<span class="keywordtype">double</span>) r-&gt;<a class="code hl_variable" href="structrusage.html#a7776ee7a6ec11f32ad4c8d1b0862ceb8">ru_stime</a>.tv_usec / 1000000.0 +</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>           (<a class="code hl_variable" href="stub__event_8cc.html#a0c9547f061079f5587b085091da968bc">double</a>) r-&gt;<a class="code hl_variable" href="structrusage.html#a42c294483743ea16b9a77f22a2e7660a">ru_utime</a>.tv_usec / 1000000.0;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>}</div>
</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span><span class="comment">/* Hack for some HP-UX preprocessors */</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span><span class="preprocessor">#ifndef HAVE_GETPAGESIZE</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno"><a class="line" href="tools_8cc.html#add281e88fe03de68eb6833a0f7832cbc">  249</a></span><span class="preprocessor">#define HAVE_GETPAGESIZE 0</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span><span class="keywordtype">int</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="foldopen" id="foldopen00254" data-start="{" data-end="}">
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno"><a class="line" href="tools_8cc.html#a62d0b814ae850a3635a29f0aded17a1d">  254</a></span><a class="code hl_function" href="tools_8cc.html#a62d0b814ae850a3635a29f0aded17a1d">rusage_maxrss</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structrusage.html">rusage</a> *r)</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>{</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="preprocessor">#if _SQUID_SGI_ &amp;&amp; _ABIAPI</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    <span class="keywordflow">return</span> r-&gt;ru_pad[0];</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span><span class="preprocessor">#elif _SQUID_SGI_|| _SQUID_OSF_ || _SQUID_AIX_ || defined(BSD4_4)</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <span class="keywordflow">return</span> r-&gt;<a class="code hl_variable" href="structrusage.html#ac6be8a64711191559acb2a53b5aee13f">ru_maxrss</a>;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span><span class="preprocessor">#elif defined(HAVE_GETPAGESIZE) &amp;&amp; HAVE_GETPAGESIZE != 0</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    <span class="keywordflow">return</span> (r-&gt;<a class="code hl_variable" href="structrusage.html#ac6be8a64711191559acb2a53b5aee13f">ru_maxrss</a> * getpagesize()) &gt;&gt; 10;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span><span class="preprocessor">#elif defined(PAGESIZE)</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    <span class="keywordflow">return</span> (r-&gt;<a class="code hl_variable" href="structrusage.html#ac6be8a64711191559acb2a53b5aee13f">ru_maxrss</a> * PAGESIZE) &gt;&gt; 10;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    <span class="keywordflow">return</span> r-&gt;<a class="code hl_variable" href="structrusage.html#ac6be8a64711191559acb2a53b5aee13f">ru_maxrss</a>;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>}</div>
</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span><span class="keywordtype">int</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span> </div>
<div class="foldopen" id="foldopen00275" data-start="{" data-end="}">
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno"><a class="line" href="tools_8cc.html#ac3de63d7e63475e7e12abff8034ce1f4">  275</a></span><a class="code hl_function" href="tools_8cc.html#ac3de63d7e63475e7e12abff8034ce1f4">rusage_pagefaults</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structrusage.html">rusage</a> *r)</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>{</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span><span class="preprocessor">#if _SQUID_SGI_ &amp;&amp; _ABIAPI</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="keywordflow">return</span> r-&gt;ru_pad[5];</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    <span class="keywordflow">return</span> r-&gt;<a class="code hl_variable" href="structrusage.html#aaab0520284d00829128c9d4f7b4e8e5c">ru_majflt</a>;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>}</div>
</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span> </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00289" data-start="{" data-end="}">
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno"><a class="line" href="tools_8cc.html#a10f41cff25f01cde151c8f9b522a87da">  289</a></span><a class="code hl_function" href="tools_8cc.html#a10f41cff25f01cde151c8f9b522a87da">makeTraceable</a>()</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>{</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    <span class="keyword">const</span> <span class="keyword">auto</span> handleError = [](<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> syscall, <span class="keyword">const</span> <span class="keywordtype">int</span> savedErrno) {</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classTextException.html">TextException</a>(<a class="code hl_function" href="sbuf_2Stream_8h.html#a6160c2bd5c3883a54866ccfd670ce4b6">ToSBuf</a>(syscall, <span class="stringliteral">&quot; failure: &quot;</span>, <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(savedErrno)), <a class="code hl_define" href="Here_8h.html#ae4d205e9d525856fbdfd44f7eccb309b">Here</a>());</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    };</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span><span class="preprocessor">#if HAVE_PRCTL &amp;&amp; defined(PR_SET_DUMPABLE)</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <span class="keywordflow">if</span> (prctl(PR_SET_DUMPABLE, 1) != 0)</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        handleError(<span class="stringliteral">&quot;prctl(PR_SET_DUMPABLE)&quot;</span>, errno);</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span><span class="preprocessor">#elif HAVE_PROCCTL &amp;&amp; defined(PROC_TRACE_CTL)</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>    <span class="comment">// TODO: when FreeBSD 14 becomes the lowest version, we can</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    <span class="comment">// possibly save one getpid syscall, for now still necessary.</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    <span class="keywordtype">int</span> traceable = PROC_TRACE_CTL_ENABLE;</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    <span class="keywordflow">if</span> (procctl(P_PID, getpid(), PROC_TRACE_CTL, &amp;traceable) != 0)</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        handleError(<span class="stringliteral">&quot;procctl(PROC_TRACE_CTL_ENABLE)&quot;</span>, errno);</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span><span class="preprocessor">#elif HAVE_SETPFLAGS</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <span class="keywordflow">if</span> (setpflags(__PROC_PROTECT, 0) != 0)</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        handleError(<span class="stringliteral">&quot;setpflags(__PROC_PROTECT)&quot;</span>, errno);</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, 2, <span class="stringliteral">&quot;WARNING: Assuming this process is traceable&quot;</span>);</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    (void)handleError; <span class="comment">// just &quot;use&quot; the variable; there is no error here</span></div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>}</div>
</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00315" data-start="{" data-end="}">
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno"><a class="line" href="tools_8cc.html#a1046f2abceb2cbd87c41c5738963da42">  315</a></span><a class="code hl_function" href="tools_8cc.html#a1046f2abceb2cbd87c41c5738963da42">setTraceability</a>()</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>{</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    <span class="comment">// for now, setting coredump_dir is required to make the process traceable</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a696c5b17082eaf11e62e8a1696ce3515">coredump_dir</a>)</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>        <a class="code hl_function" href="tools_8cc.html#a10f41cff25f01cde151c8f9b522a87da">makeTraceable</a>();</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;ERROR: Cannot make the process traceable:&quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>               <a class="code hl_function" href="classDebug.html#a469eccf6573cacd9bc0682d3fc0eaf11">Debug::Extra</a> &lt;&lt; <span class="stringliteral">&quot;exception: &quot;</span> &lt;&lt; <a class="code hl_function" href="TextException_8cc.html#aa73ff10b84f321d18602cf47b8695dd5">CurrentException</a>);</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    }</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>}</div>
</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span> </div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00330" data-start="{" data-end="}">
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno"><a class="line" href="tools_8cc.html#a647dbf3a4a836003580c4df8a7447a32">  330</a></span><a class="code hl_function" href="tools_8cc.html#a647dbf3a4a836003580c4df8a7447a32">PrintRusage</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>{</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span> </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structrusage.html">rusage</a> <a class="code hl_struct" href="structrusage.html">rusage</a>;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <a class="code hl_function" href="tools_8cc.html#a4e2c8a2a4f25987670751ba91129ee64">squid_getrusage</a>(&amp;<a class="code hl_struct" href="structrusage.html">rusage</a>);</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    fprintf(<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>(), <span class="stringliteral">&quot;CPU Usage: %.3f seconds = %.3f user + %.3f sys\n&quot;</span>,</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>            <a class="code hl_function" href="tools_8cc.html#a54bfd25568e58b17214890f121ada9f5">rusage_cputime</a>(&amp;<a class="code hl_struct" href="structrusage.html">rusage</a>),</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>            <a class="code hl_struct" href="structrusage.html">rusage</a>.<a class="code hl_variable" href="structrusage.html#a42c294483743ea16b9a77f22a2e7660a">ru_utime</a>.tv_sec + ((<span class="keywordtype">double</span>) <a class="code hl_struct" href="structrusage.html">rusage</a>.<a class="code hl_variable" href="structrusage.html#a42c294483743ea16b9a77f22a2e7660a">ru_utime</a>.tv_usec / 1000000.0),</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>            <a class="code hl_struct" href="structrusage.html">rusage</a>.<a class="code hl_variable" href="structrusage.html#a7776ee7a6ec11f32ad4c8d1b0862ceb8">ru_stime</a>.tv_sec + ((<span class="keywordtype">double</span>) <a class="code hl_struct" href="structrusage.html">rusage</a>.<a class="code hl_variable" href="structrusage.html#a7776ee7a6ec11f32ad4c8d1b0862ceb8">ru_stime</a>.tv_usec / 1000000.0));</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    fprintf(<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>(), <span class="stringliteral">&quot;Maximum Resident Size: %d KB\n&quot;</span>,</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>            <a class="code hl_function" href="tools_8cc.html#a62d0b814ae850a3635a29f0aded17a1d">rusage_maxrss</a>(&amp;<a class="code hl_struct" href="structrusage.html">rusage</a>));</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    fprintf(<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>(), <span class="stringliteral">&quot;Page faults with physical i/o: %d\n&quot;</span>,</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>            <a class="code hl_function" href="tools_8cc.html#ac3de63d7e63475e7e12abff8034ce1f4">rusage_pagefaults</a>(&amp;<a class="code hl_struct" href="structrusage.html">rusage</a>));</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>}</div>
</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00346" data-start="{" data-end="}">
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno"><a class="line" href="tools_8cc.html#a32417db3c55ab0d11148b4443c179a55">  346</a></span><a class="code hl_function" href="tools_8cc.html#a32417db3c55ab0d11148b4443c179a55">death</a>(<span class="keywordtype">int</span> sig)</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>{</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    <span class="keywordflow">if</span> (sig == SIGSEGV)</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(1, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <a class="code hl_function" href="src_2debug_2debug_8cc.html#afa63af9ce4437935536dcc32dc78f232">ForceAlert</a> &lt;&lt; <span class="stringliteral">&quot;FATAL: Received Segment Violation...dying.&quot;</span>);</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sig == SIGBUS)</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(1, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <a class="code hl_function" href="src_2debug_2debug_8cc.html#afa63af9ce4437935536dcc32dc78f232">ForceAlert</a> &lt;&lt; <span class="stringliteral">&quot;FATAL: Received Bus Error...dying.&quot;</span>);</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(1, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <a class="code hl_function" href="src_2debug_2debug_8cc.html#afa63af9ce4437935536dcc32dc78f232">ForceAlert</a> &lt;&lt; <span class="stringliteral">&quot;FATAL: Received signal &quot;</span> &lt;&lt; sig &lt;&lt; <span class="stringliteral">&quot;...dying.&quot;</span>);</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span><span class="preprocessor">#if PRINT_STACK_TRACE</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span><span class="preprocessor">#if _SQUID_HPUX_</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    {</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>        <span class="keyword">extern</span> <span class="keywordtype">void</span> U_STACK_TRACE(<span class="keywordtype">void</span>);    <span class="comment">/* link with -lcl */</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>        fflush(<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>());</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>        dup2(fileno(<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>()), 2);</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        U_STACK_TRACE();</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>    }</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span><span class="preprocessor">#endif </span><span class="comment">/* _SQUID_HPUX_ */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span><span class="preprocessor">#if _SQUID_SOLARIS_ &amp;&amp; HAVE_LIBOPCOM_STACK</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    {   <span class="comment">/* get ftp://opcom.sun.ca/pub/tars/opcom_stack.tar.gz and */</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        <span class="keyword">extern</span> <span class="keywordtype">void</span> opcom_stack_trace(<span class="keywordtype">void</span>);    <span class="comment">/* link with -lopcom_stack */</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        fflush(<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>());</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>        dup2(fileno(<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>()), fileno(stdout));</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        opcom_stack_trace();</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>        fflush(stdout);</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    }</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span><span class="preprocessor">#endif </span><span class="comment">/* _SQUID_SOLARIS_and HAVE_LIBOPCOM_STACK */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span><span class="preprocessor">#if HAVE_BACKTRACE_SYMBOLS_FD</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>        <span class="keyword">static</span> <span class="keywordtype">void</span> *callarray[8192];</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        <span class="keywordtype">int</span> n;</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        n = backtrace(callarray, 8192);</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>        backtrace_symbols_fd(callarray, n, fileno(<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>()));</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    }</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span> </div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span><span class="preprocessor">#endif </span><span class="comment">/* PRINT_STACK_TRACE */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span> </div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span><span class="preprocessor">#if SA_RESETHAND == 0 &amp;&amp; !_SQUID_WINDOWS_</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    signal(SIGSEGV, SIG_DFL);</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    signal(SIGBUS, SIG_DFL);</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span> </div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    signal(sig, SIG_DFL);</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    <a class="code hl_function" href="tools_8cc.html#ae01a14bde16513f1e27bdc329a07d8c6">releaseServerSockets</a>();</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span> </div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    <a class="code hl_function" href="Disks_8cc.html#ac73d7ef09d0e011cea3204621d73360a">storeDirWriteCleanLogs</a>(0);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="globals_8h.html#a7f68568851b9c7f9291f7bb63f932c18">shutting_down</a>) {</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>        <a class="code hl_function" href="tools_8cc.html#a647dbf3a4a836003580c4df8a7447a32">PrintRusage</a>();</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>        <a class="code hl_function" href="tools_8cc.html#ae172c5dc1ff2a4e1e5fa32f121a5325a">dumpMallocStats</a>();</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    }</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span> </div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a> - <a class="code hl_define" href="version_8h.html#a66bbc6f3e4747cc2d6c0fc86206fa145">SQUID_RELEASE_TIME</a> &lt; 864000) {</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>        <span class="comment">/* skip if more than 10 days old */</span></div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span> </div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ab4795036e0bac3bea76a98114a49c3bd">adminEmail</a>)</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>            <a class="code hl_function" href="tools_8cc.html#a913579133199a9fb7b4c5f52500449cb">mail_warranty</a>();</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>        puts(<a class="code hl_function" href="tools_8cc.html#a5211acae55fc0688663f278e5adb4fd2">dead_msg</a>());</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    }</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span> </div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    <a class="code hl_function" href="classDebug.html#a2e5397f0fd9abedca3410cf4c5157080">Debug::PrepareToDie</a>();</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    abort();</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>}</div>
</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span> </div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00419" data-start="{" data-end="}">
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno"><a class="line" href="tools_8cc.html#acd6d0ab3c36623dc08ed6ae85d9d92f0">  419</a></span><a class="code hl_function" href="tools_8cc.html#acd6d0ab3c36623dc08ed6ae85d9d92f0">BroadcastSignalIfAny</a>(<span class="keywordtype">int</span>&amp; sig)</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>{</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>    <span class="keywordflow">if</span> (sig &gt; 0) {</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="tools_8cc.html#a0dd04d9cb210881c11ed9569084f2b93">IamMasterProcess</a>()) {</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code hl_variable" href="Kids_8cc.html#ae810517ff17a890d25b6820785665ed0">TheKids</a>.<a class="code hl_function" href="classKids.html#a1af8a884f6408402dd897412b7716d19">count</a>() - 1; i &gt;= 0; --i) {</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>                <span class="keyword">const</span> <span class="keyword">auto</span> &amp;kid = <a class="code hl_variable" href="Kids_8cc.html#ae810517ff17a890d25b6820785665ed0">TheKids</a>.<a class="code hl_function" href="classKids.html#a81c8c67375ac03b2b242064bfd4d0aed">get</a>(i);</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>                <span class="keywordflow">if</span> (kid.running())</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>                    kill(kid.getPid(), sig);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>            }</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>        }</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>        sig = -1;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    }</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>}</div>
</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00434" data-start="{" data-end="}">
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno"><a class="line" href="tools_8cc.html#a46150330f164d14c146710b72f9a708f">  434</a></span><a class="code hl_function" href="tools_8cc.html#a46150330f164d14c146710b72f9a708f">sigusr2_handle</a>(<span class="keywordtype">int</span> sig)</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>{</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <span class="keyword">static</span> <span class="keywordtype">int</span> state = 0;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    <span class="comment">/* no debugs() here; bad things happen if the signal is delivered during _db_print() */</span></div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    <a class="code hl_variable" href="tools_8cc.html#aa82acdab9e76fb7e5f1e527dd3743af7">DebugSignal</a> = sig;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span> </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="keywordflow">if</span> (state == 0) {</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>        <a class="code hl_function" href="classDebug.html#a2a385f2268b9dcd172c0c5dceeb8fa7c">Debug::parseOptions</a>(<span class="stringliteral">&quot;ALL,7&quot;</span>);</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>        state = 1;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>        <a class="code hl_function" href="classDebug.html#a2a385f2268b9dcd172c0c5dceeb8fa7c">Debug::parseOptions</a>(<a class="code hl_variable" href="classDebug.html#a9dd097f58b099973a900735048dfdf22">Debug::debugOptions</a>);</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>        state = 0;</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>    }</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span> </div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span><span class="preprocessor">#if !HAVE_SIGACTION</span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <span class="comment">/* reinstall */</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="keywordflow">if</span> (signal(sig, <a class="code hl_function" href="tools_8cc.html#a46150330f164d14c146710b72f9a708f">sigusr2_handle</a>) == SIG_ERR) {</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;signal: sig=&quot;</span> &lt;&lt; sig &lt;&lt; <span class="stringliteral">&quot; func=sigusr2_handle: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    }</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>}</div>
</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00459" data-start="{" data-end="}">
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno"><a class="line" href="tools_8cc.html#abf17a12ab2f03f92a22edeca4be36e19">  459</a></span><a class="code hl_function" href="tools_8cc.html#abf17a12ab2f03f92a22edeca4be36e19">debug_trap</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *message)</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>{</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="globals_8h.html#acbcc517d9fc53da8b134cff4d0d4296c">opt_catch_signals</a>)</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>        <a class="code hl_function" href="fatal_8cc.html#acc07a91f0719197c09905b693f687962">fatal_dump</a>(message);</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span> </div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;WARNING: &quot;</span> &lt;&lt; message);</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>}</div>
</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span><span class="keyword">const</span> <span class="keywordtype">char</span> *</div>
<div class="foldopen" id="foldopen00468" data-start="{" data-end="}">
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno"><a class="line" href="tools_8cc.html#a2d24834d9959fb3fa7d4789d055c1768">  468</a></span><a class="code hl_function" href="tools_8cc.html#a2d24834d9959fb3fa7d4789d055c1768">getMyHostname</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>{</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    <a class="code hl_define" href="squid_8h.html#a9b17dd86bdde2e8cb89abe153a0f4f23">LOCAL_ARRAY</a>(<span class="keywordtype">char</span>, host, <a class="code hl_define" href="rfc2181_8h.html#a17573070c1b8cdd6570e594c23d4addb">SQUIDHOSTNAMELEN</a> + 1);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <span class="keyword">static</span> <span class="keywordtype">int</span> present = 0;</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    <span class="keyword">struct </span>addrinfo *AI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    <a class="code hl_class" href="classIp_1_1Address.html">Ip::Address</a> sa;</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span> </div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ab3b7b7e2644459cd54810f9f56a1ec09">visibleHostname</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ab3b7b7e2644459cd54810f9f56a1ec09">visibleHostname</a>;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span> </div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>    <span class="keywordflow">if</span> (present)</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        <span class="keywordflow">return</span> host;</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>    host[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="PortCfg_8cc.html#ab5fc0d5e05159674db133b2f17786721">HttpPortList</a> != <span class="keyword">nullptr</span> &amp;&amp; sa.<a class="code hl_function" href="classIp_1_1Address.html#ab00ddff71da22c55159fdc8176e14ea4">isAnyAddr</a>())</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>        sa = <a class="code hl_variable" href="PortCfg_8cc.html#ab5fc0d5e05159674db133b2f17786721">HttpPortList</a>-&gt;s;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span> </div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span><span class="comment">     * If the first http_port address has a specific address, try a</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span><span class="comment">     * reverse DNS lookup on it.</span></div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span><span class="comment">     */</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>    <span class="keywordflow">if</span> ( !sa.<a class="code hl_function" href="classIp_1_1Address.html#ab00ddff71da22c55159fdc8176e14ea4">isAnyAddr</a>() ) {</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>        sa.<a class="code hl_function" href="classIp_1_1Address.html#a51e449414ca813e4f1aa62e9c1f3b384">getAddrInfo</a>(AI);</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>        <span class="comment">/* we are looking for a name. */</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>        <span class="keywordflow">if</span> (getnameinfo(AI-&gt;ai_addr, AI-&gt;ai_addrlen, host, <a class="code hl_define" href="rfc2181_8h.html#a17573070c1b8cdd6570e594c23d4addb">SQUIDHOSTNAMELEN</a>, <span class="keyword">nullptr</span>, 0, NI_NAMEREQD ) == 0) {</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>            <span class="comment">/* DNS lookup successful */</span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>            <span class="comment">/* use the official name from DNS lookup */</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, 4, <span class="stringliteral">&quot;getMyHostname: resolved &quot;</span> &lt;&lt; sa &lt;&lt; <span class="stringliteral">&quot; to &#39;&quot;</span> &lt;&lt; host &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>            present = 1;</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span> </div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>            <a class="code hl_function" href="classIp_1_1Address.html#a4849e5673be56c29ab0289635a55fc21">Ip::Address::FreeAddr</a>(AI);</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>            <span class="keywordflow">if</span> (strchr(host, <span class="charliteral">&#39;.&#39;</span>))</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>                <span class="keywordflow">return</span> host;</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>        }</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span> </div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>        <a class="code hl_function" href="classIp_1_1Address.html#a4849e5673be56c29ab0289635a55fc21">Ip::Address::FreeAddr</a>(AI);</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, 2, <span class="stringliteral">&quot;WARNING: failed to resolve &quot;</span> &lt;&lt; sa &lt;&lt; <span class="stringliteral">&quot; to a fully qualified hostname&quot;</span>);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    }</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>    <span class="comment">// still no host. fallback to gethostname()</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="unistd_8h.html#aa81d7f0b188254a6ae8ec162bef462b6">xgethostname</a>(host, <a class="code hl_define" href="rfc2181_8h.html#a17573070c1b8cdd6570e594c23d4addb">SQUIDHOSTNAMELEN</a>) &lt; 0) {</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;WARNING: gethostname failed: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        <span class="comment">/* Verify that the hostname given resolves properly */</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>        <span class="keyword">struct </span>addrinfo hints;</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>        memset(&amp;hints, 0, <span class="keyword">sizeof</span>(addrinfo));</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>        hints.ai_flags = AI_CANONNAME;</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span> </div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>        <span class="keywordflow">if</span> (getaddrinfo(host, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, &amp;AI) == 0) {</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>            <span class="comment">/* DNS lookup successful */</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>            <span class="comment">/* use the official name from DNS lookup */</span></div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, 6, <span class="stringliteral">&quot;getMyHostname: &#39;&quot;</span> &lt;&lt; host &lt;&lt; <span class="stringliteral">&quot;&#39; has DNS resolution.&quot;</span>);</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>            present = 1;</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span> </div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>            <span class="comment">/* AYJ: do we want to flag AI_ALL and cache the result anywhere. ie as our local host IPs? */</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>            <span class="keywordflow">if</span> (AI)</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>                freeaddrinfo(AI);</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span> </div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>            <span class="keywordflow">return</span> host;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        }</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>        <span class="keywordflow">if</span> (AI)</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>            freeaddrinfo(AI);</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;WARNING: &#39;&quot;</span> &lt;&lt; host &lt;&lt; <span class="stringliteral">&quot;&#39; rDNS test failed: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>    }</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span> </div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    <span class="comment">/* throw a configuration error when the Host/IP given has bad DNS/rDNS. */</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;WARNING: Could not determine this machines public hostname. &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>           <span class="stringliteral">&quot;Please configure one or set &#39;visible_hostname&#39;.&quot;</span>);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    <span class="keywordflow">return</span> (<span class="stringliteral">&quot;localhost&quot;</span>);</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>}</div>
</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span><span class="keyword">const</span> <span class="keywordtype">char</span> *</div>
<div class="foldopen" id="foldopen00548" data-start="{" data-end="}">
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno"><a class="line" href="tools_8cc.html#adbe2913b25bf470a7814f9ec4a0907d9">  548</a></span><a class="code hl_function" href="tools_8cc.html#adbe2913b25bf470a7814f9ec4a0907d9">uniqueHostname</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>{</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(21, 3, <span class="stringliteral">&quot; Config: &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac27ae3043929d5a370177e9c61769a44">uniqueHostname</a> &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac27ae3043929d5a370177e9c61769a44">uniqueHostname</a> ? <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac27ae3043929d5a370177e9c61769a44">uniqueHostname</a> : <a class="code hl_function" href="tools_8cc.html#a2d24834d9959fb3fa7d4789d055c1768">getMyHostname</a>();</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>}</div>
</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span> </div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00560" data-start="{" data-end="}">
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno"><a class="line" href="tools_8cc.html#a08dbd97a5d802d0e1d9aa371fd78d833">  560</a></span><a class="code hl_function" href="tools_8cc.html#a08dbd97a5d802d0e1d9aa371fd78d833">leave_suid</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>{</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(21, 3, <span class="stringliteral">&quot;leave_suid: PID &quot;</span> &lt;&lt; getpid() &lt;&lt; <span class="stringliteral">&quot; called&quot;</span>);</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span> </div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a19a58dfeb6962b193a022cb7b5158532">effectiveGroup</a>) {</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span><span class="preprocessor">#if HAVE_SETGROUPS</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>        setgroups(1, &amp;<a class="code hl_variable" href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a>.<a class="code hl_variable" href="classSquidConfig2.html#a5239d8470bb8fcb43885e8dcdc89bc33">effectiveGroupID</a>);</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span> </div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>        <span class="keywordflow">if</span> (setgid(<a class="code hl_variable" href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a>.<a class="code hl_variable" href="classSquidConfig2.html#a5239d8470bb8fcb43885e8dcdc89bc33">effectiveGroupID</a>) &lt; 0) {</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>            <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: setgid: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>        }</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    }</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span> </div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    <span class="keywordflow">if</span> (geteuid() != 0)</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span> </div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>    <span class="comment">/* Started as a root, check suid option */</span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#adc42d93b04f7699435cfe93d2e9fd159">effectiveUser</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span> </div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(21, 3, <span class="stringliteral">&quot;leave_suid: PID &quot;</span> &lt;&lt; getpid() &lt;&lt; <span class="stringliteral">&quot; giving up root, becoming &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#adc42d93b04f7699435cfe93d2e9fd159">effectiveUser</a> &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a19a58dfeb6962b193a022cb7b5158532">effectiveGroup</a>) {</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span> </div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        <span class="keywordflow">if</span> (setgid(<a class="code hl_variable" href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a>.<a class="code hl_variable" href="classSquidConfig2.html#a5239d8470bb8fcb43885e8dcdc89bc33">effectiveGroupID</a>) &lt; 0) {</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>            <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: setgid: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>        }</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span> </div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="initgroups_8c.html#a9c6178c435287e685ff3df23c5a3c0db">initgroups</a>(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#adc42d93b04f7699435cfe93d2e9fd159">effectiveUser</a>, <a class="code hl_variable" href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a>.<a class="code hl_variable" href="classSquidConfig2.html#a5239d8470bb8fcb43885e8dcdc89bc33">effectiveGroupID</a>) &lt; 0) {</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: initgroups: unable to set groups for User &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>                   <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#adc42d93b04f7699435cfe93d2e9fd159">effectiveUser</a> &lt;&lt; <span class="stringliteral">&quot; and Group &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>                   (<span class="keywordtype">unsigned</span>) <a class="code hl_variable" href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a>.<a class="code hl_variable" href="classSquidConfig2.html#a5239d8470bb8fcb43885e8dcdc89bc33">effectiveGroupID</a> &lt;&lt; <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>        }</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    }</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span> </div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span><span class="preprocessor">#if HAVE_SETRESUID</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>    <span class="keywordflow">if</span> (setresuid(<a class="code hl_variable" href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a>.<a class="code hl_variable" href="classSquidConfig2.html#aab400ddf1203bca5c022e20b9078c10f">effectiveUserID</a>, <a class="code hl_variable" href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a>.<a class="code hl_variable" href="classSquidConfig2.html#aab400ddf1203bca5c022e20b9078c10f">effectiveUserID</a>, 0) &lt; 0) {</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        <span class="keyword">const</span> <span class="keyword">auto</span> xerrno = errno;</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>        <a class="code hl_function" href="fatal_8cc.html#ae0269dd75e50d469da2f2416e0cfb7cf">fatalf</a>(<span class="stringliteral">&quot;FATAL: setresuid: %s&quot;</span>, <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    }</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span> </div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span><span class="preprocessor">#elif HAVE_SETEUID</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    <span class="keywordflow">if</span> (seteuid(<a class="code hl_variable" href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a>.<a class="code hl_variable" href="classSquidConfig2.html#aab400ddf1203bca5c022e20b9078c10f">effectiveUserID</a>) &lt; 0) {</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>        <span class="keyword">const</span> <span class="keyword">auto</span> xerrno = errno;</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>        <a class="code hl_function" href="fatal_8cc.html#ae0269dd75e50d469da2f2416e0cfb7cf">fatalf</a>(<span class="stringliteral">&quot;FATAL: seteuid: %s&quot;</span>, <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    }</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> </div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    <span class="keywordflow">if</span> (setuid(<a class="code hl_variable" href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a>.<a class="code hl_variable" href="classSquidConfig2.html#aab400ddf1203bca5c022e20b9078c10f">effectiveUserID</a>) &lt; 0) {</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>        <span class="keyword">const</span> <span class="keyword">auto</span> xerrno = errno;</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>        <a class="code hl_function" href="fatal_8cc.html#ae0269dd75e50d469da2f2416e0cfb7cf">fatalf</a>(<span class="stringliteral">&quot;FATAL: setuid: %s&quot;</span>, <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    }</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span> </div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span> </div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>    <a class="code hl_function" href="tools_8cc.html#aa2651f5e7d5ea2941a2004f3b115aa5f">restoreCapabilities</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>    <a class="code hl_function" href="tools_8cc.html#a1046f2abceb2cbd87c41c5738963da42">setTraceability</a>();</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>}</div>
</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span> </div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span><span class="comment">/* Enter a privilegied section */</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00624" data-start="{" data-end="}">
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno"><a class="line" href="tools_8cc.html#a7e908148934cae35e8e5f8b294f273f0">  624</a></span><a class="code hl_function" href="tools_8cc.html#a7e908148934cae35e8e5f8b294f273f0">enter_suid</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>{</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(21, 3, <span class="stringliteral">&quot;enter_suid: PID &quot;</span> &lt;&lt; getpid() &lt;&lt; <span class="stringliteral">&quot; taking root privileges&quot;</span>);</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span><span class="preprocessor">#if HAVE_SETRESUID</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    <span class="keywordflow">if</span> (setresuid((uid_t)-1, 0, (uid_t)-1) &lt; 0) {</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>        <span class="keyword">const</span> <span class="keyword">auto</span> xerrno = errno;</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a> (21, 3, <span class="stringliteral">&quot;enter_suid: setresuid failed: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>    }</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span> </div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    <span class="keywordflow">if</span> (setuid(0) &lt; 0) {</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>        <span class="keyword">const</span> <span class="keyword">auto</span> xerrno = errno;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(21, 3, <span class="stringliteral">&quot;setuid(0) failed: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>    }</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span> </div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>    <a class="code hl_function" href="tools_8cc.html#a1046f2abceb2cbd87c41c5738963da42">setTraceability</a>();</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>}</div>
</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span> </div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span><span class="comment">/* Give up the possibility to gain privilegies.</span></div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span><span class="comment"> * this should be used before starting a sub process</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span><span class="comment"> */</span></div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00647" data-start="{" data-end="}">
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno"><a class="line" href="tools_8cc.html#a59b6b888e70a670dc77fe473b771ebe0">  647</a></span><a class="code hl_function" href="tools_8cc.html#a59b6b888e70a670dc77fe473b771ebe0">no_suid</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>{</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>    uid_t uid;</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>    <a class="code hl_function" href="tools_8cc.html#a08dbd97a5d802d0e1d9aa371fd78d833">leave_suid</a>();</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>    uid = geteuid();</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(21, 3, <span class="stringliteral">&quot;no_suid: PID &quot;</span> &lt;&lt; getpid() &lt;&lt; <span class="stringliteral">&quot; giving up root privileges forever&quot;</span>);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span> </div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>    <span class="keywordflow">if</span> (setuid(0) &lt; 0) {</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;WARNING: no_suid: setuid(0): &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>    }</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>    <span class="keywordflow">if</span> (setuid(uid) &lt; 0) {</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;ERROR: no_suid: setuid(&quot;</span> &lt;&lt; uid &lt;&lt; <span class="stringliteral">&quot;): &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>    }</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span> </div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>    <a class="code hl_function" href="tools_8cc.html#aa2651f5e7d5ea2941a2004f3b115aa5f">restoreCapabilities</a>(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>    <a class="code hl_function" href="tools_8cc.html#a1046f2abceb2cbd87c41c5738963da42">setTraceability</a>();</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>}</div>
</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span> </div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00669" data-start="{" data-end="}">
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno"><a class="line" href="tools_8cc.html#a0dd04d9cb210881c11ed9569084f2b93">  669</a></span><a class="code hl_function" href="tools_8cc.html#a0dd04d9cb210881c11ed9569084f2b93">IamMasterProcess</a>()</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>{</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="globals_8h.html#af77df4d76eae10fa0cbc6e885b0d32c6">KidIdentifier</a> == 0;</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>}</div>
</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span> </div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00675" data-start="{" data-end="}">
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno"><a class="line" href="tools_8cc.html#a2a195065f59151742dac1bc54c3ef1e9">  675</a></span><a class="code hl_function" href="tools_8cc.html#a2a195065f59151742dac1bc54c3ef1e9">IamWorkerProcess</a>()</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>{</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>    <span class="comment">// when there is only one process, it has to be the worker</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="globals_8h.html#a506a078460793d09337c2ef6455e3600">opt_no_daemon</a> || <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac8007cb4be4fab48e760e825a1e9c3ae">workers</a> == 0)</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="Kid_8cc.html#adcbfb121290f41d58bb9463cc5bd7f39">TheProcessKind</a> == <a class="code hl_enumvalue" href="Kid_8h.html#ac1e0add708b10c910202aee51b8cbed9a1c97999b773efc7be59d2ba160581905">pkWorker</a>;</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>}</div>
</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span> </div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00685" data-start="{" data-end="}">
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno"><a class="line" href="tools_8cc.html#af8698c9fe041ec1a535b499b3269d886">  685</a></span><a class="code hl_function" href="tools_8cc.html#af8698c9fe041ec1a535b499b3269d886">IamDiskProcess</a>()</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>{</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="Kid_8cc.html#adcbfb121290f41d58bb9463cc5bd7f39">TheProcessKind</a> == <a class="code hl_enumvalue" href="Kid_8h.html#ac1e0add708b10c910202aee51b8cbed9a684f7b9219a3e837425c5b5b90442bf3">pkDisker</a>;</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>}</div>
</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span> </div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00691" data-start="{" data-end="}">
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno"><a class="line" href="tools_8cc.html#a11605459b73b3fdcfbb0ad8ae23f6d4d">  691</a></span><a class="code hl_function" href="tools_8cc.html#a11605459b73b3fdcfbb0ad8ae23f6d4d">InDaemonMode</a>()</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>{</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    <span class="keywordflow">return</span> !<a class="code hl_variable" href="globals_8h.html#a506a078460793d09337c2ef6455e3600">opt_no_daemon</a> &amp;&amp; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac8007cb4be4fab48e760e825a1e9c3ae">workers</a> &gt; 0;</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>}</div>
</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span> </div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00697" data-start="{" data-end="}">
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno"><a class="line" href="tools_8cc.html#aee258c896d60b03dd13d784cfd9a6482">  697</a></span><a class="code hl_function" href="tools_8cc.html#aee258c896d60b03dd13d784cfd9a6482">UsingSmp</a>()</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>{</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="tools_8cc.html#a11605459b73b3fdcfbb0ad8ae23f6d4d">InDaemonMode</a>() &amp;&amp; <a class="code hl_function" href="tools_8cc.html#a6c9b4395a85c14d048039476a92dfd35">NumberOfKids</a>() &gt; 1;</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>}</div>
</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span> </div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00703" data-start="{" data-end="}">
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno"><a class="line" href="tools_8cc.html#ad30d341dedd875664d4cbd400a692c57">  703</a></span><a class="code hl_function" href="tools_8cc.html#ad30d341dedd875664d4cbd400a692c57">IamCoordinatorProcess</a>()</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>{</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="Kid_8cc.html#adcbfb121290f41d58bb9463cc5bd7f39">TheProcessKind</a> == <a class="code hl_enumvalue" href="Kid_8h.html#ac1e0add708b10c910202aee51b8cbed9a61ffb00935f647687b63c30b0da7fcdd">pkCoordinator</a>;</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>}</div>
</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span> </div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00709" data-start="{" data-end="}">
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno"><a class="line" href="tools_8cc.html#a5523592643da34411f7694bd980b1c86">  709</a></span><a class="code hl_function" href="tools_8cc.html#a5523592643da34411f7694bd980b1c86">IamPrimaryProcess</a>()</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>{</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>    <span class="comment">// when there is only one process, it has to be primary</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="globals_8h.html#a506a078460793d09337c2ef6455e3600">opt_no_daemon</a> || <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac8007cb4be4fab48e760e825a1e9c3ae">workers</a> == 0)</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span> </div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>    <span class="comment">// when there is a master and worker process, the master delegates</span></div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>    <span class="comment">// primary functions to its only kid</span></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="tools_8cc.html#a6c9b4395a85c14d048039476a92dfd35">NumberOfKids</a>() == 1)</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="tools_8cc.html#a2a195065f59151742dac1bc54c3ef1e9">IamWorkerProcess</a>();</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span> </div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    <span class="comment">// in SMP mode, multiple kids delegate primary functions to the coordinator</span></div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="tools_8cc.html#ad30d341dedd875664d4cbd400a692c57">IamCoordinatorProcess</a>();</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>}</div>
</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span> </div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span><span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen00725" data-start="{" data-end="}">
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno"><a class="line" href="tools_8cc.html#a6c9b4395a85c14d048039476a92dfd35">  725</a></span><a class="code hl_function" href="tools_8cc.html#a6c9b4395a85c14d048039476a92dfd35">NumberOfKids</a>()</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>{</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    <span class="comment">// no kids in no-daemon mode</span></div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="tools_8cc.html#a11605459b73b3fdcfbb0ad8ae23f6d4d">InDaemonMode</a>())</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span> </div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    <span class="comment">// XXX: detect and abort when called before workers/cache_dirs are parsed</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span> </div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> rockDirs = <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a5ed1acd7a82726b16c8697d37acd5f24">cacheSwap</a>.<a class="code hl_variable" href="classStore_1_1DiskConfig.html#af0932ae17c059cebdd990eb45175201a">n_strands</a>;</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span> </div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> needCoord = <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac8007cb4be4fab48e760e825a1e9c3ae">workers</a> &gt; 1 || rockDirs &gt; 0;</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>    <span class="keywordflow">return</span> (needCoord ? 1 : 0) + <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac8007cb4be4fab48e760e825a1e9c3ae">workers</a> + rockDirs;</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>}</div>
</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span><a class="code hl_class" href="classSBuf.html">SBuf</a></div>
<div class="foldopen" id="foldopen00740" data-start="{" data-end="}">
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno"><a class="line" href="tools_8cc.html#af085e872f4b156f1aaa6a5b5ed1717f3">  740</a></span><a class="code hl_function" href="tools_8cc.html#af085e872f4b156f1aaa6a5b5ed1717f3">ProcessRoles</a>()</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>{</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>    <a class="code hl_class" href="classSBuf.html">SBuf</a> roles;</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="tools_8cc.html#a0dd04d9cb210881c11ed9569084f2b93">IamMasterProcess</a>())</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>        roles.<a class="code hl_function" href="classSBuf.html#aa12ede16b167c60722946fc8fe9292da">append</a>(<span class="stringliteral">&quot; master&quot;</span>);</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="tools_8cc.html#ad30d341dedd875664d4cbd400a692c57">IamCoordinatorProcess</a>())</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>        roles.<a class="code hl_function" href="classSBuf.html#aa12ede16b167c60722946fc8fe9292da">append</a>(<span class="stringliteral">&quot; coordinator&quot;</span>);</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="tools_8cc.html#a2a195065f59151742dac1bc54c3ef1e9">IamWorkerProcess</a>())</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>        roles.<a class="code hl_function" href="classSBuf.html#aa12ede16b167c60722946fc8fe9292da">append</a>(<span class="stringliteral">&quot; worker&quot;</span>);</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="tools_8cc.html#af8698c9fe041ec1a535b499b3269d886">IamDiskProcess</a>())</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>        roles.<a class="code hl_function" href="classSBuf.html#aa12ede16b167c60722946fc8fe9292da">append</a>(<span class="stringliteral">&quot; disker&quot;</span>);</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>    <span class="keywordflow">return</span> roles;</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>}</div>
</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span> </div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span><span class="comment">/* A little piece of glue for odd systems */</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span><span class="preprocessor">#ifndef RLIMIT_NOFILE</span></div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span><span class="preprocessor">#ifdef RLIMIT_OFILE</span></div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span><span class="preprocessor">#define RLIMIT_NOFILE RLIMIT_OFILE</span></div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span> </div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00763" data-start="{" data-end="}">
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno"><a class="line" href="tools_8cc.html#a46fb38cb0b42225bd640ed365f613dcd">  763</a></span><a class="code hl_function" href="tools_8cc.html#a46fb38cb0b42225bd640ed365f613dcd">setMaxFD</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>{</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span><span class="preprocessor">#if HAVE_SETRLIMIT &amp;&amp; defined(RLIMIT_NOFILE)</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    <span class="comment">/* On Linux with 64-bit file support the sys/resource.h header</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span><span class="comment">     * uses #define to change the function definition to require rlimit64</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span><span class="comment">     */</span></div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span><span class="preprocessor">#if defined(getrlimit)</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>    <span class="keyword">struct </span>rlimit64 rl; <span class="comment">// Assume its a 64-bit redefine anyways.</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>    <span class="keyword">struct </span>rlimit rl;</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span> </div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>    <span class="keywordflow">if</span> (getrlimit(RLIMIT_NOFILE, &amp;rl) &lt; 0) {</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;getrlimit: RLIMIT_NOFILE: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a14afd25e14f208317b1677f7a375e0b8">max_filedescriptors</a> &gt; 0) {</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span><span class="preprocessor">#if USE_SELECT</span></div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>        <span class="comment">/* select() breaks if this gets set too big */</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a14afd25e14f208317b1677f7a375e0b8">max_filedescriptors</a> &gt; FD_SETSIZE) {</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>            rl.rlim_cur = FD_SETSIZE;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;WARNING: &#39;max_filedescriptors &quot;</span> &lt;&lt; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a14afd25e14f208317b1677f7a375e0b8">max_filedescriptors</a> &lt;&lt; <span class="stringliteral">&quot;&#39; does not work with select()&quot;</span>);</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>        } <span class="keywordflow">else</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>            rl.rlim_cur = <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a14afd25e14f208317b1677f7a375e0b8">max_filedescriptors</a>;</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>        <span class="keywordflow">if</span> (rl.rlim_cur &gt; rl.rlim_max)</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>            rl.rlim_max = rl.rlim_cur;</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>        <span class="keywordflow">if</span> (setrlimit(RLIMIT_NOFILE, &amp;rl)) {</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>            <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: setrlimit: RLIMIT_NOFILE: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>            getrlimit(RLIMIT_NOFILE, &amp;rl);</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>            rl.rlim_cur = rl.rlim_max;</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>            <span class="keywordflow">if</span> (setrlimit(RLIMIT_NOFILE, &amp;rl)) {</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>                xerrno = errno;</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>                <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: setrlimit: RLIMIT_NOFILE: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>            }</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        }</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    }</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>    <span class="keywordflow">if</span> (getrlimit(RLIMIT_NOFILE, &amp;rl) &lt; 0) {</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: getrlimit: RLIMIT_NOFILE: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>        <a class="code hl_variable" href="globals_8h.html#a85fb5b16080caacaaf9ca40e713fccb9">Squid_MaxFD</a> = rl.rlim_cur;</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>    }</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span> </div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_SETRLIMIT */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>}</div>
</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span> </div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00812" data-start="{" data-end="}">
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno"><a class="line" href="tools_8cc.html#af965183167c843adb00c7a883ca38683">  812</a></span><a class="code hl_function" href="tools_8cc.html#af965183167c843adb00c7a883ca38683">setSystemLimits</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>{</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span><span class="preprocessor">#if HAVE_SETRLIMIT &amp;&amp; defined(RLIMIT_NOFILE) &amp;&amp; !_SQUID_CYGWIN_</span></div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>    <span class="comment">/* limit system filedescriptors to our own limit */</span></div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span> </div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>    <span class="comment">/* On Linux with 64-bit file support the sys/resource.h header</span></div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span><span class="comment">     * uses #define to change the function definition to require rlimit64</span></div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span><span class="comment">     */</span></div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span><span class="preprocessor">#if defined(getrlimit)</span></div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>    <span class="keyword">struct </span>rlimit64 rl; <span class="comment">// Assume its a 64-bit redefine anyways.</span></div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>    <span class="keyword">struct </span>rlimit rl;</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span> </div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>    <span class="keywordflow">if</span> (getrlimit(RLIMIT_NOFILE, &amp;rl) &lt; 0) {</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;getrlimit: RLIMIT_NOFILE: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>        rl.rlim_cur = <a class="code hl_variable" href="globals_8h.html#a85fb5b16080caacaaf9ca40e713fccb9">Squid_MaxFD</a>;</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>        <span class="keywordflow">if</span> (setrlimit(RLIMIT_NOFILE, &amp;rl) &lt; 0) {</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>            <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>            snprintf(<a class="code hl_variable" href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">tmp_error_buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">tmp_error_buf</a>), <span class="stringliteral">&quot;setrlimit: RLIMIT_NOFILE: %s&quot;</span>, <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>            <a class="code hl_function" href="fatal_8cc.html#acc07a91f0719197c09905b693f687962">fatal_dump</a>(<a class="code hl_variable" href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">tmp_error_buf</a>);</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>        }</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    }</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_SETRLIMIT */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span> </div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span><span class="preprocessor">#if HAVE_SETRLIMIT &amp;&amp; defined(RLIMIT_DATA) &amp;&amp; !_SQUID_CYGWIN_</span></div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>    <span class="keywordflow">if</span> (getrlimit(RLIMIT_DATA, &amp;rl) &lt; 0) {</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;getrlimit: RLIMIT_DATA: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rl.rlim_max &gt; rl.rlim_cur) {</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>        rl.rlim_cur = rl.rlim_max;  <span class="comment">/* set it to the max */</span></div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span> </div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>        <span class="keywordflow">if</span> (setrlimit(RLIMIT_DATA, &amp;rl) &lt; 0) {</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>            <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>            snprintf(<a class="code hl_variable" href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">tmp_error_buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">tmp_error_buf</a>), <span class="stringliteral">&quot;setrlimit: RLIMIT_DATA: %s&quot;</span>, <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>            <a class="code hl_function" href="fatal_8cc.html#acc07a91f0719197c09905b693f687962">fatal_dump</a>(<a class="code hl_variable" href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">tmp_error_buf</a>);</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>        }</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>    }</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span><span class="preprocessor">#endif </span><span class="comment">/* RLIMIT_DATA */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a14afd25e14f208317b1677f7a375e0b8">max_filedescriptors</a> &gt; <a class="code hl_variable" href="globals_8h.html#a85fb5b16080caacaaf9ca40e713fccb9">Squid_MaxFD</a>) {</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;WARNING: Could not increase the number of filedescriptors&quot;</span>);</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>    }</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span> </div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span><span class="preprocessor">#if HAVE_SETRLIMIT &amp;&amp; defined(RLIMIT_VMEM) &amp;&amp; !_SQUID_CYGWIN_</span></div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>    <span class="keywordflow">if</span> (getrlimit(RLIMIT_VMEM, &amp;rl) &lt; 0) {</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;getrlimit: RLIMIT_VMEM: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rl.rlim_max &gt; rl.rlim_cur) {</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>        rl.rlim_cur = rl.rlim_max;  <span class="comment">/* set it to the max */</span></div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span> </div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>        <span class="keywordflow">if</span> (setrlimit(RLIMIT_VMEM, &amp;rl) &lt; 0) {</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>            <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>            snprintf(<a class="code hl_variable" href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">tmp_error_buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">tmp_error_buf</a>), <span class="stringliteral">&quot;setrlimit: RLIMIT_VMEM: %s&quot;</span>, <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>            <a class="code hl_function" href="fatal_8cc.html#acc07a91f0719197c09905b693f687962">fatal_dump</a>(<a class="code hl_variable" href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">tmp_error_buf</a>);</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>        }</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>    }</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span><span class="preprocessor">#endif </span><span class="comment">/* RLIMIT_VMEM */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>}</div>
</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span> </div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00874" data-start="{" data-end="}">
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno"><a class="line" href="tools_8cc.html#a1a0dc432bc9c2539eabfad999ffad17e">  874</a></span><a class="code hl_function" href="tools_8cc.html#a1a0dc432bc9c2539eabfad999ffad17e">squid_signal</a>(<span class="keywordtype">int</span> sig, <a class="code hl_typedef" href="tools_8h.html#a4b5b6a2a4105c476f75ac907643ff855">SIGHDLR</a> * func, <span class="keywordtype">int</span> flags)</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>{</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span><span class="preprocessor">#if HAVE_SIGACTION</span></div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span> </div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>    <span class="keyword">struct </span>sigaction sa;</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>    sa.sa_handler = func;</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>    sa.sa_flags = flags;</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>    sigemptyset(&amp;sa.sa_mask);</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span> </div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>    <span class="keywordflow">if</span> (sigaction(sig, &amp;sa, <span class="keyword">nullptr</span>) &lt; 0) {</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(50, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;sigaction: sig=&quot;</span> &lt;&lt; sig &lt;&lt; <span class="stringliteral">&quot; func=&quot;</span> &lt;&lt; func &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>    }</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span><span class="preprocessor">#if _SQUID_WINDOWS_</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span><span class="comment">    On Windows, only SIGINT, SIGILL, SIGFPE, SIGTERM, SIGBREAK, SIGABRT and SIGSEGV signals</span></div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span><span class="comment">    are supported, so we must care of don&#39;t call signal() for other value.</span></div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span><span class="comment">    The SIGILL, SIGSEGV, and SIGTERM signals are not generated under Windows. They are defined</span></div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span><span class="comment">    for ANSI compatibility, so both SIGSEGV and SIGBUS are emulated with an Exception Handler.</span></div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span><span class="comment">    */</span></div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>    <span class="keywordflow">switch</span> (sig) {</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span> </div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>    <span class="keywordflow">case</span> SIGINT:</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span> </div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    <span class="keywordflow">case</span> SIGILL:</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span> </div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>    <span class="keywordflow">case</span> SIGFPE:</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span> </div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>    <span class="keywordflow">case</span> SIGTERM:</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span> </div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>    <span class="keywordflow">case</span> SIGBREAK:</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span> </div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    <span class="keywordflow">case</span> SIGABRT:</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span> </div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>    <span class="keywordflow">case</span> SIGSEGV:</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>        WIN32_ExceptionHandlerInit();</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span> </div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>    <span class="keywordflow">case</span> SIGBUS:</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>        WIN32_ExceptionHandlerInit();</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>        <span class="keywordflow">break</span>;  <span class="comment">/* Nor reached */</span></div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span> </div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>        <span class="keywordflow">break</span>;  <span class="comment">/* Nor reached */</span></div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>    }</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span> </div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span> </div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>    signal(sig, func);</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span> </div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>}</div>
</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span> </div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00932" data-start="{" data-end="}">
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno"><a class="line" href="tools_8cc.html#a8250070b2038454ce1fe676d73268207">  932</a></span><a class="code hl_function" href="tools_8cc.html#a8250070b2038454ce1fe676d73268207">logsFlush</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>{</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>())</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>        fflush(<a class="code hl_function" href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a>());</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>}</div>
</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span> </div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00939" data-start="{" data-end="}">
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno"><a class="line" href="tools_8cc.html#aa3f5a1d3a4bc67144cc318637612ddf1">  939</a></span><a class="code hl_function" href="tools_8cc.html#aa3f5a1d3a4bc67144cc318637612ddf1">debugObj</a>(<span class="keywordtype">int</span> section, <span class="keywordtype">int</span> level, <span class="keyword">const</span> <span class="keywordtype">char</span> *label, <span class="keywordtype">void</span> *obj, <a class="code hl_typedef" href="tools_8h.html#adfbde7d952e179f88f0768705a009c4b">ObjPackMethod</a> pm)</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>{</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(label &amp;&amp; obj &amp;&amp; pm);</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>    <a class="code hl_class" href="classMemBuf.html">MemBuf</a> mb;</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>    mb.<a class="code hl_function" href="classMemBuf.html#a4a615d8e887439c66e04aab70f8be60a">init</a>();</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>    (*pm) (obj, &amp;mb);</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(section, level, <span class="stringliteral">&quot;&quot;</span> &lt;&lt; label &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; mb.<a class="code hl_variable" href="classMemBuf.html#a78daaa064a5aa4557e283a01c4aa27f1">buf</a> &lt;&lt; <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>    mb.<a class="code hl_function" href="classMemBuf.html#a085688f536a13949b005f7bb59bae333">clean</a>();</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>}</div>
</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span> </div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00950" data-start="{" data-end="}">
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno"><a class="line" href="tools_8cc.html#aad006cb899b67822b8b66ac9f8f677be">  950</a></span><a class="code hl_function" href="tools_8cc.html#aad006cb899b67822b8b66ac9f8f677be">parseEtcHosts</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>{</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>    <span class="keywordtype">char</span> buf[1024];</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>    <span class="keywordtype">char</span> buf2[512];</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>    <span class="keywordtype">char</span> *nt = buf;</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>    <span class="keywordtype">char</span> *lt = buf;</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span> </div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a47e431e4fc6fe596f78254faf0f00a3f">etcHostsPath</a>)</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span> </div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>    <span class="keywordflow">if</span> (0 == strcmp(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a47e431e4fc6fe596f78254faf0f00a3f">etcHostsPath</a>, <span class="stringliteral">&quot;none&quot;</span>))</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    FILE *fp = fopen(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a47e431e4fc6fe596f78254faf0f00a3f">etcHostsPath</a>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span> </div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>    <span class="keywordflow">if</span> (!fp) {</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>        <span class="keywordtype">int</span> xerrno = errno;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(1, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;parseEtcHosts: &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a47e431e4fc6fe596f78254faf0f00a3f">etcHostsPath</a> &lt;&lt; <span class="stringliteral">&quot;&#39; : &quot;</span> &lt;&lt; <a class="code hl_function" href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a>(xerrno));</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    }</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span> </div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span><span class="preprocessor">#if _SQUID_WINDOWS_</span></div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>    setmode(fileno(fp), <a class="code hl_define" href="defines_8h.html#a9abb6d01b83e0bc5a6e2adeceb7dffd7">O_TEXT</a>);</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span> </div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>    <span class="keywordflow">while</span> (fgets(buf, 1024, fp)) {  <span class="comment">/* for each line */</span></div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span> </div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>        <span class="keywordflow">if</span> (buf[0] == <span class="charliteral">&#39;#&#39;</span>)  <span class="comment">/* MS-windows likes to add comments */</span></div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span> </div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>        strtok(buf, <span class="stringliteral">&quot;#&quot;</span>);   <span class="comment">/* chop everything following a comment marker */</span></div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span> </div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>        lt = buf;</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span> </div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>        <span class="keywordtype">char</span> *addr = buf;</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span> </div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(1, 5, <span class="stringliteral">&quot;etc_hosts: line is &#39;&quot;</span> &lt;&lt; buf &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span> </div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>        nt = strpbrk(lt, <a class="code hl_define" href="compat__shared_8h.html#af172ea808e99a9f4d4cc3631a496f246">w_space</a>);</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span> </div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>        <span class="keywordflow">if</span> (nt == <span class="keyword">nullptr</span>)     <span class="comment">/* empty line */</span></div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span> </div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>        *nt = <span class="charliteral">&#39;\0&#39;</span>;     <span class="comment">/* null-terminate the address */</span></div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span> </div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(1, 5, <span class="stringliteral">&quot;etc_hosts: address is &#39;&quot;</span> &lt;&lt; addr &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span> </div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>        lt = nt + 1;</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span> </div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>        <a class="code hl_typedef" href="sbuf_2forward_8h.html#a61ea2a38dc40862c32fc44508639f6b7">SBufList</a> hosts;</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span> </div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>        <span class="keywordflow">while</span> ((nt = strpbrk(lt, <a class="code hl_define" href="compat__shared_8h.html#af172ea808e99a9f4d4cc3631a496f246">w_space</a>))) {</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>            <span class="keywordtype">char</span> *host = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span> </div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>            <span class="keywordflow">if</span> (nt == lt) { <span class="comment">/* multiple spaces */</span></div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>                <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(1, 5, <span class="stringliteral">&quot;etc_hosts: multiple spaces, skipping&quot;</span>);</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>                lt = nt + 1;</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>            }</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span> </div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>            *nt = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(1, 5, <span class="stringliteral">&quot;etc_hosts: got hostname &#39;&quot;</span> &lt;&lt; lt &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span> </div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>            <span class="comment">/* For IPV6 addresses also check for a colon */</span></div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a6382b11d001515f712a0462d5e277280">appendDomain</a> &amp;&amp; !strchr(lt, <span class="charliteral">&#39;.&#39;</span>) &amp;&amp; !strchr(lt, <span class="charliteral">&#39;:&#39;</span>)) {</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>                <span class="comment">/* I know it&#39;s ugly, but it&#39;s only at reconfig */</span></div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>                strncpy(buf2, lt, <span class="keyword">sizeof</span>(buf2)-1);</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>                strncat(buf2, <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a6382b11d001515f712a0462d5e277280">appendDomain</a>, <span class="keyword">sizeof</span>(buf2) - strlen(lt) - 1);</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>                buf2[<span class="keyword">sizeof</span>(buf2)-1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>                host = buf2;</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>                host = lt;</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>            }</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span> </div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="group__IPCacheAPI.html#gac9e7ec52b691b11df3ee29ed24004ca7">ipcacheAddEntryFromHosts</a>(host, addr) != 0) {</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>                <span class="comment">/* invalid address, continuing is useless */</span></div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>                hosts.clear();</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>            }</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>            hosts.emplace_back(<a class="code hl_class" href="classSBuf.html">SBuf</a>(host));</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span> </div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>            lt = nt + 1;</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>        }</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span> </div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>        <span class="keywordflow">if</span> (!hosts.empty())</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>            <a class="code hl_function" href="fqdncache_8cc.html#a22774f484e90bd1d10b744e89d7f3757">fqdncacheAddEntryFromHosts</a>(addr, hosts);</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>    }</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span> </div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    fclose (fp);</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>}</div>
</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span> </div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span><span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen01042" data-start="{" data-end="}">
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"><a class="line" href="tools_8cc.html#a8905d1b1ed6354e381bb48fc5ce505de"> 1042</a></span><a class="code hl_function" href="tools_8cc.html#a8905d1b1ed6354e381bb48fc5ce505de">getMyPort</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>{</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>    <a class="code hl_class" href="classRefCount.html">AnyP::PortCfgPointer</a> p;</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>    <span class="keywordflow">if</span> ((p = <a class="code hl_variable" href="PortCfg_8cc.html#ab5fc0d5e05159674db133b2f17786721">HttpPortList</a>) != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>        <span class="comment">// skip any special interception ports</span></div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>        <span class="keywordflow">while</span> (p != <span class="keyword">nullptr</span> &amp;&amp; p-&gt;flags.isIntercepted())</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>            p = p-&gt;next;</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>        <span class="keywordflow">if</span> (p != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>            <span class="keywordflow">return</span> p-&gt;s.port();</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>    }</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span> </div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>    <span class="keywordflow">if</span> ((p = <a class="code hl_variable" href="PortCfg_8cc.html#a31b693c418c2d271a30c0d70c2fbb170">FtpPortList</a>) != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>        <span class="comment">// skip any special interception ports</span></div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>        <span class="keywordflow">while</span> (p != <span class="keyword">nullptr</span> &amp;&amp; p-&gt;flags.isIntercepted())</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>            p = p-&gt;next;</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>        <span class="keywordflow">if</span> (p != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>            <span class="keywordflow">return</span> p-&gt;s.port();</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>    }</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span> </div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(21, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: No forward-proxy ports configured.&quot;</span>);</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>    <span class="keywordflow">return</span> 0; <span class="comment">// Invalid port. This will result in invalid URLs on bad configurations.</span></div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>}</div>
</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span> </div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span><span class="comment">/*</span></div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span><span class="comment"> * Set the umask to at least the given mask. This is in addition</span></div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span><span class="comment"> * to the umask set at startup</span></div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span><span class="comment"> */</span></div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01070" data-start="{" data-end="}">
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"><a class="line" href="tools_8cc.html#a2fc1e2bbe922a98d916b3b0885b37bca"> 1070</a></span><a class="code hl_function" href="tools_8cc.html#a2fc1e2bbe922a98d916b3b0885b37bca">setUmask</a>(<a class="code hl_typedef" href="types_8h.html#a51b5bca3280ca743227e9b07c4f839a1">mode_t</a> mask)</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>{</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>    <span class="comment">// No way to get the current umask value without setting it.</span></div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>    <span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_typedef" href="types_8h.html#a51b5bca3280ca743227e9b07c4f839a1">mode_t</a> orig_umask = umask(mask); <span class="comment">// once, to get</span></div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>    umask(mask | orig_umask); <span class="comment">// always, to set</span></div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>}</div>
</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span> </div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span><span class="comment">/*</span></div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span><span class="comment"> * Inverse of strwordtok. Quotes a word if needed</span></div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span><span class="comment"> */</span></div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01081" data-start="{" data-end="}">
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"><a class="line" href="tools_8cc.html#a1381bd0ef88fab270bbd0d6fbfc9e71d"> 1081</a></span><a class="code hl_function" href="tools_8cc.html#a1381bd0ef88fab270bbd0d6fbfc9e71d">strwordquote</a>(<a class="code hl_class" href="classMemBuf.html">MemBuf</a> * mb, <span class="keyword">const</span> <span class="keywordtype">char</span> *str)</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>{</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>    <span class="keywordtype">int</span> quoted = 0;</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span> </div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>    <span class="keywordflow">if</span> (strchr(str, <span class="charliteral">&#39; &#39;</span>)) {</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>        quoted = 1;</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>        mb-&gt;<a class="code hl_function" href="classMemBuf.html#a2e7319f5feaf76c1fd43f163a87ddaad">append</a>(<span class="stringliteral">&quot;\&quot;&quot;</span>, 1);</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>    }</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span> </div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>    <span class="keywordflow">while</span> (*str) {</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>        <span class="keyword">const</span> <span class="keyword">auto</span> l = strcspn(str, <span class="stringliteral">&quot;\&quot;\\\n\r&quot;</span>);</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>        mb-&gt;<a class="code hl_function" href="classMemBuf.html#a2e7319f5feaf76c1fd43f163a87ddaad">append</a>(str, l);</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>        str += l;</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span> </div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>        <span class="keywordflow">switch</span> (*str) {</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span> </div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;\n&#39;</span>:</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>            mb-&gt;<a class="code hl_function" href="classMemBuf.html#a2e7319f5feaf76c1fd43f163a87ddaad">append</a>(<span class="stringliteral">&quot;\\n&quot;</span>, 2);</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>            ++str;</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span> </div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;\r&#39;</span>:</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>            mb-&gt;<a class="code hl_function" href="classMemBuf.html#a2e7319f5feaf76c1fd43f163a87ddaad">append</a>(<span class="stringliteral">&quot;\\r&quot;</span>, 2);</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>            ++str;</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span> </div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;\0&#39;</span>:</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span> </div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>            mb-&gt;<a class="code hl_function" href="classMemBuf.html#a2e7319f5feaf76c1fd43f163a87ddaad">append</a>(<span class="stringliteral">&quot;\\&quot;</span>, 1);</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>            mb-&gt;<a class="code hl_function" href="classMemBuf.html#a2e7319f5feaf76c1fd43f163a87ddaad">append</a>(str, 1);</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>            ++str;</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>        }</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>    }</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span> </div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>    <span class="keywordflow">if</span> (quoted)</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>        mb-&gt;<a class="code hl_function" href="classMemBuf.html#a2e7319f5feaf76c1fd43f163a87ddaad">append</a>(<span class="stringliteral">&quot;\&quot;&quot;</span>, 1);</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>}</div>
</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span> </div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01123" data-start="{" data-end="}">
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"><a class="line" href="tools_8cc.html#a440f44a135dccbb7691d4604ee318911"> 1123</a></span><a class="code hl_function" href="tools_8cc.html#a440f44a135dccbb7691d4604ee318911">keepCapabilities</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>{</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span><span class="preprocessor">#if HAVE_LIBCAP &amp;&amp; HAVE_PRCTL &amp;&amp; defined(PR_SET_KEEPCAPS)</span></div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>    <span class="keywordflow">if</span> (prctl(PR_SET_KEEPCAPS, 1, 0, 0, 0)) {</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>        Ip::Interceptor.StopTransparency(<span class="stringliteral">&quot;capability setting has failed.&quot;</span>);</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>    }</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>}</div>
</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span> </div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01133" data-start="{" data-end="}">
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"><a class="line" href="tools_8cc.html#aa2651f5e7d5ea2941a2004f3b115aa5f"> 1133</a></span><a class="code hl_function" href="tools_8cc.html#aa2651f5e7d5ea2941a2004f3b115aa5f">restoreCapabilities</a>(<span class="keywordtype">bool</span> keep)</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>{</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span><span class="preprocessor">#if HAVE_LIBCAP</span></div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>    cap_t caps;</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>    <span class="keywordflow">if</span> (keep)</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>        caps = cap_get_proc();</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>        caps = cap_init();</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>    <span class="keywordflow">if</span> (!caps) {</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>        Ip::Interceptor.StopTransparency(<span class="stringliteral">&quot;Can&#39;t get current capabilities&quot;</span>);</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>        <span class="keywordtype">int</span> ncaps = 0;</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>        <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>        cap_value_t cap_list[10];</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>        cap_list[ncaps] = CAP_NET_BIND_SERVICE;</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>        ++ncaps;</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>        <span class="keywordflow">if</span> (Ip::Interceptor.TransparentActive() ||</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>#<span class="keywordflow">if</span> <a class="code hl_define" href="autoconf_8h.html#a7ebe85524e31350a2120834b1f238c89">USE_LIBNETFILTERCONNTRACK</a></div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>                <span class="comment">// netfilter_conntrack requires CAP_NET_ADMIN to get client&#39;s CONNMARK</span></div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>                Ip::Interceptor.InterceptActive() ||</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>#endif</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>                <a class="code hl_variable" href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a>.isHitNfmarkActive() ||</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>                <a class="code hl_variable" href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a>.isAclNfmarkActive() ||</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>                <a class="code hl_variable" href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a>.isAclTosActive()) {</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>            cap_list[ncaps] = CAP_NET_ADMIN;</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>            ++ncaps;</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>        }</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span> </div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>        cap_clear_flag(caps, CAP_EFFECTIVE);</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>        rc |= cap_set_flag(caps, CAP_EFFECTIVE, ncaps, cap_list, CAP_SET);</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>        rc |= cap_set_flag(caps, CAP_PERMITTED, ncaps, cap_list, CAP_SET);</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span> </div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>        <span class="keywordflow">if</span> (rc || cap_set_proc(caps) != 0) {</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>            Ip::Interceptor.StopTransparency(<span class="stringliteral">&quot;Error enabling needed capabilities.&quot;</span>);</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>        }</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>        cap_free(caps);</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>    }</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span><span class="preprocessor">#elif _SQUID_LINUX_</span></div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>    <span class="comment">/* Linux requires syscap support from libcap. */</span></div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>    Ip::Interceptor.StopTransparency(<span class="stringliteral">&quot;Missing needed capability support.&quot;</span>);</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>    (void)keep;</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>    <span class="comment">/* Non-Linux transparent proxy works with or without libcap support. */</span></div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>    (void)keep;</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>}</div>
</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span> </div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>pid_t</div>
<div class="foldopen" id="foldopen01181" data-start="{" data-end="}">
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"><a class="line" href="tools_8cc.html#a293e84bd2ac9ca7edddac9a88a6042d2"> 1181</a></span><a class="code hl_function" href="tools_8cc.html#a293e84bd2ac9ca7edddac9a88a6042d2">WaitForOnePid</a>(pid_t <a class="code hl_variable" href="IcmpSquid_8cc.html#ae0d46a978d5cd6707411f276ad869b9c">pid</a>, <a class="code hl_typedef" href="tools_8h.html#a5b4f11f666cbb4610b0e31f81d6087f7">PidStatus</a> &amp;status, <span class="keywordtype">int</span> flags)</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>{</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span><span class="preprocessor">#if _SQUID_WINDOWS_</span></div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>    <span class="keywordflow">return</span> 0; <span class="comment">// function not used on Windows</span></div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>    <span class="keywordflow">return</span> waitpid(<a class="code hl_variable" href="IcmpSquid_8cc.html#ae0d46a978d5cd6707411f276ad869b9c">pid</a>, &amp;status, flags);</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>}</div>
</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span> </div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span><span class="preprocessor">#if _SQUID_WINDOWS_ || _SQUID_MINGW_</span></div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span><a class="code hl_class" href="classSBuf.html">SBuf</a></div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>WindowsErrorMessage(DWORD errorId)</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>{</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>    <span class="keywordtype">char</span> *rawMessage = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>    <span class="keyword">const</span> <span class="keyword">auto</span> length = FormatMessage(</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>                            FORMAT_MESSAGE_ALLOCATE_BUFFER |</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>                            FORMAT_MESSAGE_FROM_SYSTEM |</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>                            FORMAT_MESSAGE_IGNORE_INSERTS,</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>                            <span class="keyword">nullptr</span>,</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>                            errorId,</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>                            MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), <span class="comment">// Default language</span></div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>                            <span class="keyword">static_cast&lt;</span>LPTSTR<span class="keyword">&gt;</span>(&amp;rawMessage),</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>                            0,</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>                            <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>    <span class="keywordflow">if</span> (!length) {</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>        <a class="code hl_define" href="TextException_8h.html#ad79a19f4098f2506d0aa28628f18fd36">Must</a>(!rawMessage); <span class="comment">// nothing to LocalFree()</span></div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="sbuf_2Stream_8h.html#a6160c2bd5c3883a54866ccfd670ce4b6">ToSBuf</a>(<span class="stringliteral">&quot;windows error &quot;</span>, errorId);</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>    }</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>    <span class="keyword">const</span> <span class="keyword">auto</span> result = <a class="code hl_class" href="classSBuf.html">SBuf</a>(rawMessage, length);</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>    LocalFree(rawMessage);</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>}</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span><span class="preprocessor">#endif </span><span class="comment">// _SQUID_WINDOWS_ || _SQUID_MINGW_</span></div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span> </div>
<div class="ttc" id="aCoordinator_8h_html"><div class="ttname"><a href="Coordinator_8h.html">Coordinator.h</a></div></div>
<div class="ttc" id="aDisks_8cc_html_ac73d7ef09d0e011cea3204621d73360a"><div class="ttname"><a href="Disks_8cc.html#ac73d7ef09d0e011cea3204621d73360a">storeDirWriteCleanLogs</a></div><div class="ttdeci">int storeDirWriteCleanLogs(int reopen)</div><div class="ttdef"><b>Definition</b> <a href="Disks_8cc_source.html#l00695">Disks.cc:695</a></div></div>
<div class="ttc" id="aDisks_8h_html"><div class="ttname"><a href="Disks_8h.html">Disks.h</a></div></div>
<div class="ttc" id="aHere_8h_html_ae4d205e9d525856fbdfd44f7eccb309b"><div class="ttname"><a href="Here_8h.html#ae4d205e9d525856fbdfd44f7eccb309b">Here</a></div><div class="ttdeci">#define Here()</div><div class="ttdoc">source code location of the caller</div><div class="ttdef"><b>Definition</b> <a href="Here_8h_source.html#l00015">Here.h:15</a></div></div>
<div class="ttc" id="aICP_8h_html"><div class="ttname"><a href="ICP_8h.html">ICP.h</a></div></div>
<div class="ttc" id="aIcmpSquid_8cc_html_ae0d46a978d5cd6707411f276ad869b9c"><div class="ttname"><a href="IcmpSquid_8cc.html#ae0d46a978d5cd6707411f276ad869b9c">pid</a></div><div class="ttdeci">static pid_t pid</div><div class="ttdef"><b>Definition</b> <a href="IcmpSquid_8cc_source.html#l00036">IcmpSquid.cc:36</a></div></div>
<div class="ttc" id="aIntercept_8h_html"><div class="ttname"><a href="Intercept_8h.html">Intercept.h</a></div></div>
<div class="ttc" id="aKid_8cc_html_adcbfb121290f41d58bb9463cc5bd7f39"><div class="ttname"><a href="Kid_8cc.html#adcbfb121290f41d58bb9463cc5bd7f39">TheProcessKind</a></div><div class="ttdeci">int TheProcessKind</div><div class="ttdoc">ProcessKind for the current process.</div><div class="ttdef"><b>Definition</b> <a href="Kid_8cc_source.html#l00021">Kid.cc:21</a></div></div>
<div class="ttc" id="aKid_8h_html_ac1e0add708b10c910202aee51b8cbed9a1c97999b773efc7be59d2ba160581905"><div class="ttname"><a href="Kid_8h.html#ac1e0add708b10c910202aee51b8cbed9a1c97999b773efc7be59d2ba160581905">pkWorker</a></div><div class="ttdeci">@ pkWorker</div><div class="ttdoc">general-purpose worker bee</div><div class="ttdef"><b>Definition</b> <a href="Kid_8h_source.html#l00105">Kid.h:105</a></div></div>
<div class="ttc" id="aKid_8h_html_ac1e0add708b10c910202aee51b8cbed9a61ffb00935f647687b63c30b0da7fcdd"><div class="ttname"><a href="Kid_8h.html#ac1e0add708b10c910202aee51b8cbed9a61ffb00935f647687b63c30b0da7fcdd">pkCoordinator</a></div><div class="ttdeci">@ pkCoordinator</div><div class="ttdoc">manages all other kids</div><div class="ttdef"><b>Definition</b> <a href="Kid_8h_source.html#l00104">Kid.h:104</a></div></div>
<div class="ttc" id="aKid_8h_html_ac1e0add708b10c910202aee51b8cbed9a684f7b9219a3e837425c5b5b90442bf3"><div class="ttname"><a href="Kid_8h.html#ac1e0add708b10c910202aee51b8cbed9a684f7b9219a3e837425c5b5b90442bf3">pkDisker</a></div><div class="ttdeci">@ pkDisker</div><div class="ttdoc">cache_dir manager</div><div class="ttdef"><b>Definition</b> <a href="Kid_8h_source.html#l00106">Kid.h:106</a></div></div>
<div class="ttc" id="aKids_8cc_html_ae810517ff17a890d25b6820785665ed0"><div class="ttname"><a href="Kids_8cc.html#ae810517ff17a890d25b6820785665ed0">TheKids</a></div><div class="ttdeci">Kids TheKids</div><div class="ttdoc">All kids being maintained.</div><div class="ttdef"><b>Definition</b> <a href="Kids_8cc_source.html#l00018">Kids.cc:18</a></div></div>
<div class="ttc" id="aKids_8h_html"><div class="ttname"><a href="Kids_8h.html">Kids.h</a></div></div>
<div class="ttc" id="aMemBuf_8h_html"><div class="ttname"><a href="MemBuf_8h.html">MemBuf.h</a></div></div>
<div class="ttc" id="aPool_8cc_html_a161e26ef0307ccb4300ad3ea54bf9fd4"><div class="ttname"><a href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a></div><div class="ttdeci">time_t squid_curtime</div><div class="ttdef"><b>Definition</b> <a href="stub__libtime_8cc_source.html#l00020">stub_libtime.cc:20</a></div></div>
<div class="ttc" id="aPortCfg_8cc_html_a31b693c418c2d271a30c0d70c2fbb170"><div class="ttname"><a href="PortCfg_8cc.html#a31b693c418c2d271a30c0d70c2fbb170">FtpPortList</a></div><div class="ttdeci">AnyP::PortCfgPointer FtpPortList</div><div class="ttdoc">list of Squid ftp_port configured</div><div class="ttdef"><b>Definition</b> <a href="PortCfg_8cc_source.html#l00023">PortCfg.cc:23</a></div></div>
<div class="ttc" id="aPortCfg_8cc_html_ab5fc0d5e05159674db133b2f17786721"><div class="ttname"><a href="PortCfg_8cc.html#ab5fc0d5e05159674db133b2f17786721">HttpPortList</a></div><div class="ttdeci">AnyP::PortCfgPointer HttpPortList</div><div class="ttdoc">list of Squid http(s)_port configured</div><div class="ttdef"><b>Definition</b> <a href="PortCfg_8cc_source.html#l00022">PortCfg.cc:22</a></div></div>
<div class="ttc" id="aPortCfg_8h_html"><div class="ttname"><a href="PortCfg_8h.html">PortCfg.h</a></div></div>
<div class="ttc" id="aQosConfig_8h_html"><div class="ttname"><a href="QosConfig_8h.html">QosConfig.h</a></div></div>
<div class="ttc" id="aSquidConfig_8cc_html_a75b136e6a1eef61424d84596a404aafe"><div class="ttname"><a href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a></div><div class="ttdeci">class SquidConfig Config</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8cc_source.html#l00012">SquidConfig.cc:12</a></div></div>
<div class="ttc" id="aSquidConfig_8cc_html_aee3a9c37e62203dfdb929215f0f8fc0a"><div class="ttname"><a href="SquidConfig_8cc.html#aee3a9c37e62203dfdb929215f0f8fc0a">Config2</a></div><div class="ttdeci">class SquidConfig2 Config2</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8cc_source.html#l00014">SquidConfig.cc:14</a></div></div>
<div class="ttc" id="aSquidConfig_8h_html"><div class="ttname"><a href="SquidConfig_8h.html">SquidConfig.h</a></div></div>
<div class="ttc" id="aSquidMath_8h_html"><div class="ttname"><a href="SquidMath_8h.html">SquidMath.h</a></div></div>
<div class="ttc" id="aSubscription_8h_html"><div class="ttname"><a href="Subscription_8h.html">Subscription.h</a></div></div>
<div class="ttc" id="aTextException_8cc_html_aa73ff10b84f321d18602cf47b8695dd5"><div class="ttname"><a href="TextException_8cc.html#aa73ff10b84f321d18602cf47b8695dd5">CurrentException</a></div><div class="ttdeci">std::ostream &amp; CurrentException(std::ostream &amp;os)</div><div class="ttdoc">prints active (i.e., thrown but not yet handled) exception</div><div class="ttdef"><b>Definition</b> <a href="TextException_8cc_source.html#l00088">TextException.cc:88</a></div></div>
<div class="ttc" id="aTextException_8h_html_ad79a19f4098f2506d0aa28628f18fd36"><div class="ttname"><a href="TextException_8h.html#ad79a19f4098f2506d0aa28628f18fd36">Must</a></div><div class="ttdeci">#define Must(condition)</div><div class="ttdef"><b>Definition</b> <a href="TextException_8h_source.html#l00075">TextException.h:75</a></div></div>
<div class="ttc" id="aassert_8h_html_a33fa45e42155e69ce8d0da0fd978b351"><div class="ttname"><a href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a></div><div class="ttdeci">#define assert(EX)</div><div class="ttdef"><b>Definition</b> <a href="assert_8h_source.html#l00017">assert.h:17</a></div></div>
<div class="ttc" id="aautoconf_8h_html_a7ebe85524e31350a2120834b1f238c89"><div class="ttname"><a href="autoconf_8h.html#a7ebe85524e31350a2120834b1f238c89">USE_LIBNETFILTERCONNTRACK</a></div><div class="ttdeci">#define USE_LIBNETFILTERCONNTRACK</div><div class="ttdef"><b>Definition</b> <a href="autoconf_8h_source.html#l01535">autoconf.h:1535</a></div></div>
<div class="ttc" id="aclassDebug_html_a2a385f2268b9dcd172c0c5dceeb8fa7c"><div class="ttname"><a href="classDebug.html#a2a385f2268b9dcd172c0c5dceeb8fa7c">Debug::parseOptions</a></div><div class="ttdeci">static void parseOptions(char const *)</div><div class="ttdef"><b>Definition</b> <a href="src_2debug_2debug_8cc_source.html#l01095">debug.cc:1095</a></div></div>
<div class="ttc" id="aclassDebug_html_a2e5397f0fd9abedca3410cf4c5157080"><div class="ttname"><a href="classDebug.html#a2e5397f0fd9abedca3410cf4c5157080">Debug::PrepareToDie</a></div><div class="ttdeci">static void PrepareToDie()</div><div class="ttdef"><b>Definition</b> <a href="src_2debug_2debug_8cc_source.html#l00563">debug.cc:563</a></div></div>
<div class="ttc" id="aclassDebug_html_a469eccf6573cacd9bc0682d3fc0eaf11"><div class="ttname"><a href="classDebug.html#a469eccf6573cacd9bc0682d3fc0eaf11">Debug::Extra</a></div><div class="ttdeci">static std::ostream &amp; Extra(std::ostream &amp;)</div><div class="ttdef"><b>Definition</b> <a href="src_2debug_2debug_8cc_source.html#l01316">debug.cc:1316</a></div></div>
<div class="ttc" id="aclassDebug_html_a9dd097f58b099973a900735048dfdf22"><div class="ttname"><a href="classDebug.html#a9dd097f58b099973a900735048dfdf22">Debug::debugOptions</a></div><div class="ttdeci">static char * debugOptions</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00080">Stream.h:80</a></div></div>
<div class="ttc" id="aclassIp_1_1Address_html"><div class="ttname"><a href="classIp_1_1Address.html">Ip::Address</a></div><div class="ttdef"><b>Definition</b> <a href="ip_2Address_8h_source.html#l00042">Address.h:43</a></div></div>
<div class="ttc" id="aclassIp_1_1Address_html_a4849e5673be56c29ab0289635a55fc21"><div class="ttname"><a href="classIp_1_1Address.html#a4849e5673be56c29ab0289635a55fc21">Ip::Address::FreeAddr</a></div><div class="ttdeci">static void FreeAddr(struct addrinfo *&amp;ai)</div><div class="ttdef"><b>Definition</b> <a href="ip_2Address_8cc_source.html#l00698">Address.cc:698</a></div></div>
<div class="ttc" id="aclassIp_1_1Address_html_a51e449414ca813e4f1aa62e9c1f3b384"><div class="ttname"><a href="classIp_1_1Address.html#a51e449414ca813e4f1aa62e9c1f3b384">Ip::Address::getAddrInfo</a></div><div class="ttdeci">void getAddrInfo(struct addrinfo *&amp;ai, int force=AF_UNSPEC) const</div><div class="ttdef"><b>Definition</b> <a href="ip_2Address_8cc_source.html#l00619">Address.cc:619</a></div></div>
<div class="ttc" id="aclassIp_1_1Address_html_ab00ddff71da22c55159fdc8176e14ea4"><div class="ttname"><a href="classIp_1_1Address.html#ab00ddff71da22c55159fdc8176e14ea4">Ip::Address::isAnyAddr</a></div><div class="ttdeci">bool isAnyAddr() const</div><div class="ttdef"><b>Definition</b> <a href="ip_2Address_8cc_source.html#l00190">Address.cc:190</a></div></div>
<div class="ttc" id="aclassKids_html_a1af8a884f6408402dd897412b7716d19"><div class="ttname"><a href="classKids.html#a1af8a884f6408402dd897412b7716d19">Kids::count</a></div><div class="ttdeci">size_t count() const</div><div class="ttdoc">returns the number of kids</div><div class="ttdef"><b>Definition</b> <a href="Kids_8cc_source.html#l00146">Kids.cc:146</a></div></div>
<div class="ttc" id="aclassKids_html_a81c8c67375ac03b2b242064bfd4d0aed"><div class="ttname"><a href="classKids.html#a81c8c67375ac03b2b242064bfd4d0aed">Kids::get</a></div><div class="ttdeci">Kid &amp; get(size_t i)</div><div class="ttdoc">returns the kid by index, useful for kids iteration</div><div class="ttdef"><b>Definition</b> <a href="Kids_8cc_source.html#l00060">Kids.cc:60</a></div></div>
<div class="ttc" id="aclassMemBuf_html"><div class="ttname"><a href="classMemBuf.html">MemBuf</a></div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8h_source.html#l00023">MemBuf.h:24</a></div></div>
<div class="ttc" id="aclassMemBuf_html_a085688f536a13949b005f7bb59bae333"><div class="ttname"><a href="classMemBuf.html#a085688f536a13949b005f7bb59bae333">MemBuf::clean</a></div><div class="ttdeci">void clean()</div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8cc_source.html#l00110">MemBuf.cc:110</a></div></div>
<div class="ttc" id="aclassMemBuf_html_a2e7319f5feaf76c1fd43f163a87ddaad"><div class="ttname"><a href="classMemBuf.html#a2e7319f5feaf76c1fd43f163a87ddaad">MemBuf::append</a></div><div class="ttdeci">void append(const char *c, int sz) override</div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8cc_source.html#l00209">MemBuf.cc:209</a></div></div>
<div class="ttc" id="aclassMemBuf_html_a4a615d8e887439c66e04aab70f8be60a"><div class="ttname"><a href="classMemBuf.html#a4a615d8e887439c66e04aab70f8be60a">MemBuf::init</a></div><div class="ttdeci">void init(mb_size_t szInit, mb_size_t szMax)</div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8cc_source.html#l00093">MemBuf.cc:93</a></div></div>
<div class="ttc" id="aclassMemBuf_html_a78daaa064a5aa4557e283a01c4aa27f1"><div class="ttname"><a href="classMemBuf.html#a78daaa064a5aa4557e283a01c4aa27f1">MemBuf::buf</a></div><div class="ttdeci">char * buf</div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8h_source.html#l00134">MemBuf.h:134</a></div></div>
<div class="ttc" id="aclassRefCount_html"><div class="ttname"><a href="classRefCount.html">RefCount&lt; PortCfg &gt;</a></div></div>
<div class="ttc" id="aclassSBuf_html"><div class="ttname"><a href="classSBuf.html">SBuf</a></div><div class="ttdef"><b>Definition</b> <a href="SBuf_8h_source.html#l00093">SBuf.h:94</a></div></div>
<div class="ttc" id="aclassSBuf_html_aa12ede16b167c60722946fc8fe9292da"><div class="ttname"><a href="classSBuf.html#aa12ede16b167c60722946fc8fe9292da">SBuf::append</a></div><div class="ttdeci">SBuf &amp; append(const SBuf &amp;S)</div><div class="ttdef"><b>Definition</b> <a href="SBuf_8cc_source.html#l00185">SBuf.cc:185</a></div></div>
<div class="ttc" id="aclassSquidConfig2_html_a5239d8470bb8fcb43885e8dcdc89bc33"><div class="ttname"><a href="classSquidConfig2.html#a5239d8470bb8fcb43885e8dcdc89bc33">SquidConfig2::effectiveGroupID</a></div><div class="ttdeci">gid_t effectiveGroupID</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00565">SquidConfig.h:565</a></div></div>
<div class="ttc" id="aclassSquidConfig2_html_aab400ddf1203bca5c022e20b9078c10f"><div class="ttname"><a href="classSquidConfig2.html#aab400ddf1203bca5c022e20b9078c10f">SquidConfig2::effectiveUserID</a></div><div class="ttdeci">uid_t effectiveUserID</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00564">SquidConfig.h:564</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a14afd25e14f208317b1677f7a375e0b8"><div class="ttname"><a href="classSquidConfig.html#a14afd25e14f208317b1677f7a375e0b8">SquidConfig::max_filedescriptors</a></div><div class="ttdeci">int max_filedescriptors</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00520">SquidConfig.h:520</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a19a58dfeb6962b193a022cb7b5158532"><div class="ttname"><a href="classSquidConfig.html#a19a58dfeb6962b193a022cb7b5158532">SquidConfig::effectiveGroup</a></div><div class="ttdeci">char * effectiveGroup</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00198">SquidConfig.h:198</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a2ac9602c982f06bd961c7f8cdc811c4a"><div class="ttname"><a href="classSquidConfig.html#a2ac9602c982f06bd961c7f8cdc811c4a">SquidConfig::EmailFrom</a></div><div class="ttdeci">char * EmailFrom</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00194">SquidConfig.h:194</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a47e431e4fc6fe596f78254faf0f00a3f"><div class="ttname"><a href="classSquidConfig.html#a47e431e4fc6fe596f78254faf0f00a3f">SquidConfig::etcHostsPath</a></div><div class="ttdeci">char * etcHostsPath</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00227">SquidConfig.h:227</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a5ed1acd7a82726b16c8697d37acd5f24"><div class="ttname"><a href="classSquidConfig.html#a5ed1acd7a82726b16c8697d37acd5f24">SquidConfig::cacheSwap</a></div><div class="ttdeci">Store::DiskConfig cacheSwap</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00423">SquidConfig.h:423</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a6382b11d001515f712a0462d5e277280"><div class="ttname"><a href="classSquidConfig.html#a6382b11d001515f712a0462d5e277280">SquidConfig::appendDomain</a></div><div class="ttdeci">char * appendDomain</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00222">SquidConfig.h:222</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a696c5b17082eaf11e62e8a1696ce3515"><div class="ttname"><a href="classSquidConfig.html#a696c5b17082eaf11e62e8a1696ce3515">SquidConfig::coredump_dir</a></div><div class="ttdeci">char * coredump_dir</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00472">SquidConfig.h:472</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_ab3b7b7e2644459cd54810f9f56a1ec09"><div class="ttname"><a href="classSquidConfig.html#ab3b7b7e2644459cd54810f9f56a1ec09">SquidConfig::visibleHostname</a></div><div class="ttdeci">char * visibleHostname</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00228">SquidConfig.h:228</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_ab4795036e0bac3bea76a98114a49c3bd"><div class="ttname"><a href="classSquidConfig.html#ab4795036e0bac3bea76a98114a49c3bd">SquidConfig::adminEmail</a></div><div class="ttdeci">char * adminEmail</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00193">SquidConfig.h:193</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_ac27ae3043929d5a370177e9c61769a44"><div class="ttname"><a href="classSquidConfig.html#ac27ae3043929d5a370177e9c61769a44">SquidConfig::uniqueHostname</a></div><div class="ttdeci">char * uniqueHostname</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00229">SquidConfig.h:229</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_ac8007cb4be4fab48e760e825a1e9c3ae"><div class="ttname"><a href="classSquidConfig.html#ac8007cb4be4fab48e760e825a1e9c3ae">SquidConfig::workers</a></div><div class="ttdeci">int workers</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00521">SquidConfig.h:521</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_acc970d633b01dee4e5431a55dce44861"><div class="ttname"><a href="classSquidConfig.html#acc970d633b01dee4e5431a55dce44861">SquidConfig::EmailProgram</a></div><div class="ttdeci">char * EmailProgram</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00195">SquidConfig.h:195</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_adc42d93b04f7699435cfe93d2e9fd159"><div class="ttname"><a href="classSquidConfig.html#adc42d93b04f7699435cfe93d2e9fd159">SquidConfig::effectiveUser</a></div><div class="ttdeci">char * effectiveUser</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00196">SquidConfig.h:196</a></div></div>
<div class="ttc" id="aclassStore_1_1DiskConfig_html_af0932ae17c059cebdd990eb45175201a"><div class="ttname"><a href="classStore_1_1DiskConfig.html#af0932ae17c059cebdd990eb45175201a">Store::DiskConfig::n_strands</a></div><div class="ttdeci">int n_strands</div><div class="ttdoc">number of disk processes required to support all cache_dirs</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00072">SquidConfig.h:72</a></div></div>
<div class="ttc" id="aclassTextException_html"><div class="ttname"><a href="classTextException.html">TextException</a></div><div class="ttdoc">an std::runtime_error with thrower location info</div><div class="ttdef"><b>Definition</b> <a href="TextException_8h_source.html#l00020">TextException.h:21</a></div></div>
<div class="ttc" id="aclient__side_8cc_html_ae29c88c073239e35ef8f8a82e9d5f689"><div class="ttname"><a href="client__side_8cc.html#ae29c88c073239e35ef8f8a82e9d5f689">clientConnectionsClose</a></div><div class="ttdeci">void clientConnectionsClose()</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l03370">client_side.cc:3370</a></div></div>
<div class="ttc" id="aclient__side_8h_html"><div class="ttname"><a href="client__side_8h.html">client_side.h</a></div></div>
<div class="ttc" id="acompat__shared_8h_html_af172ea808e99a9f4d4cc3631a496f246"><div class="ttname"><a href="compat__shared_8h.html#af172ea808e99a9f4d4cc3631a496f246">w_space</a></div><div class="ttdeci">#define w_space</div><div class="ttdef"><b>Definition</b> <a href="compat__shared_8h_source.html#l00139">compat_shared.h:139</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_ad1f6f001d275799243ee96d0b1519d3a"><div class="ttname"><a href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a></div><div class="ttdeci">#define DBG_IMPORTANT</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00038">Stream.h:38</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_ad8cd33a7d75c0efd4d3fd369dc6a8f13"><div class="ttname"><a href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a></div><div class="ttdeci">#define debugs(SECTION, LEVEL, CONTENT)</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00192">Stream.h:192</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_af0ecf487aee4d8ff164c0f40e71c5150"><div class="ttname"><a href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a></div><div class="ttdeci">#define DBG_CRITICAL</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00037">Stream.h:37</a></div></div>
<div class="ttc" id="adefines_8h_html_a9abb6d01b83e0bc5a6e2adeceb7dffd7"><div class="ttname"><a href="defines_8h.html#a9abb6d01b83e0bc5a6e2adeceb7dffd7">O_TEXT</a></div><div class="ttdeci">#define O_TEXT</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00131">defines.h:131</a></div></div>
<div class="ttc" id="adefines_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="defines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00016">defines.h:16</a></div></div>
<div class="ttc" id="afatal_8cc_html_acc07a91f0719197c09905b693f687962"><div class="ttname"><a href="fatal_8cc.html#acc07a91f0719197c09905b693f687962">fatal_dump</a></div><div class="ttdeci">void fatal_dump(const char *message)</div><div class="ttdef"><b>Definition</b> <a href="fatal_8cc_source.html#l00078">fatal.cc:78</a></div></div>
<div class="ttc" id="afatal_8cc_html_ae0269dd75e50d469da2f2416e0cfb7cf"><div class="ttname"><a href="fatal_8cc.html#ae0269dd75e50d469da2f2416e0cfb7cf">fatalf</a></div><div class="ttdeci">void fatalf(const char *fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="fatal_8cc_source.html#l00068">fatal.cc:68</a></div></div>
<div class="ttc" id="afatal_8h_html"><div class="ttname"><a href="fatal_8h.html">fatal.h</a></div></div>
<div class="ttc" id="afde_8h_html"><div class="ttname"><a href="fde_8h.html">fde.h</a></div></div>
<div class="ttc" id="afqdncache_8cc_html_a22774f484e90bd1d10b744e89d7f3757"><div class="ttname"><a href="fqdncache_8cc.html#a22774f484e90bd1d10b744e89d7f3757">fqdncacheAddEntryFromHosts</a></div><div class="ttdeci">void fqdncacheAddEntryFromHosts(char *addr, SBufList &amp;hostnames)</div><div class="ttdef"><b>Definition</b> <a href="fqdncache_8cc_source.html#l00636">fqdncache.cc:636</a></div></div>
<div class="ttc" id="afqdncache_8h_html"><div class="ttname"><a href="fqdncache_8h.html">fqdncache.h</a></div></div>
<div class="ttc" id="afs__io_8h_html"><div class="ttname"><a href="fs__io_8h.html">fs_io.h</a></div></div>
<div class="ttc" id="aglobals_8h_html_a506a078460793d09337c2ef6455e3600"><div class="ttname"><a href="globals_8h.html#a506a078460793d09337c2ef6455e3600">opt_no_daemon</a></div><div class="ttdeci">int opt_no_daemon</div></div>
<div class="ttc" id="aglobals_8h_html_a7f68568851b9c7f9291f7bb63f932c18"><div class="ttname"><a href="globals_8h.html#a7f68568851b9c7f9291f7bb63f932c18">shutting_down</a></div><div class="ttdeci">int shutting_down</div><div class="ttdef"><b>Definition</b> <a href="testConfigParser_8cc_source.html#l00032">testConfigParser.cc:32</a></div></div>
<div class="ttc" id="aglobals_8h_html_a8042d0ef3deb220500d4c3a0c1382f07"><div class="ttname"><a href="globals_8h.html#a8042d0ef3deb220500d4c3a0c1382f07">version_string</a></div><div class="ttdeci">const char * version_string</div></div>
<div class="ttc" id="aglobals_8h_html_a85fb5b16080caacaaf9ca40e713fccb9"><div class="ttname"><a href="globals_8h.html#a85fb5b16080caacaaf9ca40e713fccb9">Squid_MaxFD</a></div><div class="ttdeci">int Squid_MaxFD</div></div>
<div class="ttc" id="aglobals_8h_html_acbcc517d9fc53da8b134cff4d0d4296c"><div class="ttname"><a href="globals_8h.html#acbcc517d9fc53da8b134cff4d0d4296c">opt_catch_signals</a></div><div class="ttdeci">int opt_catch_signals</div></div>
<div class="ttc" id="aglobals_8h_html_af77df4d76eae10fa0cbc6e885b0d32c6"><div class="ttname"><a href="globals_8h.html#af77df4d76eae10fa0cbc6e885b0d32c6">KidIdentifier</a></div><div class="ttdeci">int KidIdentifier</div></div>
<div class="ttc" id="agroup__IPCacheAPI_html_gac9e7ec52b691b11df3ee29ed24004ca7"><div class="ttname"><a href="group__IPCacheAPI.html#gac9e7ec52b691b11df3ee29ed24004ca7">ipcacheAddEntryFromHosts</a></div><div class="ttdeci">int ipcacheAddEntryFromHosts(const char *name, const char *ipaddr)</div><div class="ttdef"><b>Definition</b> <a href="ipcache_8cc_source.html#l01126">ipcache.cc:1126</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_gaaab2644af97fc6b985191a986b334115"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#gaaab2644af97fc6b985191a986b334115">icpClosePorts</a></div><div class="ttdeci">void icpClosePorts(void)</div><div class="ttdef"><b>Definition</b> <a href="icp__v2_8cc_source.html#l00784">icp_v2.cc:784</a></div></div>
<div class="ttc" id="ahtcp_8h_html"><div class="ttname"><a href="htcp_8h.html">htcp.h</a></div></div>
<div class="ttc" id="ahttp_2Stream_8h_html"><div class="ttname"><a href="http_2Stream_8h.html">Stream.h</a></div></div>
<div class="ttc" id="ainitgroups_8c_html_a9c6178c435287e685ff3df23c5a3c0db"><div class="ttname"><a href="initgroups_8c.html#a9c6178c435287e685ff3df23c5a3c0db">initgroups</a></div><div class="ttdeci">int initgroups(const char *name, gid_t basegid)</div><div class="ttdef"><b>Definition</b> <a href="initgroups_8c_source.html#l00028">initgroups.c:28</a></div></div>
<div class="ttc" id="aipcache_8h_html"><div class="ttname"><a href="ipcache_8h.html">ipcache.h</a></div></div>
<div class="ttc" id="anamespaceIp_1_1Qos_html_a82d2b4c8d940bbb4853ccafbb33da971"><div class="ttname"><a href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a></div><div class="ttdeci">Config TheConfig</div><div class="ttdoc">Globally available instance of Qos::Config.</div><div class="ttdef"><b>Definition</b> <a href="QosConfig_8cc_source.html#l00288">QosConfig.cc:288</a></div></div>
<div class="ttc" id="anamespaceMath_html_a5c5c74f00ace4f0a2b80f1b13900b6ce"><div class="ttname"><a href="namespaceMath.html#a5c5c74f00ace4f0a2b80f1b13900b6ce">Math::intPercent</a></div><div class="ttdeci">int intPercent(const int a, const int b)</div><div class="ttdef"><b>Definition</b> <a href="SquidMath_8cc_source.html#l00013">SquidMath.cc:13</a></div></div>
<div class="ttc" id="anegotiate__wrapper_8cc_html_a2c3897f7c46ca54a2e0dd7b24a40c7cb"><div class="ttname"><a href="negotiate__wrapper_8cc.html#a2c3897f7c46ca54a2e0dd7b24a40c7cb">xfree</a></div><div class="ttdeci">#define xfree</div><div class="ttdef"><b>Definition</b> <a href="negotiate__wrapper_8cc_source.html#l00050">negotiate_wrapper.cc:50</a></div></div>
<div class="ttc" id="arfc2181_8h_html_a17573070c1b8cdd6570e594c23d4addb"><div class="ttname"><a href="rfc2181_8h.html#a17573070c1b8cdd6570e594c23d4addb">SQUIDHOSTNAMELEN</a></div><div class="ttdeci">#define SQUIDHOSTNAMELEN</div><div class="ttdef"><b>Definition</b> <a href="rfc2181_8h_source.html#l00030">rfc2181.h:30</a></div></div>
<div class="ttc" id="asbuf_2Stream_8h_html"><div class="ttname"><a href="sbuf_2Stream_8h.html">Stream.h</a></div></div>
<div class="ttc" id="asbuf_2Stream_8h_html_a6160c2bd5c3883a54866ccfd670ce4b6"><div class="ttname"><a href="sbuf_2Stream_8h.html#a6160c2bd5c3883a54866ccfd670ce4b6">ToSBuf</a></div><div class="ttdeci">SBuf ToSBuf(Args &amp;&amp;... args)</div><div class="ttdoc">slowly stream-prints all arguments into a freshly allocated SBuf</div><div class="ttdef"><b>Definition</b> <a href="sbuf_2Stream_8h_source.html#l00063">Stream.h:63</a></div></div>
<div class="ttc" id="asbuf_2forward_8h_html_a61ea2a38dc40862c32fc44508639f6b7"><div class="ttname"><a href="sbuf_2forward_8h.html#a61ea2a38dc40862c32fc44508639f6b7">SBufList</a></div><div class="ttdeci">std::list&lt; SBuf &gt; SBufList</div><div class="ttdef"><b>Definition</b> <a href="sbuf_2forward_8h_source.html#l00023">forward.h:23</a></div></div>
<div class="ttc" id="asquid_8h_html"><div class="ttname"><a href="squid_8h.html">squid.h</a></div></div>
<div class="ttc" id="asquid_8h_html_a5a27f30c91ea4f16ae5ea4cf73a3af1e"><div class="ttname"><a href="squid_8h.html#a5a27f30c91ea4f16ae5ea4cf73a3af1e">SQUIDCEXTERN</a></div><div class="ttdeci">#define SQUIDCEXTERN</div><div class="ttdef"><b>Definition</b> <a href="squid_8h_source.html#l00021">squid.h:21</a></div></div>
<div class="ttc" id="asquid_8h_html_a9b17dd86bdde2e8cb89abe153a0f4f23"><div class="ttname"><a href="squid_8h.html#a9b17dd86bdde2e8cb89abe153a0f4f23">LOCAL_ARRAY</a></div><div class="ttdeci">#define LOCAL_ARRAY(type, name, size)</div><div class="ttdef"><b>Definition</b> <a href="squid_8h_source.html#l00062">squid.h:62</a></div></div>
<div class="ttc" id="asrc_2debug_2debug_8cc_html_a0d2107ed0503ce532330be150c12906b"><div class="ttname"><a href="src_2debug_2debug_8cc.html#a0d2107ed0503ce532330be150c12906b">DebugStream</a></div><div class="ttdeci">FILE * DebugStream()</div><div class="ttdef"><b>Definition</b> <a href="src_2debug_2debug_8cc_source.html#l00355">debug.cc:355</a></div></div>
<div class="ttc" id="asrc_2debug_2debug_8cc_html_afa63af9ce4437935536dcc32dc78f232"><div class="ttname"><a href="src_2debug_2debug_8cc.html#afa63af9ce4437935536dcc32dc78f232">ForceAlert</a></div><div class="ttdeci">std::ostream &amp; ForceAlert(std::ostream &amp;s)</div><div class="ttdef"><b>Definition</b> <a href="src_2debug_2debug_8cc_source.html#l01411">debug.cc:1411</a></div></div>
<div class="ttc" id="astructrusage_html"><div class="ttname"><a href="structrusage.html">rusage</a></div><div class="ttdef"><b>Definition</b> <a href="compat__shared_8h_source.html#l00086">compat_shared.h:86</a></div></div>
<div class="ttc" id="astructrusage_html_a42c294483743ea16b9a77f22a2e7660a"><div class="ttname"><a href="structrusage.html#a42c294483743ea16b9a77f22a2e7660a">rusage::ru_utime</a></div><div class="ttdeci">struct timeval ru_utime</div><div class="ttdef"><b>Definition</b> <a href="compat__shared_8h_source.html#l00088">compat_shared.h:88</a></div></div>
<div class="ttc" id="astructrusage_html_a7776ee7a6ec11f32ad4c8d1b0862ceb8"><div class="ttname"><a href="structrusage.html#a7776ee7a6ec11f32ad4c8d1b0862ceb8">rusage::ru_stime</a></div><div class="ttdeci">struct timeval ru_stime</div><div class="ttdef"><b>Definition</b> <a href="compat__shared_8h_source.html#l00087">compat_shared.h:87</a></div></div>
<div class="ttc" id="astructrusage_html_aaab0520284d00829128c9d4f7b4e8e5c"><div class="ttname"><a href="structrusage.html#aaab0520284d00829128c9d4f7b4e8e5c">rusage::ru_majflt</a></div><div class="ttdeci">int ru_majflt</div><div class="ttdef"><b>Definition</b> <a href="compat__shared_8h_source.html#l00090">compat_shared.h:90</a></div></div>
<div class="ttc" id="astructrusage_html_ac6be8a64711191559acb2a53b5aee13f"><div class="ttname"><a href="structrusage.html#ac6be8a64711191559acb2a53b5aee13f">rusage::ru_maxrss</a></div><div class="ttdeci">int ru_maxrss</div><div class="ttdef"><b>Definition</b> <a href="compat__shared_8h_source.html#l00089">compat_shared.h:89</a></div></div>
<div class="ttc" id="astub__event_8cc_html_a0c9547f061079f5587b085091da968bc"><div class="ttname"><a href="stub__event_8cc.html#a0c9547f061079f5587b085091da968bc">double</a></div><div class="ttdeci">void EVH void double</div><div class="ttdef"><b>Definition</b> <a href="stub__event_8cc_source.html#l00016">stub_event.cc:16</a></div></div>
<div class="ttc" id="atempnam_8c_html_a2e4097d8f42453a291c13ba31fabb8fe"><div class="ttname"><a href="tempnam_8c.html#a2e4097d8f42453a291c13ba31fabb8fe">tempnam</a></div><div class="ttdeci">char * tempnam(const char *dir, const char *pfx)</div><div class="ttdef"><b>Definition</b> <a href="tempnam_8c_source.html#l00119">tempnam.c:119</a></div></div>
<div class="ttc" id="atools_8cc_html_a08dbd97a5d802d0e1d9aa371fd78d833"><div class="ttname"><a href="tools_8cc.html#a08dbd97a5d802d0e1d9aa371fd78d833">leave_suid</a></div><div class="ttdeci">void leave_suid(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00560">tools.cc:560</a></div></div>
<div class="ttc" id="atools_8cc_html_a0dd04d9cb210881c11ed9569084f2b93"><div class="ttname"><a href="tools_8cc.html#a0dd04d9cb210881c11ed9569084f2b93">IamMasterProcess</a></div><div class="ttdeci">bool IamMasterProcess()</div><div class="ttdoc">whether the current process is the parent of all other Squid processes</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00669">tools.cc:669</a></div></div>
<div class="ttc" id="atools_8cc_html_a1046f2abceb2cbd87c41c5738963da42"><div class="ttname"><a href="tools_8cc.html#a1046f2abceb2cbd87c41c5738963da42">setTraceability</a></div><div class="ttdeci">static void setTraceability()</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00315">tools.cc:315</a></div></div>
<div class="ttc" id="atools_8cc_html_a10f41cff25f01cde151c8f9b522a87da"><div class="ttname"><a href="tools_8cc.html#a10f41cff25f01cde151c8f9b522a87da">makeTraceable</a></div><div class="ttdeci">static void makeTraceable()</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00289">tools.cc:289</a></div></div>
<div class="ttc" id="atools_8cc_html_a11605459b73b3fdcfbb0ad8ae23f6d4d"><div class="ttname"><a href="tools_8cc.html#a11605459b73b3fdcfbb0ad8ae23f6d4d">InDaemonMode</a></div><div class="ttdeci">bool InDaemonMode()</div><div class="ttdoc">Whether we are running in daemon mode.</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00691">tools.cc:691</a></div></div>
<div class="ttc" id="atools_8cc_html_a1381bd0ef88fab270bbd0d6fbfc9e71d"><div class="ttname"><a href="tools_8cc.html#a1381bd0ef88fab270bbd0d6fbfc9e71d">strwordquote</a></div><div class="ttdeci">void strwordquote(MemBuf *mb, const char *str)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l01081">tools.cc:1081</a></div></div>
<div class="ttc" id="atools_8cc_html_a1a0dc432bc9c2539eabfad999ffad17e"><div class="ttname"><a href="tools_8cc.html#a1a0dc432bc9c2539eabfad999ffad17e">squid_signal</a></div><div class="ttdeci">void squid_signal(int sig, SIGHDLR *func, int flags)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00874">tools.cc:874</a></div></div>
<div class="ttc" id="atools_8cc_html_a293e84bd2ac9ca7edddac9a88a6042d2"><div class="ttname"><a href="tools_8cc.html#a293e84bd2ac9ca7edddac9a88a6042d2">WaitForOnePid</a></div><div class="ttdeci">pid_t WaitForOnePid(pid_t pid, PidStatus &amp;status, int flags)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l01181">tools.cc:1181</a></div></div>
<div class="ttc" id="atools_8cc_html_a2a195065f59151742dac1bc54c3ef1e9"><div class="ttname"><a href="tools_8cc.html#a2a195065f59151742dac1bc54c3ef1e9">IamWorkerProcess</a></div><div class="ttdeci">bool IamWorkerProcess()</div><div class="ttdoc">whether the current process handles HTTP transactions and such</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00675">tools.cc:675</a></div></div>
<div class="ttc" id="atools_8cc_html_a2d24834d9959fb3fa7d4789d055c1768"><div class="ttname"><a href="tools_8cc.html#a2d24834d9959fb3fa7d4789d055c1768">getMyHostname</a></div><div class="ttdeci">const char * getMyHostname(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00468">tools.cc:468</a></div></div>
<div class="ttc" id="atools_8cc_html_a2fc1e2bbe922a98d916b3b0885b37bca"><div class="ttname"><a href="tools_8cc.html#a2fc1e2bbe922a98d916b3b0885b37bca">setUmask</a></div><div class="ttdeci">void setUmask(mode_t mask)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l01070">tools.cc:1070</a></div></div>
<div class="ttc" id="atools_8cc_html_a32417db3c55ab0d11148b4443c179a55"><div class="ttname"><a href="tools_8cc.html#a32417db3c55ab0d11148b4443c179a55">death</a></div><div class="ttdeci">void death(int sig)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00346">tools.cc:346</a></div></div>
<div class="ttc" id="atools_8cc_html_a440f44a135dccbb7691d4604ee318911"><div class="ttname"><a href="tools_8cc.html#a440f44a135dccbb7691d4604ee318911">keepCapabilities</a></div><div class="ttdeci">void keepCapabilities(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l01123">tools.cc:1123</a></div></div>
<div class="ttc" id="atools_8cc_html_a46150330f164d14c146710b72f9a708f"><div class="ttname"><a href="tools_8cc.html#a46150330f164d14c146710b72f9a708f">sigusr2_handle</a></div><div class="ttdeci">void sigusr2_handle(int sig)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00434">tools.cc:434</a></div></div>
<div class="ttc" id="atools_8cc_html_a46fb38cb0b42225bd640ed365f613dcd"><div class="ttname"><a href="tools_8cc.html#a46fb38cb0b42225bd640ed365f613dcd">setMaxFD</a></div><div class="ttdeci">void setMaxFD(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00763">tools.cc:763</a></div></div>
<div class="ttc" id="atools_8cc_html_a4e2c8a2a4f25987670751ba91129ee64"><div class="ttname"><a href="tools_8cc.html#a4e2c8a2a4f25987670751ba91129ee64">squid_getrusage</a></div><div class="ttdeci">void squid_getrusage(struct rusage *r)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00181">tools.cc:181</a></div></div>
<div class="ttc" id="atools_8cc_html_a5211acae55fc0688663f278e5adb4fd2"><div class="ttname"><a href="tools_8cc.html#a5211acae55fc0688663f278e5adb4fd2">dead_msg</a></div><div class="ttdeci">static char * dead_msg(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00108">tools.cc:108</a></div></div>
<div class="ttc" id="atools_8cc_html_a54bfd25568e58b17214890f121ada9f5"><div class="ttname"><a href="tools_8cc.html#a54bfd25568e58b17214890f121ada9f5">rusage_cputime</a></div><div class="ttdeci">double rusage_cputime(struct rusage *r)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00239">tools.cc:239</a></div></div>
<div class="ttc" id="atools_8cc_html_a5523592643da34411f7694bd980b1c86"><div class="ttname"><a href="tools_8cc.html#a5523592643da34411f7694bd980b1c86">IamPrimaryProcess</a></div><div class="ttdeci">bool IamPrimaryProcess()</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00709">tools.cc:709</a></div></div>
<div class="ttc" id="atools_8cc_html_a59b6b888e70a670dc77fe473b771ebe0"><div class="ttname"><a href="tools_8cc.html#a59b6b888e70a670dc77fe473b771ebe0">no_suid</a></div><div class="ttdeci">void no_suid(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00647">tools.cc:647</a></div></div>
<div class="ttc" id="atools_8cc_html_a62d0b814ae850a3635a29f0aded17a1d"><div class="ttname"><a href="tools_8cc.html#a62d0b814ae850a3635a29f0aded17a1d">rusage_maxrss</a></div><div class="ttdeci">int rusage_maxrss(struct rusage *r)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00254">tools.cc:254</a></div></div>
<div class="ttc" id="atools_8cc_html_a647dbf3a4a836003580c4df8a7447a32"><div class="ttname"><a href="tools_8cc.html#a647dbf3a4a836003580c4df8a7447a32">PrintRusage</a></div><div class="ttdeci">void PrintRusage(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00330">tools.cc:330</a></div></div>
<div class="ttc" id="atools_8cc_html_a688c14dce4c0f8b98f4477810a47cdf7"><div class="ttname"><a href="tools_8cc.html#a688c14dce4c0f8b98f4477810a47cdf7">service_name</a></div><div class="ttdeci">SBuf service_name(APP_SHORTNAME)</div></div>
<div class="ttc" id="atools_8cc_html_a6c9b4395a85c14d048039476a92dfd35"><div class="ttname"><a href="tools_8cc.html#a6c9b4395a85c14d048039476a92dfd35">NumberOfKids</a></div><div class="ttdeci">int NumberOfKids()</div><div class="ttdoc">number of Kid processes as defined in src/ipc/Kid.h</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00725">tools.cc:725</a></div></div>
<div class="ttc" id="atools_8cc_html_a70f753e1b684b3b9a4cefbc91b87d323"><div class="ttname"><a href="tools_8cc.html#a70f753e1b684b3b9a4cefbc91b87d323">DEAD_MSG</a></div><div class="ttdeci">#define DEAD_MSG</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00062">tools.cc:62</a></div></div>
<div class="ttc" id="atools_8cc_html_a7e908148934cae35e8e5f8b294f273f0"><div class="ttname"><a href="tools_8cc.html#a7e908148934cae35e8e5f8b294f273f0">enter_suid</a></div><div class="ttdeci">void enter_suid(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00624">tools.cc:624</a></div></div>
<div class="ttc" id="atools_8cc_html_a8250070b2038454ce1fe676d73268207"><div class="ttname"><a href="tools_8cc.html#a8250070b2038454ce1fe676d73268207">logsFlush</a></div><div class="ttdeci">void logsFlush(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00932">tools.cc:932</a></div></div>
<div class="ttc" id="atools_8cc_html_a8905d1b1ed6354e381bb48fc5ce505de"><div class="ttname"><a href="tools_8cc.html#a8905d1b1ed6354e381bb48fc5ce505de">getMyPort</a></div><div class="ttdeci">int getMyPort(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l01042">tools.cc:1042</a></div></div>
<div class="ttc" id="atools_8cc_html_a913579133199a9fb7b4c5f52500449cb"><div class="ttname"><a href="tools_8cc.html#a913579133199a9fb7b4c5f52500449cb">mail_warranty</a></div><div class="ttdeci">static void mail_warranty(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00116">tools.cc:116</a></div></div>
<div class="ttc" id="atools_8cc_html_aa2651f5e7d5ea2941a2004f3b115aa5f"><div class="ttname"><a href="tools_8cc.html#aa2651f5e7d5ea2941a2004f3b115aa5f">restoreCapabilities</a></div><div class="ttdeci">static void restoreCapabilities(bool keep)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l01133">tools.cc:1133</a></div></div>
<div class="ttc" id="atools_8cc_html_aa3f5a1d3a4bc67144cc318637612ddf1"><div class="ttname"><a href="tools_8cc.html#aa3f5a1d3a4bc67144cc318637612ddf1">debugObj</a></div><div class="ttdeci">void debugObj(int section, int level, const char *label, void *obj, ObjPackMethod pm)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00939">tools.cc:939</a></div></div>
<div class="ttc" id="atools_8cc_html_aa82acdab9e76fb7e5f1e527dd3743af7"><div class="ttname"><a href="tools_8cc.html#aa82acdab9e76fb7e5f1e527dd3743af7">DebugSignal</a></div><div class="ttdeci">int DebugSignal</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00074">tools.cc:74</a></div></div>
<div class="ttc" id="atools_8cc_html_aad006cb899b67822b8b66ac9f8f677be"><div class="ttname"><a href="tools_8cc.html#aad006cb899b67822b8b66ac9f8f677be">parseEtcHosts</a></div><div class="ttdeci">void parseEtcHosts(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00950">tools.cc:950</a></div></div>
<div class="ttc" id="atools_8cc_html_abf17a12ab2f03f92a22edeca4be36e19"><div class="ttname"><a href="tools_8cc.html#abf17a12ab2f03f92a22edeca4be36e19">debug_trap</a></div><div class="ttdeci">void debug_trap(const char *message)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00459">tools.cc:459</a></div></div>
<div class="ttc" id="atools_8cc_html_ac3de63d7e63475e7e12abff8034ce1f4"><div class="ttname"><a href="tools_8cc.html#ac3de63d7e63475e7e12abff8034ce1f4">rusage_pagefaults</a></div><div class="ttdeci">int rusage_pagefaults(struct rusage *r)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00275">tools.cc:275</a></div></div>
<div class="ttc" id="atools_8cc_html_acd6d0ab3c36623dc08ed6ae85d9d92f0"><div class="ttname"><a href="tools_8cc.html#acd6d0ab3c36623dc08ed6ae85d9d92f0">BroadcastSignalIfAny</a></div><div class="ttdeci">void BroadcastSignalIfAny(int &amp;sig)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00419">tools.cc:419</a></div></div>
<div class="ttc" id="atools_8cc_html_ad30d341dedd875664d4cbd400a692c57"><div class="ttname"><a href="tools_8cc.html#ad30d341dedd875664d4cbd400a692c57">IamCoordinatorProcess</a></div><div class="ttdeci">bool IamCoordinatorProcess()</div><div class="ttdoc">whether the current process coordinates worker processes</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00703">tools.cc:703</a></div></div>
<div class="ttc" id="atools_8cc_html_adbe2913b25bf470a7814f9ec4a0907d9"><div class="ttname"><a href="tools_8cc.html#adbe2913b25bf470a7814f9ec4a0907d9">uniqueHostname</a></div><div class="ttdeci">const char * uniqueHostname(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00548">tools.cc:548</a></div></div>
<div class="ttc" id="atools_8cc_html_ae01a14bde16513f1e27bdc329a07d8c6"><div class="ttname"><a href="tools_8cc.html#ae01a14bde16513f1e27bdc329a07d8c6">releaseServerSockets</a></div><div class="ttdeci">void releaseServerSockets(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00093">tools.cc:93</a></div></div>
<div class="ttc" id="atools_8cc_html_ae172c5dc1ff2a4e1e5fa32f121a5325a"><div class="ttname"><a href="tools_8cc.html#ae172c5dc1ff2a4e1e5fa32f121a5325a">dumpMallocStats</a></div><div class="ttdeci">void dumpMallocStats(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00167">tools.cc:167</a></div></div>
<div class="ttc" id="atools_8cc_html_aee258c896d60b03dd13d784cfd9a6482"><div class="ttname"><a href="tools_8cc.html#aee258c896d60b03dd13d784cfd9a6482">UsingSmp</a></div><div class="ttdeci">bool UsingSmp()</div><div class="ttdoc">Whether there should be more than one worker process running.</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00697">tools.cc:697</a></div></div>
<div class="ttc" id="atools_8cc_html_af085e872f4b156f1aaa6a5b5ed1717f3"><div class="ttname"><a href="tools_8cc.html#af085e872f4b156f1aaa6a5b5ed1717f3">ProcessRoles</a></div><div class="ttdeci">SBuf ProcessRoles()</div><div class="ttdoc">a string describing this process roles such as worker or coordinator</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00740">tools.cc:740</a></div></div>
<div class="ttc" id="atools_8cc_html_af8698c9fe041ec1a535b499b3269d886"><div class="ttname"><a href="tools_8cc.html#af8698c9fe041ec1a535b499b3269d886">IamDiskProcess</a></div><div class="ttdeci">bool IamDiskProcess()</div><div class="ttdoc">whether the current process is dedicated to managing a cache_dir</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00685">tools.cc:685</a></div></div>
<div class="ttc" id="atools_8cc_html_af965183167c843adb00c7a883ca38683"><div class="ttname"><a href="tools_8cc.html#af965183167c843adb00c7a883ca38683">setSystemLimits</a></div><div class="ttdeci">void setSystemLimits(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00812">tools.cc:812</a></div></div>
<div class="ttc" id="atools_8cc_html_afa323391d10a0cbfc7867bcf43ce02b7"><div class="ttname"><a href="tools_8cc.html#afa323391d10a0cbfc7867bcf43ce02b7">tmp_error_buf</a></div><div class="ttdeci">static char tmp_error_buf[32768]</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00090">tools.cc:90</a></div></div>
<div class="ttc" id="atools_8h_html"><div class="ttname"><a href="tools_8h.html">tools.h</a></div></div>
<div class="ttc" id="atools_8h_html_a4b5b6a2a4105c476f75ac907643ff855"><div class="ttname"><a href="tools_8h.html#a4b5b6a2a4105c476f75ac907643ff855">SIGHDLR</a></div><div class="ttdeci">void SIGHDLR(int sig)</div><div class="ttdoc">callback type for signal handlers</div><div class="ttdef"><b>Definition</b> <a href="tools_8h_source.html#l00039">tools.h:39</a></div></div>
<div class="ttc" id="atools_8h_html_a5b4f11f666cbb4610b0e31f81d6087f7"><div class="ttname"><a href="tools_8h.html#a5b4f11f666cbb4610b0e31f81d6087f7">PidStatus</a></div><div class="ttdeci">int PidStatus</div><div class="ttdef"><b>Definition</b> <a href="tools_8h_source.html#l00091">tools.h:91</a></div></div>
<div class="ttc" id="atools_8h_html_adfbde7d952e179f88f0768705a009c4b"><div class="ttname"><a href="tools_8h.html#adfbde7d952e179f88f0768705a009c4b">ObjPackMethod</a></div><div class="ttdeci">void(* ObjPackMethod)(void *obj, Packable *p)</div><div class="ttdef"><b>Definition</b> <a href="tools_8h_source.html#l00033">tools.h:33</a></div></div>
<div class="ttc" id="atypes_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00145">types.h:145</a></div></div>
<div class="ttc" id="atypes_8h_html_a51b5bca3280ca743227e9b07c4f839a1"><div class="ttname"><a href="types_8h.html#a51b5bca3280ca743227e9b07c4f839a1">mode_t</a></div><div class="ttdeci">unsigned short mode_t</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00129">types.h:129</a></div></div>
<div class="ttc" id="aunistd_8h_html"><div class="ttname"><a href="unistd_8h.html">unistd.h</a></div></div>
<div class="ttc" id="aunistd_8h_html_aa81d7f0b188254a6ae8ec162bef462b6"><div class="ttname"><a href="unistd_8h.html#aa81d7f0b188254a6ae8ec162bef462b6">xgethostname</a></div><div class="ttdeci">int xgethostname(char *name, size_t nameLength)</div><div class="ttdoc">POSIX gethostname(2) equivalent.</div><div class="ttdef"><b>Definition</b> <a href="unistd_8h_source.html#l00049">unistd.h:49</a></div></div>
<div class="ttc" id="aversion_8h_html_a66bbc6f3e4747cc2d6c0fc86206fa145"><div class="ttname"><a href="version_8h.html#a66bbc6f3e4747cc2d6c0fc86206fa145">SQUID_RELEASE_TIME</a></div><div class="ttdeci">#define SQUID_RELEASE_TIME</div><div class="ttdef"><b>Definition</b> <a href="version_8h_source.html#l00013">version.h:13</a></div></div>
<div class="ttc" id="aversion_8h_html_acaa588a71a8c9170b999736091d8b1bc"><div class="ttname"><a href="version_8h.html#acaa588a71a8c9170b999736091d8b1bc">APP_SHORTNAME</a></div><div class="ttdeci">#define APP_SHORTNAME</div><div class="ttdef"><b>Definition</b> <a href="version_8h_source.html#l00022">version.h:22</a></div></div>
<div class="ttc" id="awordlist_8h_html"><div class="ttname"><a href="wordlist_8h.html">wordlist.h</a></div></div>
<div class="ttc" id="axstrerror_8cc_html_a3d643f764de4776e5489d4eb55a99849"><div class="ttname"><a href="xstrerror_8cc.html#a3d643f764de4776e5489d4eb55a99849">xstrerr</a></div><div class="ttdeci">const char * xstrerr(int error)</div><div class="ttdef"><b>Definition</b> <a href="xstrerror_8cc_source.html#l00083">xstrerror.cc:83</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3c69fff7f634b97773a4d39d4565ffb4.html">squid</a></li><li class="navelem"><a class="el" href="dir_27a06220d184fcc3bd2c56b7794ae45b.html">src</a></li><li class="navelem"><a class="el" href="tools_8cc.html">tools.cc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
